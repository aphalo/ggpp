<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Pedro J. Aphalo" />

<meta name="date" content="2025-06-27" />

<title>Extensions to the Grammar of Graphics</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Extensions to the Grammar of Graphics</h1>
<h3 class="subtitle">Package ‘ggpp’ 0.5.8.1.9001</h3>
<h4 class="author">Pedro J. Aphalo</h4>
<h4 class="date">2025-06-27</h4>


<div id="TOC">
<ul>
<li><a href="#preliminaries" id="toc-preliminaries">Preliminaries</a></li>
<li><a href="#introduction-to-the-extensions" id="toc-introduction-to-the-extensions">Introduction to the
extensions</a>
<ul>
<li><a href="#data-labels-annotations-and-insets" id="toc-data-labels-annotations-and-insets">Data labels, annotations and
insets</a></li>
<li><a href="#annotations-in-ggplot2" id="toc-annotations-in-ggplot2">Annotations in ‘ggplot2’</a></li>
<li><a href="#support-of-native-plot-coordinates" id="toc-support-of-native-plot-coordinates">Support of native plot
coordinates</a></li>
<li><a href="#when-to-use-annotations-and-when-insets" id="toc-when-to-use-annotations-and-when-insets">When to use annotations
and when insets</a></li>
<li><a href="#highlighting-data-features" id="toc-highlighting-data-features">Highlighting data features</a></li>
<li><a href="#summary-statistics" id="toc-summary-statistics">Summary
statistics</a></li>
<li><a href="#positioning-data-labels" id="toc-positioning-data-labels">Positioning data labels</a></li>
<li><a href="#local-density-of-observations" id="toc-local-density-of-observations">Local density of
observations</a></li>
<li><a href="#ggplot-methods" id="toc-ggplot-methods">ggplot
methods</a></li>
<li><a href="#list-of-references" id="toc-list-of-references">List of
references</a></li>
</ul></li>
<li><a href="#examples" id="toc-examples">Examples</a>
<ul>
<li><a href="#ggplot-methods-1" id="toc-ggplot-methods-1">ggplot
methods</a></li>
<li><a href="#geometries" id="toc-geometries">Geometries</a>
<ul>
<li><a href="#geom_table-and-stat_fmt_table" id="toc-geom_table-and-stat_fmt_table">geom_table() and
stat_fmt_table()</a></li>
<li><a href="#geom_plot" id="toc-geom_plot">geom_plot()</a></li>
<li><a href="#geom_grob" id="toc-geom_grob">geom_grob()</a></li>
<li><a href="#geom_vhlines" id="toc-geom_vhlines">geom_vhlines()</a></li>
<li><a href="#geom_text_s-geom_label_s-and-geom_point_s" id="toc-geom_text_s-geom_label_s-and-geom_point_s">geom_text_s(),
geom_label_s(), and geom_point_s()</a></li>
<li><a href="#geom_text_pairwise-and-geom_label_pairwise" id="toc-geom_text_pairwise-and-geom_label_pairwise">geom_text_pairwise()
and geom_label_pairwise()</a></li>
<li><a href="#normalised-parent-coordinates" id="toc-normalised-parent-coordinates">Normalised Parent
Coordinates</a></li>
<li><a href="#marginal-markings" id="toc-marginal-markings">Marginal
markings</a></li>
</ul></li>
<li><a href="#statistics" id="toc-statistics">Statistics</a>
<ul>
<li><a href="#stat_centroid" id="toc-stat_centroid">stat_centroid()</a></li>
<li><a href="#stat_group_counts" id="toc-stat_group_counts">stat_group_counts()</a></li>
<li><a href="#stat_quadrant_counts-and-geom_quadrant_lines" id="toc-stat_quadrant_counts-and-geom_quadrant_lines">stat_quadrant_counts()
and geom_quadrant_lines()</a></li>
<li><a href="#stat_apply_group" id="toc-stat_apply_group">stat_apply_group</a></li>
<li><a href="#stat_dens2d_labels-and-stat_dens2d_filter" id="toc-stat_dens2d_labels-and-stat_dens2d_filter">stat_dens2d_labels()
and stat_dens2d_filter()</a></li>
<li><a href="#stat_dens1d_labels-and-stat_dens1d_filter" id="toc-stat_dens1d_labels-and-stat_dens1d_filter">stat_dens1d_labels()
and stat_dens1d_filter()</a></li>
</ul></li>
<li><a href="#simple-position-functions" id="toc-simple-position-functions">Simple position functions</a>
<ul>
<li><a href="#position_nudge_keep-and-friends" id="toc-position_nudge_keep-and-friends">position_nudge_keep() and
friends</a></li>
<li><a href="#position_nudge_to" id="toc-position_nudge_to">position_nudge_to()</a></li>
<li><a href="#position_nudge_center" id="toc-position_nudge_center">position_nudge_center()</a></li>
<li><a href="#position_nudge_line" id="toc-position_nudge_line">position_nudge_line()</a></li>
</ul></li>
<li><a href="#combined-position-functions" id="toc-combined-position-functions">Combined position functions</a>
<ul>
<li><a href="#position_dodgenudge" id="toc-position_dodgenudge">position_dodgenudge()</a></li>
<li><a href="#position_stacknudge" id="toc-position_stacknudge">position_stacknudge()</a></li>
<li><a href="#position_fillnudge" id="toc-position_fillnudge">position_fillnudge()</a></li>
<li><a href="#position_stack_minmax" id="toc-position_stack_minmax">position_stack_minmax()</a></li>
<li><a href="#position_jitternudge" id="toc-position_jitternudge">position_jitternudge()</a></li>
<li><a href="#position_jitter_keep" id="toc-position_jitter_keep">position_jitter_keep()</a></li>
</ul></li>
<li><a href="#appendix-a-more-on-density-filtering" id="toc-appendix-a-more-on-density-filtering">Appendix A: More on
density filtering</a></li>
<li><a href="#appendix-b-try_tibble" id="toc-appendix-b-try_tibble">Appendix B: try_tibble()</a>
<ul>
<li><a href="#time-series" id="toc-time-series">Time series</a></li>
<li><a href="#other-classes" id="toc-other-classes">Other
classes</a></li>
</ul></li>
</ul></li>
</ul>
</div>

<div id="preliminaries" class="section level2">
<h2>Preliminaries</h2>
<p>We load all the packages used in the examples, if installed, and set
flags to skip examples if they are not available.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ggpp)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>eval_magick <span class="ot">&lt;-</span> <span class="fu">requireNamespace</span>(<span class="st">&quot;magick&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>We also set an uncluttered theme as default for ‘ggplot2’.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>old_theme <span class="ot">&lt;-</span> <span class="fu">theme_set</span>(<span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()))</span></code></pre></div>
</div>
<div id="introduction-to-the-extensions" class="section level1">
<h1>Introduction to the extensions</h1>
<div id="data-labels-annotations-and-insets" class="section level2">
<h2>Data labels, annotations and insets</h2>
<p><em>Data labels</em> add textual information directly related to
individual data points (shown as glyphs). Text position in this case is
dependent on the scales used to represent data points. Text is usually
displaced so that it does not occlude the glyph representing the data
point and when the link to the data point is unclear, this link is
signaled with a line segment or arrow. Data labels are distinct from
annotations but instead contribute to the representation of data on a
plot or map.</p>
<p><em>References</em> are lines, shading or marks used to help the
reading of a plot. These elements are used to highlight specific values
on an axis or a region in a plot. They, like data labels, are positioned
relative to the scales used for data. The position of data labels and
lines, glyphs or shading used as reference cannot be altered by the
designer of a plot, as the position conveys information. I will use the
term <em>data labels</em> irrespective if the “labels” are textual or
graphical, like icons and small plots and simple tables linked to data
points or map features.</p>
<p>According to Koponen and Hildén (2019), in a statistical chart
“annotations can be used to draw reader attention to relevant detail”.
These authors use as an example a text box in a plot to highlight a data
point that is off-scale and has been “squeezed” to a position
immediately outside the plotting area.</p>
<p><em>Annotations</em> differ from data labels, in that their position
is decoupled from their meaning. Insets can be thought as larger, but
still self-contained annotations. In most cases the reading of inset
tables and plots depends only weakly on the plot or map in which they
are included.</p>
<p>In the case of annotations and insets the designer of a data
visualization has the freedom to locate them anywhere, as long as they
do not occlude features used to describe data. I will use the term
<em>annotation</em> irrespective if the “labels” are textual or
graphical. Insets are similar to annotations, but the term
<em>inset</em> is used when an annotation’s graphical or textual element
is complex and occupies more space within the plotting area. Insets can
be moved from within the main plotting area to being adjacent to it,
e.g., as a smaller panel, without any loss of meaning .</p>
<p>That the position of annotations and insets is independent of the
plotted data cannot be expressed using the grammar of graphics (GG) as
implemented in package ‘ggplot2’.</p>
</div>
<div id="annotations-in-ggplot2" class="section level2">
<h2>Annotations in ‘ggplot2’</h2>
<p>The plotting of data using package ‘ggplot2’ is described by Wickham
(2016) and several other books. Chapter 7 in Aphalo (2020) not only
describes the grammar used by ‘ggplot2’ but also several extensions to
it, including those provided by packages ‘ggpp’ and ‘ggpmisc’ at the
time of writing.</p>
<p>In <em>The Layered Grammar of Graphics</em> (Wickham 2000) as
implemented in package ‘ggplot2’ (Wickham 2016) annotations are “second
class” features. As layers they behave differently than data layers:
Only constant values can be mapped to aesthetics and do no support
faceting into panels. In essence <code>annotate()</code> disconnects the
resulting plot elements from the data source and faceting, but not from
the scales used to graphically display the data values.</p>
<p>From the data visualization perspective the main practical and
conceptual difference between data labels and annotations is in the
scales used to position them within the plotting area. Instead of using
an <code>annotate()</code> function that deviates from the grammar of
graphics to implement annotations, we can retain the use of the grammar
of graphics for annotations but add support for native plot coordinates
(npc). Support of annotations done in this way allows “annotation
layers” to behave almost identically to “data layers”, and use the same
syntax. The <em>x</em> and <em>y</em> position aesthetics used for data
can be supplemented with pseudo-aesthetics without any translation
relative to the native plotting coordinates of the plotting area or
viewport. Doing so, allows the graphic design flexibility conceptually
inherent to annotations within a user-friendly syntax.</p>
</div>
<div id="support-of-native-plot-coordinates" class="section level2">
<h2>Support of native plot coordinates</h2>
<p>Based on this insight, a new approach to adding annotations and
insets was implemented in package ‘ggpmisc’ (&gt;= 0.3.1) through two
new <em>x</em> and <em>y</em> pseudo-aesthetics, <em>npcx</em> and
<em>npcy</em>, and corresponding dumb scales and various geometries that
make use of them. These scales and geometries were are currently in
package ‘ggpp’ and still used in package ‘ggpmisc’.</p>
<p>Native plot coordinates have range 0..1. However, the “npc” geoms
from ‘ggpp’ also recognize certain positions by name with the same
character strings as used for text justification in ‘ggplot2’. The
default justification is <code>&quot;inward&quot;</code>, as this protects from
clipping at the edges the plotting area irrespective of the arguments
passed to the <code>witdth</code> and <code>height</code> parameters of
R’s graphic devices.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), mpg)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="fu">geom_text_npc</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;left&quot;</span>),</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="fu">c</span>(<span class="st">&quot;top&quot;</span>, <span class="st">&quot;bottom&quot;</span>),</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>                                  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Most</span><span class="sc">\n</span><span class="st">efficient&quot;</span>,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>                                            <span class="st">&quot;Least</span><span class="sc">\n</span><span class="st">efficient&quot;</span>)),</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>                <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">npcx =</span> x, <span class="at">npcy =</span> y, <span class="at">label =</span> label),</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>p1</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The advantage of this approach becomes apparent when the limits of
the <em>y</em> scale are unknown or vary. When a script or user defined
plotting function sets the scale limits based on the input data, in the
absence of the extensions proposed here, setting annotations
consistently within the plotting area becomes laborious. The example
below, shows how the annotations remain at the desired position when the
<em>y</em> scale limits are expanded.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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I1BII1BII1BII1BII1BII1Bok3lgeYNhgF8ECmkECmkECmkEClcskqCMbSZII1BII1Bo4xoUWESgkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagcMV3dUIZ3xcPacKB9l91jBm+rh9cLw5DeegGelN/2jG3pyfm6tniMJSI6jXohyf/SGbQ4dvOeCadGwb45XyK7x9dm+GbMzvE8v+VAWaDQG8OpoHODgP8yjCDzg4D/HIOlGtQFME50NvTY1bxyB37oJDGnSRII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BI8xNoXLtcenzw9fLjwAPyDfSh48ADvAbai6KKMV37ftSMov3k3SMKxSZ8BmrfnzeS94Ov2r2KSd4zg2JDPgNNJtBk2jRxNdppJe8qnOKxMa+BVuzHvd324HnL2E4bBIoNeT3FP26Nmo0k095Oq5vEer5PoNiQp0CrkV0ZpYukwWH0q8OGOY+SBdLgkEUSNsJGPaQRKKQRKKQRKKQRKKQRKKQRKKQRKKR5DXTUjBrJ24vJ/aP5+0g8GwoHXgO1RT54d5PbnnDgKdDpTc7dH5K372uXcTXatQ/bpcfjLw6jCs+GwoW/h0XOG9MZNK59et4y3Upcuxg/IbrX5tlQuPET6PRJ0GmgF5MHmD+mx5NDo3ctAoUDT4GmT4IuCbQyOUygcOMe6PB1/eB6cdgDxk+Czp/ie48uahfpcQKFM+dAb09PzNWzxWEPGX+73F2gC4ukNFCeDYUD50CHbzum/6qzMAzwyznQ/tG1Gb45s0Msv18VMOEc6M3BNNDZYYBfGWbQ2WGAX1yDQtoGq/jjDVbxwC/Dzz4o8AvheVBII1BII1BII1BII1BII1BII1BII1BII1BIyxookI9sgRYh+FmbF7AFAvWPF7AFAvWPF7CFAAJFmREopBEopBEopBEopOkHan+0ScBuT+tPztZ/mq7+y/rTzvpP80U/0Kt60IF+OEl/tECw7LecXxX4AuQD7f/+u5ADtd+1HbT05yIU+CLUA7392z+DPsX3j/4e9imeGXS1q+Owr0H7L0/SSShcc992nj/xQJP/t4EHOveTgwLU//bM3BS4ShIP9KpuHRf9ZWQ3/EPggc7/8Lj8iQdqgt9m+hD4KZ4ZdJ3AA00u4YrcRtzeTb3QVZ5+oCg1AoU0AoU0AoU0AoU0AoU0At1eN9ppLR77778Xj9i/gm9e/Lg1eP7ZSMwh0K0NDhfLS9tbPNStLPukHn/t3moEurUlMS45tmSutJ/0+byKOQS6rbia/j2k1fQvIk+Cm/5uf/Kxiff+FO22u3aqnBw5t5Npt5JWzBS6GoFuzXaWnua7u+1Rs5J+PJ4cK+lbXK3YNNN6x3/a223bqTMNdNn8i3sEujWb2M+X4w+muaWXl0mG9l1cbUwuVKd/mia8105/u+wKFvcIdGvj7HrJKX6nlUZpZtY/02jTDqd/ahdMyT/pH6RTKx5EoFsbn+J3WvYDx0DjvR+bDQJ1QaBbu4uxtzN/ire7o/YUfxfo3fXmqPlir204xTsg0K1NY4yrO63pwshmd7dISrM8nyyS7Jvd269MemWRtBqBbi1N7Dy5Av1LWmW6kZT8vnK3zTS+Rp3ZZrJ7U9MJtcs200oEmpP5jfpkDT/+gI36NQg0L3O3OrvTlRH79GsQaF5m5sq4Os2Sh0XWIVBII1BII1BII1BII1BII1BII1BI+x8wuNKhcGwZBwAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<p>To support the existing syntax for annotations using the new
geometries, function <code>ggplot2::annotate()</code> is overridden when
package ‘ggpp’ is loaded. The new definition adds support for the new
pseudo-aesthetics <em>npcx</em> and <em>npcy</em> retaining its original
‘ggplot2’ behaviour in all other respects.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), mpg)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text_npc&quot;</span>,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>           <span class="at">npcx =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;left&quot;</span>),</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>           <span class="at">npcy =</span> <span class="fu">c</span>(<span class="st">&quot;top&quot;</span>, <span class="st">&quot;bottom&quot;</span>),</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Most</span><span class="sc">\n</span><span class="st">efficient&quot;</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>                     <span class="st">&quot;Least</span><span class="sc">\n</span><span class="st">efficient&quot;</span>),</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Inset plots can be added with the same syntax using
<code>geom_plot_npc()</code>. They can be thought also as being
annotations. Here we use <code>annotate()</code> but
<code>geom_plot()</code> can be also used directly, in which case the
inset plots can be different for each panel.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), mpg, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>() <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="dv">9</span>) <span class="sc">+</span> </span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;plot_npc&quot;</span>, <span class="at">npcx =</span> <span class="st">&quot;left&quot;</span>, <span class="at">npcy =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">label =</span> p2) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="at">x =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAABDlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZrYAujgzMzM6AAA6ADo6AGY6Ojo6OmY6OpA6ZrY6kNtNTU1NTW5NTY5NbqtNjshhnP9mAABmADpmAGZmOgBmOpBmZmZmkJBmtttmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2Obm6Ojo6OyP+QOgCQOjqQOmaQZgCQkDqQkGaQ27aQ29uQ2/+rbk2rbm6rbo6rq8iryKur5OSr5P+2ZgC2Zjq225C22/+2/9u2///Ijk3I///bkDrbtmbb25Db/7bb///kq27kyI7k///4dm3/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///9N8icmAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAPhElEQVR4nO3dDX/axh3AcZwts+t4zUyb2Gm7jTQzSbfhrFtmdw9x1xGzzcwxdBjQ+38j00kI8yDBSZzu/if9vp/UD9gkV+eX0wPiaASAYA3XAwA2IVCIRqAQjUAhGoFCNAKFaDkD/QRIlFPkiryBljMKeIhAIRqBQjQChWgECtEIFKIRKEQjUIhGoBCNQCEagUI0AoVoBGrQx48fXQ+hcgjUnI8fKdQ4AjWHQEtAoOYQaAkI1CD6NI9AIRqBQjQChWgECtEIFKIRKEQjUIhGoBCNQC3iRH5+BGoPD4UWQKD2EGgBBGoPgRZAoBbRZ34ECtEIFKIRKEQjUIhGoBCNQCEagUI0AoVoBArRCBSiEShEI1CIRqAQjUBzml+RxKVJVhBoPvNrOrm40w4CzYdALXMe6KDZ/Pw6CMavm89uk9sIFAnXgY5eXQf958H0sqPeWR1UMeyD2uU6UCWMdPzNddRqTHKgsEtCoOHUOTq7DcZv3qsBKVYGBR+4D3T08rP3weBZEqhCoEi4DzRQZT7MoAqBIiEh0OBDh31QpHMd6GzbPr1se3IUD7tcBxr0m81wH9Sb86CwzHmgaQgUCQKFaAQK0QgUohEoRCNQiEagEI1AIRqBQjQChWgECtEIFKIRKEQjUIhGoBCNQCEagZaB58wbQ6AlYNURcwi0BARqDoGWgEDNIdAy0KcxBArRCBSiEShEI1CIRqAQjUAhGoHawYmnggjUCk7dF0WgVhBoUQRqBYEWRaB20GdBBArRCBSiEShEI1CIRqAQjUAhGoFCNAKFaAQK0QgUohGo/yr9MCqBeq/aF6IQqPcIdHcEWiIC3R2BlqnKfRIoZCNQiEagEI1AIRqBQjQChWgECtEIFKIRKEQjUDdMPfpT6UeRFAJ1wtTj59V+HF4hUCcIVBeBOkGgugjUDfZBNREoRCNQiEagEI1AIRqBQjQChWgE6l7lTxXtgkCd23iyXS/eg4MDgwMSJaOFXmPvYvW2H39YvWVy3lq5Zfjk4v7F2j0JdJNNgeo9UnRwUN1C01u4P10tL2pv9abefto33T2+Wb2ZQDcg0E3SW0iJMeW2lLlSfdP6vEqgG23ewhPouuFho7EfvW0cqw158tnx7ONgePTHxqNuT02Vs1uu1GTa248qXp9CCVTfcmtJn5sLrG6fG2bQaDPfe9SdnO9HH8eT43703/BwX6UZ1Rt/9e5RV02dUaDrcy2BakufDas8R26WHej/buIPktyi3cswQ/VmeNia7agmX40SPupGn67vwRKoNgJdtmkf9C7cxO9dRFEGC8c/SbRRh8lX1QFT+Cv6QjS1LiFQbQS6bNMmfu9CfaAZ6PDon+ctAt1deol17XNDoFGMd3vLm3h1dlRt4ueBzvc3J+e/OuoGbOJh1oZA1QR6uHeRHBip7OYHSVGWV7ODJPWfOre/P+uVgyQYs2Ef9CrcA30XVRmdSAo/35+fZor3URdOM6lzU8mE2uM0E0zZpYXlE/XhMXz8Qb4T9aOXzWYnCMavm89uTQwK1bJTC0sPdfaSI6NcD3WO37wPRl+/n152gv5zI4NCpezUwsJcOTxMssx3schAVfmhM/7mOhi9ujYxKFSKhMvtwll0dHYbTabhgBQrg/JBbc8uzQkIdHrZDgbPkkAVAp2p7/n5OfeBjl+3w0OlMwJNQaDuAx29DI/hA/ZBUxGo80DjPqPNPEfx62rfp/NA+02lw3lQ4zTaPjk5sTGSnbgONBWB7k5j7+DkxINCCbSiCDQPArWOQPMgUPvYB82BQK3zYnrUQKAVRaB5EKh1NQ805ZrPTQjUvmr0ubWFjIUteo3Cgd6fNmbWFs7RHRTqY0sLGUuvDD/9svgM2lNPBL0/PY6fylRgUNBTicdJCwU6efvn4pv42XM+7x51509ZzjkoaKnGlSaFAu0d77APSqB2HNQi0NR90OHTm10OkpJNfMqzPzUHhe0OahJoml50iLO6esgmy0fxakmd8CCrt75G7g6DwrKK9MlppqqqSJ8EWlnV6NPJI0m9eBOfjUDL5NcZfAeBzg+SMhFoiTx7DNR+oA+nmTK/nUBLRKApCFQOAk2xtImPFhllE++MV306mUGTi0UaPJKEbbgeFKIRKERzEGj0AmHZ2/eAQF2StodqP9Dsy0DnCNQZccf4zk4zbUKgzhCozsP4BOoMgW4+RR8jUHeE9clBkvekFWVYoRYm543Mi41TLW/it17qTKD6xG2TDdvWQupVhVettNea2YCDpNLUPNDU67Lvv9i2E7mKg6TSbAvU93yLBDp8+u0Om/iHl6QrOigs2tqn34UWCvSwpZ7ZmeNPSbtYhIOkUs26zArUm2yL7IOqONNeTy4bj8XbloSZEag/E2uRFu6/IlDp5gWqd+sxVjtQdRRffBOvgUB3tlhgSo0VDzTcjdz6aNASArVuIcC0Gn3pk+tBa0D0dLltaARaA7L73Dw4AoVLFQ30g3r1RPX2s/fbvhXMoNsZDnTwXL088vS7hzo/8VH+n2Mx7INuZX4THwY6/t3LZvQCyTb/sg0iUB2eBvqh2Q4Gn18H/Y7uPeQhUB2eBhoE/bZ6O2jr30Mae2P2uE8/A1VZ9tvRW2bQivMyUHX8/jx629a9R+qrPblFoDr8DDT/PQjUUwTqDIHqIFBn3Afqw8ETgTrjPFAvTj8V+ikND6VdbkegBVQi0LT/BXU1fearxKUi0BQEqmPLTyn1/yF6TlKupx4TaArngVZhHzQ1UGZQI9wH6oMigaqnfOTqk0DTEKiOIvugwycXGkvULSLQFASqo8hPSa3L5PZpx8kFy/PrlQm0qor8lJzPoPEFy4Nnt+Gv9Xt8zCHfuMwiUB2Ffkp3jV3WZtpO74Llflu9DdYuWM5RHYGK5+kjSeqC5X4nmP7lev0eBFolngaqrgedz6ABgVaXl4HOLljO2gfV/4MIVDwvA51fsJx6FE+gVeJnoBvvQaBVQqDOEKgOAnWGQHUQqDMEqoNAnSFQHQTqDIHqIFBnCFQHgTpDoDqqGChXM1UIgTpDoDqqGKj+3QhUPC8DnV42m89uF5cAJ1DfrDyXKPMJpl4GOlBXinSWlgBf+CqBemDl2ZjZT9H3MlCl38laApxAPeBToKNX10Ewft1Mru3UGlQ4iWYtAU6gHvAo0EEzDG162Qn6z5ObNJ7yMfvetCXACdQH3uyDfvjsb+EMqp67Ec2kWoNSOc+uq2cGrTjngcab+NHZbTB+ow56dF5BKDx8V6t/ZywBTqBVIiRQ9eSiOFCF86BICAn0YQZVCBQJIYHm2wddx0OdVSUk0OllO9dR/CrWZqoqIYHmPg+6gkCrSkCg6wgUCQJ1hkB11CXQwg5K+50JVAeBbkGgbhHogwN9Jv44AtXhZaDzC5b1lwDXoZ8dgVrjZaDxBctZyy8WRqACeRmo0u9kLQFeGJt4gXwNNJxEs5YAL8xkoBov4kagOjwNVF2wnLUEeGEGN/E6L4NJoDq8DHR2wbLgfVACNcXLQOcXLIs9iidQU7wM1MQ9UrAPKhCBblH0gH37C10TqA4C3YJA3SLQkhCoGQRaEgI1g0BLQqBmEGhJCNQMAi0JgZpBoLs70bd4NwLVQaC72z5Zpn4ngeog0N0RaIk8DTS6jCljCXDr2MSXyM9A4zVFM5YAt45AS+RloNO/qiuVs5YAt45NfIm8DDSILqXPWgLcOgItkceBKmlLgFvHJr5EHgeatQS4DJyoN8PjQLOWAJeBQM3wNNDd71E2AjWDQJ3xccz2EagzPo7ZPgJ1xscx20egzvg4ZvsI1Bkfx2wfgTrj45jtI1BnfByzfQTqjI9jto9Ay3HC0jdmeBro7IJls4uHGbR2ZUgKaWOWyc9AowuWjS+/aBCBmuJloPEFy8aXADeIQE3xMtD4aibjS4CbxD6oIT4HanoJcMt8HLN9Hge6tA/qowI/yPrxONDFo3gDv6XhO5KfGZ4GmhuBeqougcJTBArRCBSiEShEq0ug/fb270m7WzNeXSevPCcYsElNAh00CwUav+53gfstnKLFTuoR6Ojsv4UC7f++2Aw6OrsdFJp5saoWgY6/uR4UCjR6UeUCM2g4YzOBmlGLQPvxi88WuGPnYX2yXPd7HoxeXRf4A7GqFoEGxTKL90GLzKCL17FgJwS6Ub/YzDu9bDaL7BlgTV0ChacIFKIRKEQjUIhGoBCNQCEagUYm543jxc+HR92lr/eOl784fHpjY1gg0NhqkCufL/eovrhULMpDoMr9aWPvYnjYaLTij9+dNh5179WbYPjpl4+6V7PbL8IPhk//HQZ6/0V3+2+L3RFoJJwU719cqHeT81Zw91g1eHUcfnAzPGxFNca3/yu87TiaXlWzKB+BRmab9LDE+CMVbFhlGK36XG3h49vvv7r5PrqJbbwlBBqJJ8VGuE2PdzfVcVB40+RtVGM4kc52Qydv3311Q6AWEWhEzZinraTL7Bk06P3yOCBQiwg0Mitz+ORC7WsOj/7xsA86OyKKb++G3xGwD2oRgUaiM0eNxk+/bMVH65Pz+VF8UmN0ezD5Q3wTR/GWEKiOh/Ogw1/E79nCW0KgWpIee+EkqvBIki0ECtEIFKIRKEQjUIgmJdDx64WlDggUCSGBTi87arWDGQJFQkigapmDh7U4CBQJIYGOzm6D8Ru1YiGvf4FFQgJVixXGgSoEioSQQB9mUIVAkRASKPugSCck0Ollm6N4pBASKOdBkU5KoEsIFAkChWgECtEIFKIRKEQjUIhGoBCNQCEagUI0mYECiXKKXJEz0CyezayeDde78RpEoD7wbbwGEagPfBuvQYYCBcpBoBCNQCEagUI0AoVoJgJdelKIfKOXzWbH9SByUau71JWBQJcXxxFPPYd69PX77d8oR9+zf1AmGQh0+YnJ4g3Uv6UPPv2Nj37zW5+Ga5aBQJeXdvCCV8Odfvd3NvG7WF4cxwfquf7+6LfZB92JdzPo+LVPfYY/XgLdiWf7oOFRvFd/3f2m4tM/KaOMHMW3fTqK96xPhRl0N36dB41nJK/+xgkUEIpAIRqBQjQChWgECtEIFKIRaEE//uB6BPVAoMUMn1y4HkI9EGgxBGoJgeqbnB8HwV2jFQRXPzlsNI5dj6cWCDSH3uOb4Ornx2GpLWZQSwg0h+FRd/L2T49vwvcEagmB5qBmzqf/+aIbzqQEagmB5nG1f7c/Of91uC9KoJYQaB53j79tBb2fvbggUFsINI/7072L8Dg+PFa6P225Hkw9EGguV1Gb6gTTVWPf9WBqgUAhGoFCNAKFaAQK0QgUohEoRCNQiEagEI1AIRqBQrT/A0EYbHkQW65uAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<p>A simple example with facets, labelling of panels in a traditional
way as required by some book and journal styles. In this case panel tags
are added within the plotting area at a consistent “npc” location with
free scale limits in panels.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">geom_text_npc</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">cyl =</span> <span class="fu">levels</span>(<span class="fu">factor</span>(mtcars<span class="sc">$</span>cyl)),</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                                  <span class="at">label =</span> LETTERS[<span class="fu">seq_along</span>(<span class="fu">levels</span>(<span class="fu">factor</span>(mtcars<span class="sc">$</span>cyl)))],</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                                  <span class="at">x =</span> <span class="fl">0.90</span>,</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="fl">0.95</span>),</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>                <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">npcx =</span> x, <span class="at">npcy =</span> y, <span class="at">label =</span> label),</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(cyl), <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>This approach was first implemented in ‘ggpmisc’ version 0.3.1
released in April 2919. The implementation now in package ‘ggpp’ can be
considered stable. However, this implementation is to an extent
dependent on undocumented behaviour of ‘ggplot2’ functions, which means
that future updates to ‘ggplot2’ could break this functionality.</p>
</div>
<div id="when-to-use-annotations-and-when-insets" class="section level2">
<h2>When to use annotations and when insets</h2>
<p>Package ‘ggpmisc’ adds support for various plot annotations and
reference guides based on model fits and other statistics. It also adds
support for some data labels related to data features. While developing
these statistics in ‘ggpmisc’, it became clear that expanding the
grammar of graphics’s support for annotations would simplify the new
code considerably and also more cleanly separate the computations on
data from the positioning of annotations. These extensions to the
grammar are now in ‘ggpp’.</p>
<p><strong>Table</strong>. Geometries useful for data labels and
annotations. Currently implemented <em>ordinary</em> geometries and
their <em>npc</em> versions. The rightmost column shows the expected
class of the objects mapped to the <code>label</code> aesthetic. When
using <code>annotate()</code> to add a single plot, table or grob as an
inset, enclosing them in a list is allowed, but not a requirement. All
those geoms whose names are highlighted in <em><code>italics</code></em>
support plotting of connecting segments or arrows when a the coordinates
have been modified by a <em>position</em> function.</p>
<table style="width:99%;">
<caption><strong>Table</strong>. Geometries useful for data labels and
annotations. Currently implemented <em>ordinary</em> geometries and
their <em>npc</em> versions. The rightmost column shows the expected
class of the objects mapped to the <code>label</code> aesthetic. When
using <code>annotate()</code> to add a single plot, table or grob as an
inset, enclosing them in a list is allowed, but not a
requirement.</caption>
<colgroup>
<col width="41%" />
<col width="28%" />
<col width="29%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Data labels</th>
<th align="left">Annotations (npc)</th>
<th align="left"><code>label</code> aes.</th>
</tr>
</thead>
<tbody>
</tbody><tfoot>
<tr class="odd">
<td align="left"><code>ggplot2::geom_text()</code></td>
<td align="left"><code>geom_text_npc()</code></td>
<td align="left"><code>character</code></td>
</tr>
<tr class="even">
<td align="left"><code>ggplot2::geom_label()</code></td>
<td align="left"><code>geom_label_npc()</code></td>
<td align="left"><code>character</code></td>
</tr>
<tr class="odd">
<td align="left"><code>ggrepel::geom_text_repel()</code></td>
<td align="left"></td>
<td align="left"><code>character</code></td>
</tr>
<tr class="even">
<td align="left"><code>ggrepel::geom_label_repel()</code></td>
<td align="left"></td>
<td align="left"><code>character</code></td>
</tr>
<tr class="odd">
<td align="left"><code>geom_text_s()</code></td>
<td align="left"></td>
<td align="left"><code>character</code></td>
</tr>
<tr class="even">
<td align="left"><code>geom_label_s()</code></td>
<td align="left"></td>
<td align="left"><code>character</code></td>
</tr>
<tr class="odd">
<td align="left"><code>geom_text_pairwise()</code></td>
<td align="left"></td>
<td align="left"><code>character</code></td>
</tr>
<tr class="even">
<td align="left"><code>geom_label_pairwise()</code></td>
<td align="left"></td>
<td align="left"><code>character</code></td>
</tr>
<tr class="odd">
<td align="left"><code>geom_point_s()</code></td>
<td align="left"></td>
<td align="left"><em>not supported</em></td>
</tr>
<tr class="even">
<td align="left"><code>geom_plot()</code></td>
<td align="left"><code>geom_plot_npc()</code></td>
<td align="left"><code>list(&lt;ggplot&gt;)</code></td>
</tr>
<tr class="odd">
<td align="left"><code>geom_table()</code></td>
<td align="left"><code>geom_table_npc()</code></td>
<td align="left"><code>list(&lt;data.frame&gt;)</code></td>
</tr>
<tr class="even">
<td align="left"><code>geom_grob()</code></td>
<td align="left"><code>geom_grob_npc()</code></td>
<td align="left"><code>list(&lt;grob&gt;)</code></td>
</tr>
<tr class="odd">
<td align="left"><code>geom_img()</code> <em>(planned)</em></td>
<td align="left"><code>geom_img_npc()</code></td>
<td align="left"><code>list(&lt;raster&gt;)</code></td>
</tr>
</tfoot>

</table>
</div>
<div id="highlighting-data-features" class="section level2">
<h2>Highlighting data features</h2>
<p>Marginal annotations with symbols and vertical and horizontal lines
can be used to highlight summary values or events/conditions. The
<em>geoms</em> <code>geom_quadrant_lines()</code>,
<code>geom_vhlines()</code>, <code>geom_x_margin_arrow()</code>,
<code>geom_x_margin_grob()</code>, <code>geom_x_margin_point()</code>,
<code>geom_y_margin_arrow()</code>, <code>geom_y_margin_grob()</code>
and <code>geom_y_margin_point()</code> make such labelling easy. These
work similarly to geoms <code>geom_hline()</code> and
<code>geom_vline()</code> from ‘ggplot2’ and plays a similar role. Of
course, they can also be used to add annotations not derived from the
observations.</p>
<table style="width:99%;">
<caption><strong>Table</strong>. Geometries useful for data labels and
annotations, lines and marginal marks. The middle columns shows the
aesthetic that determines the position of the lines or marks on the edge
of the plotting area. The rightmost column shows the expected class of
the objects mapped to the <code>label</code> aesthetic.</caption>
<colgroup>
<col width="41%" />
<col width="28%" />
<col width="29%" />
</colgroup>
<thead>
<tr class="header">
<th>Marginal marks</th>
<th>Location aesthetic</th>
<th><code>label</code> aes.</th>
</tr>
</thead>
<tbody>
</tbody><tfoot>
<tr class="odd">
<td><code>geom_x_margin_arrow()</code></td>
<td><code>xintercept</code></td>
<td><em>not supported</em></td>
</tr>
<tr class="even">
<td><code>geom_y_margin_arrow()</code></td>
<td><code>yintercept</code></td>
<td><em>not supported</em></td>
</tr>
<tr class="odd">
<td><code>geom_x_margin_grob()</code></td>
<td><code>xintercept</code></td>
<td><code>list(&lt;grob&gt;)</code></td>
</tr>
<tr class="even">
<td><code>geom_y_margin_grob()</code></td>
<td><code>yintercept</code></td>
<td><code>list(&lt;grob&gt;)</code></td>
</tr>
<tr class="odd">
<td><code>geom_x_margin_point()</code></td>
<td><code>xintercept</code></td>
<td><em>not supported</em></td>
</tr>
<tr class="even">
<td><code>geom_y_margin_point()</code></td>
<td><code>yintercept</code></td>
<td><em>not supported</em></td>
</tr>
<tr class="odd">
<td><code>geom_quadrant_lines()</code></td>
<td></td>
<td><em>not supported</em></td>
</tr>
<tr class="even">
<td><code>geom_vhlines()</code></td>
<td><code>xintercept</code> <code>yintercept</code></td>
<td><em>not supported</em></td>
</tr>
</tfoot>

</table>
<p>When adding an informative element to a plot, assess whether it is an
<em>annotation</em> or a <em>data label</em>. To decide on the best
approach, consider if the location of the element is more “naturally”
expressed in the original data units or as position relative to the
edges or centre of the plotting area. In the second case, prefer the
“npc” geoms as you are dealing with <em>annotations</em>, otherwise, use
the ordinary geometries as you are dealing with data labels or data
points.</p>
</div>
<div id="summary-statistics" class="section level2">
<h2>Summary statistics</h2>
<p>Frequently, maxima or minima are features of interest that may need
to be labelled or highlighted in a plot. This can be done easily with
functions <code>stat_peaks()</code> and <code>stat_valleys()</code>.</p>
<p>With some types of data it is common to compute a summary per plot
quadrant, rather than based on a prior grouping. The <em>stat</em>
<code>stat_quadrant_counts()</code> can de used to annotate plots with
the number of observations in each quadrant, selected quadrants, or
quadrants pooled along <em>x</em> and/or <em>y</em>. Similarly,
<code>stat_group_counts()</code> and <code>stat_panel_counts()</code>
can be used to annotate plots with the number of observations per panel,
or per group within each panel.</p>
<p>In many cases, such as rug plots or other representations on plot
margins, <em>x</em> and <em>y</em> summaries can be computed in separate
plot layers using the statistics from ‘ggplot2’. In contrast, in other
cases, such as when showing the <em>x</em> and <em>y</em> position of
the means in the plotting area itself, it is necessary to compute
summaries for both <em>x</em> and <em>y</em> in the same plot layer.
Function <code>stat_summary_xy()</code> is similar to
<code>stat_summary()</code> from ‘ggplot2’ but useful when both
<em>x</em> and <em>y</em> are continuous variables. It allows the use of
the same, or different functions to summarize the data over <em>x</em>
and <em>y</em>. In contrast, its simpler counterpart,
<code>stat_centroid()</code>, always applies the same function over
<em>x</em> and <em>y</em>.</p>
<p>An additional variation is statistic <code>stat_apply_group</code>,
which can apply functions to <em>x</em> and <em>y</em> values in
parallel, which is most useful for accumulating or differencing
consecutive data values.</p>
</div>
<div id="positioning-data-labels" class="section level2">
<h2>Positioning data labels</h2>
<p>Nudging is normally used to displace text labels so that data labels
do not overlap the points or lines representing the data being labelled.
Two enhanced versions of <code>position_nudge()</code> are provided,
<code>position_nudge_center()</code> and
<code>position_nudge_line()</code>. These functions make it possible to
apply nudging that varies automatically according to the relative
position of points with respect to arbitrary points or lines, or with
respect to a polynomial or smoothing spline fitted on-the-fly to the the
observations.</p>
<p>A limitation of ‘ggplot2’ is that only one position function can be
used in a layer. This makes it difficult to add data labels to stacked
or dodged bars or columns, or the labelling of points that have been
jittered. The solution provided by ‘ggpp’ are wrappers on these position
functions from ‘ggplot2’. These wrappers add support for nudging.</p>
<p>The position functions defined in ‘ggpp’, instead of deleting the
original positions, rename the variables in <code>data</code> containing
these coordinates. This makes it possible for geometries to draw
connecting segments or arrows between old and new positions. For
consistency, positions equivalent to all those defined in ‘ggplot2’ are
defined in ‘ggpp’. These functions are backwards compatible with those
from ‘ggplot2’ and can be used in place of them. The geometries from
‘ggrepel’ (&gt;= 0.9.2) and many of those from ‘ggpp’ can make use of
the original coordinates kept in data.</p>
<table>
<caption>Position functions</caption>
<colgroup>
<col width="56%" />
<col width="43%" />
</colgroup>
<thead>
<tr class="header">
<th>Position (origin kept)</th>
<th>Position (origin discarded)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>position_nudge_keep()</code></td>
<td><code>ggplot2::position_nudge()</code></td>
</tr>
<tr class="even">
<td><code>ggrepel::postion_nudge_repel()</code></td>
<td><code>ggplot2::position_nudge()</code></td>
</tr>
<tr class="odd">
<td><code>position_nudge_centre()</code></td>
<td></td>
</tr>
<tr class="even">
<td><code>position_nudge_line()</code></td>
<td></td>
</tr>
<tr class="odd">
<td><code>position_jitter_keep()</code></td>
<td><code>ggplot2::position_jitter()</code></td>
</tr>
<tr class="even">
<td><code>position_dodge_keep()</code></td>
<td><code>ggplot2::position_dodge()</code></td>
</tr>
<tr class="odd">
<td><code>position_dodge2_keep()</code></td>
<td><code>ggplot2::position_dodge2()</code></td>
</tr>
<tr class="even">
<td><code>position_stack_keep()</code></td>
<td><code>ggplot2::position_stack()</code></td>
</tr>
<tr class="odd">
<td><code>position_stack_minmax()</code></td>
<td></td>
</tr>
<tr class="even">
<td><code>position_fill_keep()</code></td>
<td><code>ggplot2::position_fill()</code></td>
</tr>
<tr class="odd">
<td><code>position_jitternudge()</code></td>
<td></td>
</tr>
<tr class="even">
<td><code>position_dodgenudge()</code></td>
<td></td>
</tr>
<tr class="odd">
<td><code>position_dodge2nudge()</code></td>
<td></td>
</tr>
<tr class="even">
<td><code>position_stacknudge()</code></td>
<td></td>
</tr>
<tr class="odd">
<td><code>position_fillnudge()</code></td>
<td></td>
</tr>
<tr class="even">
<td><code>position_jitterdodge_keep()</code> <em>(planned)</em></td>
<td><code>ggplot2::position_jitterdodge()</code></td>
</tr>
<tr class="odd">
<td><code>position_jitterdodgenudge()</code> <em>(planned)</em></td>
<td></td>
</tr>
</tbody>
</table>
<p>There is a storage-use cost in saving the original position, by
making the <code>data</code> member stored in the ggplot object bigger.
This may need to be taken into consideration when <code>data</code> has
many rows. In such cases, when a counterpart position function that does
not keep the original coordinates exists, it is wise not to use the new
“keep” position functions in combination with geometries that cannot
make use of the additional information stored by them. Alternatively,
and when using those new position functions with no counterpart in
‘ggplot2’ the keeping of the original position can be disabled by
passing <code>kept.position = &quot;none&quot;</code> as an additional argument
when they are called.</p>
</div>
<div id="local-density-of-observations" class="section level2">
<h2>Local density of observations</h2>
<p>With stats from ‘ggplot2’ it is common to plot estimates of empirical
density curves or empirical density surfaces. There are other uses for
density estimates: 1) highlighting dense or sparse regions in clouds of
observations plotted as points, and 2) using density to decide which
observations to label and which not to label. _If the highlighting or
labeling is to be interpreted as meaningful as a description of
properties of the population then the fitted curve of surface should not
be too flexible, it should not track local anomalies in the distribution
of observations. In contrast if the use of the density estimate is only
used as a way of avoiding overlaps among labels with no intent of
describing properties of the data, much more flexible curves and
surfaces are most effective.</p>
<p>Functions <code>stat_dens1d_filter()</code> and
<code>stat_dens2d_filter()</code>, and
<code>stat_dens1d_filter_g()</code> and
<code>stat_dens2d_filter_g()</code> can be used to filter/subset data
based on local density estimates.</p>
<p>Functions <code>stat_dens1d_labels()</code> and
<code>stat_dens2d_labels()</code> instead of removing rows from data,
replace or edit the values mapped to the <code>label</code> aesthetic
before they are passed to the geometry. This is especially useful in
combination with the repulsive geometries from package ‘ggrepel’ because
by retaining all observations in data these geometries can repulse
labels away from observations with and without data labels attached.</p>
<p>Although useful for diverse types of plots, these statistics are most
useful when creating volcano and quadrant plots. A case where the
observations near the edges of a cloud of observations are of special
interest.</p>
<p>The density estimates used for the “filtering” of data rows or labels
can be of interest both when selecting the parameters for the fit of the
empirical density function or possibly even for mapping to an aesthetic.
These are optionally returned.</p>
<p>One final twist is that even if the density estimate is in all cases
obtained from the whole of <code>data</code>, the selection criteria can
be applied separately, and even be different, for each quadrant or tail.
For example, we can highlight or label the same fraction of
observations, or alternatively the same number of observations in each
quadrant or tail even if the overall density of observations is
different between tails or among quadrants.</p>
</div>
<div id="ggplot-methods" class="section level2">
<h2>ggplot methods</h2>
<p>That <code>ggplot()</code> is defined as a generic method in
‘ggplot2’ makes it possible to define specializations. We provide two
<code>ggplot()</code> methods for time series stored in objects of
classes <code>ts</code> and <code>xts</code>. These methods
automatically convert these objects into tibbles and set by default the
aesthetic mappings for <code>x</code> and <code>y</code> automatically.
A companion function <code>try_tibble()</code> is also exported.</p>
</div>
<div id="list-of-references" class="section level2">
<h2>List of references</h2>
<p>Aphalo, Pedro J. (2020) <em>Learn R: As a Language.</em> The R
Series. Boca Raton and London: Chapman and Hall/CRC Press. ISBN:
978-0-367-18253-3. 350 pp.</p>
<p>Koponen, J; Hildén, J. (2019) <em>Data visualization handbook</em>.
Aalto ARTS books, Espoo. ISBN 978-952-60-7449-8.</p>
<p>Wickham H. (2010) A Layered Grammar of Graphics. <em>Journal of
Computational and Graphical Statistics</em> <strong>19:</strong>
3–28.</p>
<p>Wickham H. (2016) <em>ggplot2: Elegant Graphics for Data
Analysis</em>. Springer International Publishing. ISBN
978-3-319-24275-0.</p>
</div>
</div>
<div id="examples" class="section level1">
<h1>Examples</h1>
<p>Some of the examples below are evaluated only if packages ‘ggrepel’,
and ‘magick’ are available.</p>
<div id="ggplot-methods-1" class="section level2">
<h2>ggplot methods</h2>
<p><code>ggplot()</code> methods for classes <code>&quot;ts&quot;</code> and
<code>&quot;xts&quot;</code> automate plotting of time series data, as <em>x</em>
and <em>y</em> aesthetics are mapped to time and the variable of the
time series, respectively. For plotting time series data stored in
objects of other classes, see the conversion functions
<code>try_tibble()</code> and <code>try_data_frame()</code> in the last
section of this vignette.</p>
<p>By default, <code>time</code> is of class <code>Date</code> or of
class <code>POSIXct</code> depending on how time is stored in the time
series object. On-the-fly coversion of <code>time</code> to
<code>numeric</code> is also possible (shown in the second example
below).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">class</span>(lynx)</span></code></pre></div>
<pre><code>## [1] &quot;ts&quot;</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">ggplot</span>(lynx) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The class of variable <code>time</code>, mapped to the <em>x</em>
aesthetic, affects the scale used by default as well as the formatting
of values when converted to character strings or printed. Here we force
its conversion to <code>numeric</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">ggplot</span>(lynx, <span class="at">as.numeric =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="geometries" class="section level2">
<h2>Geometries</h2>
<p>Three of the geometries described below allow the addition of plot
layers containing insets. Insets can be plots, tables, bitmaps, or grid
objects. Insets can be also added as annotations. Using for
<code>data</code> a tibble with a list column containing data frames or
tibbles allows like any other geom, the use of grouping, multiple insets
per panel, faceting with different tables per panel, and different
number of insets in each panel, i.e., individual tables added to a plot
with <code>geom_table</code> behave similarly to individual
<code>character</code> values added with <code>geom_text</code>.</p>
<p>Other geometries also described in this section support the use of
native plot coordinates for positioning elements in the plotting area.
Obviously these geometries are not meant to be used to display data, but
instead they make it possible to add annotations to plots consistently
across data sets even when using scales with varying limits.</p>
<table>
<caption>Geometries defined in package ‘ggpp’</caption>
<colgroup>
<col width="18%" />
<col width="18%" />
<col width="45%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th>Geometry</th>
<th>Main use</th>
<th>Aesthetics</th>
<th>Segment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>geom_text_s()</code></td>
<td>data labels</td>
<td>x, y, label, size, family, font face, colour, alpha, group, angle,
vjust, hjust</td>
<td>yes</td>
</tr>
<tr class="even">
<td><code>geom_label_s()</code></td>
<td>data labels</td>
<td>x, y, label, size, family, font face, colour, fill, alpha,
linewidth, linetype, group, vjust, hjust</td>
<td>yes</td>
</tr>
<tr class="odd">
<td><code>geom_text_pairwise()</code></td>
<td>data labels</td>
<td>x, xmin, xmax, y, label, size, family, font face, colour, alpha,
group, angle, vjust, hjust</td>
<td>horiz.</td>
</tr>
<tr class="even">
<td><code>geom_label_pairwise()</code></td>
<td>data labels</td>
<td>x, xmin, xmax, y, label, size, family, font face, colour, fill,
alpha, linewidth, linetype, group, vjust, hjust</td>
<td>horiz.</td>
</tr>
<tr class="odd">
<td><code>geom_text_npc()</code></td>
<td>annotations</td>
<td>npcx, npcy, label, size, family, font face, colour, alpha, group,
angle, vjust, hjust</td>
<td>no</td>
</tr>
<tr class="even">
<td><code>geom_label_npc()</code></td>
<td>annotations</td>
<td>npcx, npcy, label, size, family, font face, colour, fill, alpha,
linewidth, linetype, group, vjust, hjust</td>
<td>no</td>
</tr>
<tr class="odd">
<td><code>geom_point_s()</code></td>
<td>data labels</td>
<td>x, y, size, colour, fill, alpha, shape, stroke, group</td>
<td>yes</td>
</tr>
<tr class="even">
<td><code>geom_table()</code></td>
<td>data labels</td>
<td>x, y, label, size, family, font face, colour, alpha, group, angle,
vjust, hjust</td>
<td>yes</td>
</tr>
<tr class="odd">
<td><code>geom_table_npc()</code></td>
<td>annotations</td>
<td>npcx, npcy, label, size, family, font face, colour, alpha, group,
angle, vjust, hjust</td>
<td>no</td>
</tr>
<tr class="even">
<td><code>geom_plot()</code> , <code>geom_grob()</code></td>
<td>data labels</td>
<td>x, y, label, group, angle, vjust, hjust</td>
<td>yes</td>
</tr>
<tr class="odd">
<td><code>geom_plot_npc()</code> , <code>geom_grob_npc()</code></td>
<td>annotations</td>
<td>npcx, npcy, label, group, vjust, hjust</td>
<td>no</td>
</tr>
<tr class="even">
<td><code>geom_margin_arrow()</code></td>
<td>data labels, scale labels, data</td>
<td>xintercept, yintercept, label, size, family, font face, colour,
alpha, group, vjust, hjust</td>
<td>no</td>
</tr>
<tr class="odd">
<td><code>geom_margin_point()</code></td>
<td>data labels, scale labels, data</td>
<td>xintercept, yintercept, label, size, family, font face, colour,
alpha, group, vjust, hjust</td>
<td>no</td>
</tr>
<tr class="even">
<td><code>geom_margin_grob()</code></td>
<td>data labels, scale labels, data</td>
<td>xintercept, yintercept, label, size, family, font face, colour,
alpha, group, vjust, hjust</td>
<td>no</td>
</tr>
<tr class="odd">
<td><code>geom_quadrant_lines()</code> ,
<code>geom_vhlines()</code></td>
<td>data labels, scale labels, data</td>
<td>xintercept, yintercept, label, size, family, font face, colour,
alpha, group, vjust, hjust</td>
<td>no</td>
</tr>
</tbody>
</table>
<div id="geom_table-and-stat_fmt_table" class="section level3">
<h3>geom_table() and stat_fmt_table()</h3>
<p>The <em>geometry</em> <code>geom_table()</code> plots a data frame or
tibble, nested in a tibble passed as data argument, using
<em>aesthetics</em> <code>x</code> and <code>y</code> for positioning,
and <code>label</code> for the list of data frames containing the data
for the tables. The tables are created as ‘grid’ grobs and added as
usual to the ggplot object. In contrast to “standard” geoms, this geom
by default does not inherit the globally mapped aesthetics. Tables are
always added at their native sizes, which can be altered by changing the
<code>size</code> of the text in them.</p>
<p>Passing a data frame or a tibble results in the same plot, but there
is a difference in how a <code>list</code> is added as a column to them,
as shown below.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>tb <span class="ot">&lt;-</span> mpg <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">hwy =</span> <span class="fu">median</span>(hwy), <span class="at">cty =</span> <span class="fu">median</span>(cty))</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># using R&#39;s data frames we need to call I() to add the list as is</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>data.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">44</span>, <span class="at">tb =</span> <span class="fu">I</span>(<span class="fu">list</span>(tb)))</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>  <span class="fu">geom_table</span>(<span class="at">data =</span> data.df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> tb)) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co"># using &#39;tibble&#39; the list is added as is by default</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>data.tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">44</span>, <span class="at">tb =</span> <span class="fu">list</span>(tb))</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>  <span class="fu">geom_table</span>(<span class="at">data =</span> data.tb, <span class="fu">aes</span>(x, y, <span class="at">label =</span> tb)) <span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In plots with a single panel it can be easier to use
<code>annotate()</code> to add inset tables, here creating the same plot
as above. When using <code>annotate()</code> single data frames, ggplots
or grobs do not need to be wrapped in a list, although lists are also
supported.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>tb <span class="ot">&lt;-</span> mpg <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">hwy =</span> <span class="fu">median</span>(hwy), <span class="at">cty =</span> <span class="fu">median</span>(cty))</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;table&quot;</span>, <span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">44</span>, <span class="at">label =</span> tb) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Table themes are supported through parameter <code>table.theme</code>
and if variables or constants are mapped to the <code>colour</code>,
<code>fill</code>, <code>size</code>, <code>alpha</code> or
<code>family</code> aesthetics they override the corresponding default
theme settings. The display of <code>rownames</code> and
<code>colnames</code> can be enabled or disable through parameter
<code>table.rownames</code> and <code>table.colnames</code> and the
horizontal justification of text in the core of the table through
parameter <code>table.hjust</code>.</p>
<p>Parameter <code>table.theme</code> accepts as arguments
<code>NULL</code> for use of the the default as set at time of
rendering, a <code>ttheme</code> constructor function such as those
defined in package ‘gridExtra’, or the variations on them defined in
package ‘ggpp’. The active default can be set with function
<code>ttheme_set()</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="fu">geom_table</span>(<span class="at">data =</span> data.tb, <span class="fu">aes</span>(x, y, <span class="at">label =</span> tb),</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>             <span class="at">table.theme =</span> ttheme_gtsimple,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>             <span class="at">table.hjust =</span> <span class="dv">0</span>, <span class="at">colour =</span> <span class="st">&quot;darkred&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#FFFFBB&quot;</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Transparency can be set with the <code>alpha</code>aesthetic or in
the table theme.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">geom_table</span>(<span class="at">data =</span> data.tb, <span class="fu">aes</span>(x, y, <span class="at">label =</span> tb),</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>             <span class="at">table.theme =</span> ttheme_gtdefault,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>             <span class="at">table.hjust =</span> <span class="dv">0</span>, </span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">&quot;darkred&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#FFFFBB&quot;</span>,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Using <code>stat_fmt_tb()</code> we can rename columns and rows of
the tibble, reorder them and/or select a subset of columns or rows as
shown below. To provide a complete example we also replace the names of
the scales for <em>x</em>, <em>y</em> and <em>color</em> aesthetics.
Here we pass a <code>character</code> vector with the original names of
the columns in full, but partial matching is tried when needed. It is
also possible to use a <code>numeric</code> vector of positional
indexes.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="fu">geom_table</span>(<span class="at">data =</span> data.tb, <span class="fu">aes</span>(x, y, <span class="at">label =</span> tb),</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>             <span class="at">table.theme =</span> ttheme_gtlight,</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">&quot;darkblue&quot;</span>,</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>             <span class="at">stat =</span> <span class="st">&quot;fmt_tb&quot;</span>, </span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>             <span class="at">tb.vars =</span> <span class="fu">c</span>(<span class="at">Cylinders =</span> <span class="st">&quot;cyl&quot;</span>, <span class="at">MPG =</span> <span class="st">&quot;hwy&quot;</span>), <span class="co"># rename</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>             <span class="at">tb.rows =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span> <span class="co"># change order</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Engine displacement (l)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Fuel use efficiency (MPG)&quot;</span>,</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Engine cylinders</span><span class="sc">\n</span><span class="st">(number)&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Parsed text, using plot math syntax is supported in the table, with
fall-back to plain text in case of parsing errors, on a cell by cell
basis (see <code>tableGrob()</code> in package ‘gridExtra’ for details,
as this function is used to build the table). Here we plot the MPG for
city traffic and we can see that the plotting area expands to include
the coordinates at which the table is anchored. Justification is by
default set to <code>&quot;inward&quot;</code> which ensures that the table is
fully within the plotting region.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>tb.pm <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">&quot;frac(beta[1], a^2)&quot;</span>, <span class="st">&quot;frac(beta[2], a^3)&quot;</span>),</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>                <span class="at">Value =</span> <span class="fu">c</span>(<span class="st">&quot;10^2.4&quot;</span>, <span class="st">&quot;10^3.532&quot;</span>))</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>data.tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">44</span>, <span class="at">tb =</span> <span class="fu">list</span>(tb.pm))</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, cty)) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  <span class="fu">geom_table</span>(<span class="at">data =</span> data.tb, <span class="fu">aes</span>(x, y, <span class="at">label =</span> tb), <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>As implemented, there is no limitation to the number of insets, and
faceting is respected. If the base plot shows a map, multiple small
tables could be superimposed on different countries or regions. The size
of the table inset is given by the <em>size</em> aesthetic, so like for
<code>geom_text()</code> it is independent of the
<code>ggplot2::theme()</code> and controlled by the
<code>table.theme</code> directly or indirectly through the
<em>size</em> aesthetic.</p>
<p>Please see section <strong>Normalised Parent Coordinates</strong>
below for a description of <code>geom_table_npc()</code>.</p>
</div>
<div id="geom_plot" class="section level3">
<h3>geom_plot()</h3>
<p>The <code>geom_plot()</code> <em>geometry</em> plots ggplot objects,
nested in a tibble passed as data argument, using <em>aesthetics</em>
<code>x</code> and <code>y</code> for positioning, and
<code>label</code> for the ggplot object containing the definition of
the plot to be nested. With this approach in plots with facets the
insets can be different in each panel. It is also possible to inset more
than one plot in a single call simply by creating a tibble with multiple
rows.</p>
<p>Behind the scenes, one Grob is created for each plot to be inset. The
conversion is done with <code>ggplotGrob()</code> and the Grobs added to
the main ggplot object.</p>
<p>As an example we produce a plot where the inset plot is a zoomed-in
detail from the main plot. In this case the main and inset plots start
as the same plot. In most cases the size of text and other elements in
the inset should be smaller than in the main plot. Here we override the
default theme setting the <code>base_size</code> from its default of 11
pt to 8 pt.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>data.tb <span class="ot">&lt;-</span> </span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">44</span>, </span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>         <span class="at">plot =</span> <span class="fu">list</span>(p <span class="sc">+</span> </span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>                       <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">4.9</span>, <span class="fl">6.2</span>), </span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>                                       <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>                       <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>                       <span class="fu">theme_bw</span>(<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>                       <span class="fu">scale_colour_discrete</span>(<span class="at">guide =</span> <span class="st">&quot;none&quot;</span>)))</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>  <span class="fu">geom_plot</span>(<span class="at">data =</span> data.tb, <span class="fu">aes</span>(x, y, <span class="at">label =</span> plot)) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;rect&quot;</span>, </span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>           <span class="at">xmin =</span> <span class="fl">4.9</span>, <span class="at">xmax =</span> <span class="fl">6.2</span>, <span class="at">ymin =</span> <span class="dv">13</span>, <span class="at">ymax =</span> <span class="dv">21</span>,</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In general, the inset plot can be any ggplot object, allowing the
creation of very different combinations of main plot and inset plots.
Here we use the inset to show summaries as in the previous example of an
inset table.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), hwy, <span class="at">fill =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">&quot;col&quot;</span>, <span class="at">fun =</span> mean, <span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Number of cylinders&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title =</span> <span class="st">&quot;Means&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">guide =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>data.tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">44</span>, </span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>                  <span class="at">plot =</span> <span class="fu">list</span>(p <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>                                <span class="fu">theme_bw</span>(<span class="dv">8</span>)))</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>  <span class="fu">geom_plot</span>(<span class="at">data =</span> data.tb, <span class="fu">aes</span>(x, y, <span class="at">label =</span> plot)) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Engine displacement (l)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Fuel use efficiency (MPG)&quot;</span>,</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Engine cylinders</span><span class="sc">\n</span><span class="st">(number)&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The same plot as above can be created using <code>annotate()</code>,
but be aware that when using facets, ‘ggplot2’ annotations are identical
in all panels.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), hwy, <span class="at">fill =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">&quot;col&quot;</span>, <span class="at">fun =</span> mean, <span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Number of cylinders&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title =</span> <span class="st">&quot;Means&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">guide =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;plot&quot;</span>, <span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">44</span>, <span class="at">label =</span> p <span class="sc">+</span> <span class="fu">theme_bw</span>(<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Engine displacement (l)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Fuel use efficiency (MPG)&quot;</span>,</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Engine cylinders</span><span class="sc">\n</span><span class="st">(number)&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>As implemented in ‘ggpp’ geometries, there is no limitation to the
number of insets, and faceting is respected. If the base plot shows a
map or a bitmap, multiple small plots could be superimposed on different
countries or regions. The size of the insets is controlled by the
<code>vp.width</code> and <code>vp.height</code> aesthetics as a
fraction of the main plot’s plotting region. Consequently, the insets
are scaled together with the main plot. A possible unintuitive but
useful feature, is that the theme is linked to each plot.</p>
<p>Please see section <strong>Normalised Parent Coordinates</strong>
below for a description of <code>geom_plot_npc()</code>.</p>
</div>
<div id="geom_grob" class="section level3">
<h3>geom_grob()</h3>
<p>The <code>geom_grob()</code> <em>geometry</em> plots grobs (graphical
objects as created with package ‘grid’), nested in a tibble passed as
data argument, using <em>aesthetics</em> <code>x</code> and
<code>y</code> for positioning, and <code>label</code> for the Grob
object. While <code>geom_table()</code> and <code>geom_plot()</code>
take as values mapped to the <code>label</code> aesthetics tibbles or
data frames, and ggplots, respectively, and convert them into Grobs,
<code>geom_grob()</code> expects Grobs ready to be rendered. This means
that any Grob created using ‘grid’ or its extensions can be added as a
data label to a ggplot.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>file.name <span class="ot">&lt;-</span> </span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;Isoquercitin.png&quot;</span>, </span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>              <span class="at">package =</span> <span class="st">&quot;ggpp&quot;</span>, <span class="at">mustWork =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>Isoquercitin <span class="ot">&lt;-</span> magick<span class="sc">::</span><span class="fu">image_read</span>(file.name)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>grobs.tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">40</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">9</span>),</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>                   <span class="at">width =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="dv">1</span>),</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>                   <span class="at">height =</span>  <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.3</span>),</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>                   <span class="at">grob =</span> <span class="fu">list</span>(grid<span class="sc">::</span><span class="fu">circleGrob</span>(), </span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>                               grid<span class="sc">::</span><span class="fu">rectGrob</span>(), </span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>                               grid<span class="sc">::</span><span class="fu">textGrob</span>(<span class="st">&quot;I am a Grob&quot;</span>),</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>                               grid<span class="sc">::</span><span class="fu">rasterGrob</span>(<span class="at">image =</span> Isoquercitin)))</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>  <span class="fu">geom_grob</span>(<span class="at">data =</span> grobs.tb, </span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>            <span class="fu">aes</span>(x, y, <span class="at">label =</span> grob, <span class="at">vp.width =</span> width, <span class="at">vp.height =</span> height),</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">0.7</span>, <span class="at">vjust =</span> <span class="fl">0.55</span>) <span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.3</span>, <span class="at">add =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.2</span>, <span class="at">add =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="dv">12</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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7z1thO985zv5+flCiGPHjjkZyrf4i6Oh4G/j/38s/D+hSkj9ENI514813jXk9OnTP/30008++cR5BXYj1ahRo1z8YHV1tRCiubm5w3dtNtsrr7zSp0+fxMREq9XquLpVq1adPXt2+vTpERER9vk1NTXjx483Go0bNmzobMx2ysvLs7KynC9TU1PjuKPvn/iLo+msNPkOHsC95R/+4R8c79DiDsfT5crLy138VEhISHR0dHBwcIfvKoryq1/96tq1a0eOHKmtrZ00adJvf/vbNWvWpKamrl27dtiwYQUFBTabzWKx3H///ePGjautrT1+/HhDQ8NLL70UFBTkSoAHHnjg9ddfv+tiI0aMcPEngn/iMjkA6I7Tp0/36dNHu89uampqv379XP/smTNnAgIC/vu///vZZ591slhsbOyxY8eEENHR0Y4X4h87dmzDhg1nz57tbnZRV1eXlJSkHYSHrNiDB4DuGD58+KeffhoeHt6vXz+j0Wi1Wl3/rKIoAwcOfO6551z/iONt4955550BAwZ0IesdtCvc3HwKAPwce/AA0E0jRoy4fPly9z77zTffKIoyaNCgb7755q4L5+bmzpgxo7S0VJtcsWLFlStXurdeu/z8/L59+7p5W1/4M/bgAcA3oqOjL168ePjw4bsuOXPmzObm5vvvv3/dunW9e/c2mUxd+kagQ4qirFu3zv5LA+TDHjwA+MapU6eCg4MfffRR1YX7ylVUVGiL/eIXv9ArwM9+9jODweDpm+3AV9iDBwDfCAoK0m6JoyiKK8trd83TN4PFYnn55Zf1HRN+goIHAB04finu+MV2bW3tp59+2tntYO13az9x4oQuMb744osnn3xSuzWQK+67776cnBxXDiG0Y7VaP/vsM/sNelVVdfyp3T9FAO7zYsFb8jJMmow8i/dWCwBe8J3vfMf+eubMmdqLIUOGDBky5OjRo8HBwVOmTLnzU4GBgePGjRNCuPno9BdffLFv376Konzve997//33IyIiAgICnnrqKVc+W1tb+9BDD3VpdeHh4TExMQUFBQaD4fvf/74Qoq6ubtKkSfYFHLcGfMVrBV+8KT03OstsNps3Lxa56ZuKvbViAPCJc+fOhYWF1dfXp6Wlqar61VdfdfgcOW3fXVXV6dOnd2n8iooK5aaNGzdqO9Dac960Ad99913t3ccff9zJPrrBYAgLC3P9krn8/Py4uLhr1649//zzqqpyMb3f8lbBW6oqRVJighBCRM1fmCQqq9iJB+Ca3/3ud3oN9a//+q9CiMDAwOHDh+s1pt2am7Qr337yk5988MEH9nd37dr10ksvdfjBYcOGCSGOHDly14vpGxsb16xZo9W244/wyCOPfP3116qq1tfXBwUFTZgwwfFThw4dCggIUBTl1Vdf7fCXjP3797u+z52WluZY6j//+c+zs7OFEJcuXbJvAReHgkd5q+Cjps6IyS/UdtuLC/NjZkyN8tKaAfRczc3NsbGxK1eunDx5stZMbW1tjz76qH2BwYMHd2nAv/71r4qiREVFuXL1eVc9f1Pfvn2FELW1tY73ozUYDNptye/8oP2edJGRkR2O/PHHH0+aNElRlF69etnPievfv395ebn2tLq//OUvQ4cO1eY3Njbab0p/4cKFH//4x/ZxfvnLXwYFBQUHB+/cubPdKtavX19WVnbXn1Eb3GAw2Odoz8gRQvTp08e+Be46DrxA6ca5Fd1lyctIz60QImbx5pz57fo9Pj7ecdLx114A9yZVVQcOHFhdXR0SElJbWztixAitIB9++GH7HmRkZKTjLd6cGzVq1KJFi15++WVVVYcMGfLuu+8mJCToldYxiXYX2J07d37wwQe5ubnazMmTJ3/00UfBwcFbt27NysqKjIxcv3793LlztXeTk5O1u9JOmTLlT3/6kzYzKysrNze33cHziRMnHjx40Pnp9I899tgf//hH++F6jaqq2dnZv/3tb+1zQkNDV65c+dOf/vTOH8FRQUFBenr6xYsXMzIyVq1apV2n99prr2nvDh8+/PTp0w0NDY888sjRo0edDwVPePzxx+1na97GU0+3aa9oY0rKsn3VqqpW71uWkrKxqPNFeZqc2hMSqoTUDyE79OKLL7722mv2yeeee+7QoUOtra3jxo2zz2z3j5iTkK2trfZHtquq2tDQoO8/gI6j2ROGhYXNnz+/oaFh1qxZAwYMaBfy4sWLc+fODQkJGTFixP/93/85+Rf8u9/9bm5uruthbDZbcHCw82U++OCDkSNH2n9RMJvNX3/9tf1htdXV1YmJicHBwfPmzTt//ny7z4aEhKSlpTU0NIwcOXLw4MGqql69enXkyJEdbg3P4S+OxtePi63et+xWqRdtvNH1HaPg1Z6QUCWkfgjZoQcffLCqqso+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" style="display: block; margin: auto;" /></p>
<p>As shown above for inset tables and inset plots, it is also possible
to use <code>annotate()</code> with Grobs. The next example insets a
single <code>Grob</code>. Here we reuse the bitmap
<code>Isoquercitin</code> read in the previous example. The Grob is
contained in a viewport. Here setting <code>width = 1</code> (“npc”
units) when creating the <code>Grob</code> from the bitmap ensures that
the bitmap fills the width of the viewport (to ensure that the inset is
not distorted, set only one of <code>width</code> or
<code>height</code>). The argument to <code>vp.width</code> or
<code>vp.height</code>, also in “npc” units, determines the size of the
<code>Grob</code> relative to the size of the plotting area.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;grob&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">3</span>, <span class="at">vp.width =</span> <span class="fl">0.5</span>,</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>           <span class="at">label =</span> grid<span class="sc">::</span><span class="fu">rasterGrob</span>(<span class="at">image =</span> Isoquercitin, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="dv">12</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p><code>geom_grob()</code> is designed thinking that its main use will
be for graphical annotations, although one could use it for infographics
with multiple copies of each grob, this would go against the grammar of
graphics. In this implementation grobs cannot be mapped to an aesthetic
through a scale.</p>
<p>As implemented, there is no limitation to the number of insets and
faceting is respected. If the base plot shows a map or a bitmap,
multiple simple grobs (e.g. national flags) could be superimposed on
different countries. The size of the insets is controlled by the
<code>vp.width</code> and <code>vp.height</code> aesthetics as a
fraction of the main plot’s plotting region. Consequently, the insets
are scaled together with the main plot.</p>
<p>Please see section <strong>Normalised Parent Coordinates</strong>
below for a description of <code>geom_grob_npc()</code>.</p>
</div>
<div id="geom_vhlines" class="section level3">
<h3>geom_vhlines()</h3>
<p>This is a convenience geometry that adds both vertical and horizontal
guide lines on the same plot layer, using the same syntax as
<code>geom_hline()</code> and <code>geom_vline()</code> from package
‘ggplot2’.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="fu">geom_vhlines</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">2.75</span>, <span class="dv">4</span>), <span class="at">yintercept =</span> <span class="dv">27</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Engine displacement (l)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Fuel use efficiency (MPG)&quot;</span>,</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Engine cylinders</span><span class="sc">\n</span><span class="st">(number)&quot;</span>) </span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_text_s-geom_label_s-and-geom_point_s" class="section level3">
<h3>geom_text_s(), geom_label_s(), and geom_point_s()</h3>
<p>With package ‘ggrepel’ we have become used to easily add data labels
linked to the observations or points by a line segment or arrow.
However, sometimes a plot has few text labels and repulsion is
unnecessary. In such cases nudging or dodging may be enough, or even
preferable so as to achieve consistent positions irrespective of plot
scaling or graphic device used for rendering.</p>
<p>We can achieve this with <code>geom_text_s()</code> (formerly named
<code>geom_text_linked()</code>) or <code>geom_label_s()</code>,
together with a suitable position function that retains the original
<em>x</em> and <em>y</em> coordinates of the point. We provide several
different position functions described in a later section, all of which
retain the initial position in <code>data$x_orig</code> and
<code>data_$y_orig</code>. Function <code>position_nudge_keep()</code>
is used by default providing the same default behaviour as
<code>geom_text()</code> and <code>geom_label()</code> from ‘ggplot2’.
However, when nudging using the <code>nudeg_x</code> and/or
<code>nudeg_y</code> parameters, or passing as argument to
<code>position</code> a position function that keeps the original
position, by default linking segments are drawn between the original and
nudged or displaced positions. Passing <code>add.segments = FALSE</code>
disables the drawing of segments. The equivalent geometry for points
connected by segments to their original positions is
<code>geom_point_s()</code>.</p>
<p>These geometries do not use like those in package ‘ggrepel’ special
aesthetics to set the properties of segments. These geometries allow the
user to select to which graphic elements to apply the mapped aesthetics.
In addition <code>geom_label_s()</code> adds support for
<code>linewidth</code> and <code>linetype</code> aesthetics for the
box.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>my.cars <span class="ot">&lt;-</span> mtcars[<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>), ]</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>my.cars<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(my.cars)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>my.cars <span class="ot">&lt;-</span> my.cars[<span class="fu">order</span>(my.cars<span class="sc">$</span>wt), ]</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="fu">ggplot</span>(my.cars, <span class="fu">aes</span>(wt, mpg, <span class="at">label =</span> name)) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>  <span class="fu">geom_text_s</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(cyl)),</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>              <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>              <span class="at">nudge_y =</span> <span class="sc">-</span><span class="fl">1.5</span>, </span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>              <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;mm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">l =</span> <span class="dv">40</span>) <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>my.cars <span class="ot">&lt;-</span> mtcars[<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>), ]</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>my.cars<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(my.cars)</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>my.cars <span class="ot">&lt;-</span> my.cars[<span class="fu">order</span>(my.cars<span class="sc">$</span>wt), ]</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="fu">ggplot</span>(my.cars, <span class="fu">aes</span>(wt, mpg, <span class="at">label =</span> name)) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>  <span class="fu">geom_label_s</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(cyl)),</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">2.5</span>,</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>               <span class="at">colour.target =</span> <span class="fu">c</span>(<span class="st">&quot;box&quot;</span>, <span class="st">&quot;segment&quot;</span>),</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>               <span class="at">nudge_x =</span> <span class="fl">0.2</span>,</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> grid<span class="sc">::</span><span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;mm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">l =</span> <span class="dv">40</span>) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fl">6.5</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="geom_text_pairwise-and-geom_label_pairwise" class="section level3">
<h3>geom_text_pairwise() and geom_label_pairwise()</h3>
<p>When labels show the results of pairwise comparisons, it is natural
to use a segment to connect the members of the pairs compared to a
textual label.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># With a factor mapped to x, highlight pairs</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>my.cars <span class="ot">&lt;-</span> mtcars</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>my.cars<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(my.cars)</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my.cars, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), mpg)) <span class="sc">+</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>       <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.33</span>)</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>my.pairs <span class="ot">&lt;-</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">A =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">B =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">bar.height =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">30</span>),</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>             <span class="at">p.value =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05678</span>))</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>p1 <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>  <span class="fu">geom_text_pairwise</span>(<span class="at">data =</span> my.pairs,</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">xmin =</span> A, <span class="at">xmax =</span> B,</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>                         <span class="at">y =</span> bar.height,</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>                         <span class="at">label =</span> p.value),</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>                     <span class="at">parse =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAAAw1BMVEUAAAAAADoAAGYAOpAAZrYzMzM6AAA6ADo6AGY6Ojo6OpA6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmkJBmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQkDqQ27aQ2/+rbk2rbm6rbo6rjk2ryKur5OSr5P+2ZgC22/+2/9u2///Ijk3I///bkDrb///kq27k////tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///8uE0byAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMQklEQVR4nO3dDVsaywGG4dEQk9Y1xlOTNJrTYqs5PYVWQQRaROb//6ruB+BC1t2tYXbeWZ77OpEVMhcT8mT2A/UYCwgzvicAlDG+JwCUMb4nAJQxvicAlDEvPzSJog8Da0dRdgt4YF58ZPZlYEcfrb3rNjYZYJspfTSOdPG9l7vjLdCMWoHGK+j8Mt7Fd9dxvvpfAvD/qBPo7NNJz84+9+zzKkqgaEa9FXT+LStzfRxKoGhGvUBXZRIoGlYd6OT0IVlBk5vFb6vLTASKZtRYQUdRFB+Drm42hwFu1dzFvzQMcItAIY1AIY1AIY1AIY1AIY1AIY1AIS2gQPlHsY8IFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIINEB9Y97cb25Pj0y2kX0+Nqlz+3SV+70hItDwDN/cP111NrfHywr7x/Gv1XbyWLzdD7lQAg3O49l5HOTh7cb2MAt2+u56+SG+++B64/MwEWhw0t7SMnPbycppnxfSWLqwEmiDCDSTLp7LQFfbj2d/MCZdSMfprc0WUMsuvkEEmllGeZzfnh7Fn07/eN836+PRfrbT73OS1BQCzRStoOkD8W26WKafZ3c+nnXiVTRbUsNEoMEpPAZNxLfpuVLuLCr9yDFoMwg0U3QWn62kv1yvbtPrT5ZAG0WgS/3cddDl9tPVeXrs+XR1vGwzOwRNdvGcJDWEQFfiE59OcoZ+vN6OS8xOhlbvHGUPPt8fLKFA3/4sB3OCb0qBeh4PRTUCnUTRh4G188vo9GF7mIup+BoPRdWBzr4M7OijXdx0k5utYS6m4ms8FNXbxceRzn8dpK1uDnMxFV/joaheoPHSOfv6YOffenZ5MuNwKr7GO2eC5+FFqxPo7NNJz05OV4Hmh7mYiq/xUFRvBY3LfF5B88NcTMXXeCiqeZnprssxKHyoDnS5b1/cXHAWj8bVWEFHURQfg3IdFD7wThKkESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikKQX6sxzMCb4RKKQpBep5PBQRKKQRKKQRKKQRKKQRKKQRKKQRKKQRKKTVCHT2KYq61o6iKPow2BrmYiq+xkNRdaDzbz07+9yzd92CYS6m4ms8FFUHOvkYf7jrLr73Coa5mIqv8VBU7xg0XkXnl1G6p19+UYfDqfgaD0W1Al3cXKR7+edVlEDRjDqBzi8vllvr41ACRTNqncV3V5sEioZVB7rsc3L6YBe/cZkJzaoONLn+mZwexbcn6xN5AkUzeCcJ0ggU0ggU0ggU0ggU0ggU0ggU0ggU0ggU0ggU0ggU0ggU0ggU0ggU0ggU0ggU0ggU0ggU0ooCfTwzS52qYS6m4ms8FBWuoMPD2yTT46erlwolUDSjeAU9T27Gh7fjpNSyYS6m4ms8FBEopJXu4u3wzX35MBdT8TUeiorP4sfJGdK5HR5cVwzb6VT4P83hB0KXmRSfE74RKKQVBzrMdvHVw5pEoPuo/CSpcliTCHQflV9mqhzWJALdRwQKaYW7+HFyeYldPASUf7GIafKdpCoEuo+4zARpBApphYFOj0r375ZA0ZSiQF/+MtAfhjWJQPdRyWWmOsOaRKD7qHgFJVCIKL4OWnL0uTmsSQS6jzhJgrTiXXzJe0ibw5pEoPsooJOk4PGivUJAJ0nB40V7heJj0PeKJ0nB40V7hbIvFhE7SQoeL9orBPRefPB40V6BQHeH75t2gEB3h5884QCB7g6BOkCgu0OgDhDo7hCoAwS6OwTqAIHuDoE6QKC7Q6AOEOjuEKgDBLo7BOpAjUBnn6Koa+38Mjp92B6GHAJ1oDrQ+beenX3uLW66dvRxexhyCNSB6kAnSZV33fmvAzv7MtgahhwCdaDeMWi8is6+PqSL6fJrIlzPK0QE6kCtQBc3F3Zyugo0Pww5BOpAnUDnlxfxqdJXAq3Al9s5UOssvht/5Bi0EoE6UB1o1me6m+csvhS7eAeqAx1FiS7XQSsRqAO8k7Q7BOoAge4OgTpAoLvT9kC9nMYR6O60PFA/FxoIdHcI1MWzLm/N64Yhh0BdPOvy1rxuGHJaHijHoKFre6BeEOjuEKgDBLo7BOoAge5O6wP1MUEC3Z3WfzUTgbZb8C8agbZb8C8agbZb8C8agbZb8C8agbZb8C8agbZb8C8agbZb8C8agbZb8C8agbZb8C8agbZb8C8agUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagcIrxZ8fSaBYU/wJvASKNQKFNAKFNAKFNAKFNAKFNAKFNAKFNAKFNAKFNAKFtGDfi599GVg7iqLow2BrGNok1EAnaZh33YJhaJNAd/F3J7/HK+jie8/xVOBboIFmu/j5ZbyL76ZDHC3m8C3oQGefe7lVlEDbKOhAU+vjUAJtIwKFtKADnZw+2MVvXGZqs6ADTa6DnqxP5Am0jYIN9OVhaBMChbRQ30kqGYZ9wg9ugDQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQChTQCbV7fmDf329uPv1x7nBLy9jzQ4Zv7p6vO9nb/gEBV7Hegj2fn1o4Pbze2H88MgcrY70Cn766XZea2x510ExL2O9B08VwGmtsmUB0EGkd5vLVNoDoIlBVU2n4HWngMSqBK9jvQwrN4AlWy34Hafu466PM2gerY80CTd4/iJp+ujtfblkCV7HugEEegkEagkEagkEagkBZQoCZ4Hl604AUUKPYRgUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagUIagaKut289/LUTKGp6+9ZHoQSKmggU0oQDnX0ZWDu/jE4ftodhj8geg06iDwO7uOna0cftYYBbNQK9O/k9XkHnvw6ylXRjGOBW7V387OuDnX/rWV/HIthPtQOdnK4CzQ8D3HrFCpofBrhVO1COQeFD7UAXNxecxaNxXAeFNN5JgjQChTQChTQChbTXBgo043WB+hD8qs0f4CcYj89dE3+/vhFoKf5+fSNQ4AXG9wSAMsb3BIAyxvcEgDLG9wSAMsb3BCol37UXsMVNdNKr/m26Zp+S7530xvh76ppGUdf3FH7GXTf9rplgJd9NMfL4BzDenrmm2Z//0vU9h5+QfENC0NJv+fH4hzDenrmexfd/Br2Ln339R9i7eFbQcqOLsI9BZ5+66SIUro3vqGie8ffUdcR/t4EHuvFNsQGafe7ZicezJOPtmWsZRYkL39N4vflfAw908+ciNM94e+a6wl5Bk7P4oHfxrKBVAg80PoTzeRnx500ir2d5xt9TA9WM7wkAZYzvCQBljO8JAGWM7wkAZYzvCQBljO8JtMDQHFxv3/eff23f83R1vnXP9N314y8/jMQG43sC4Xs82y4vbW/7rmGn6DeN39w7mlZLGN8TCF9BjAX3FayVyW/6cV3FBuN7AsGbHhnTST+a42RHvvrseLltp+//Zg5vh8lSubynnyymw05aMUtoOeN7AuFLOkt388PD26erTrqdLY6d9Nf0qJOkmdabPTo+vE2WzjTQovUXz4zvCYQvSey/99nGKrf08DLOMPkwPTpfHqiuHk0Tfn+bflp0BItnxvcEwpdlN4538QfXaZQ2d/6zijbtcPVocsIU/5c+kC6teJHxPYHwZbv4g+tko2ag0/f/vjon0DqM7wmEbx3j+GBzF59cHU128etA18ebT1d/en9r2cXXYHxPIHyrGKdHB9erE6Mku/VJUpplf3mSlPxKru13lr1yklTO+J5A+NLE+vER6N/TKtMLSfHnnfVlpuwYNXeZKbk2tVpQh1xmKmV8T2BfbF6oj8/hsw0u1FcwviewNzbe6hyuzoy4Tl/B+J7A3sitldOjVZZ8sUgV43sCQBnjewJAGeN7AkAZ43sCQBnjewJAGeN7AkAZ43sCQJn/AQfUBYakmg5LAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>p1 <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>  <span class="fu">geom_label_pairwise</span>(<span class="at">data =</span> my.pairs,</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">xmin =</span> A, <span class="at">xmax =</span> B,</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>                          <span class="at">y =</span> bar.height,</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>                          <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;italic(P)~`=`~%.2f&quot;</span>, p.value)),</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>                      <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="fl">2.75</span>,</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>                      <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">angle =</span> <span class="dv">30</span>,</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>                                          <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>, <span class="st">&quot;mm&quot;</span>),</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>                                          <span class="at">ends =</span> <span class="st">&quot;both&quot;</span>),</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>                      <span class="at">parse =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>p1 <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  <span class="fu">geom_text_pairwise</span>(<span class="at">data =</span> my.pairs,</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">xmin =</span> A, <span class="at">xmax =</span> B,</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>                         <span class="at">y =</span> bar.height,</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>                         <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;italic(P)~`=`~%.2f&quot;</span>, p.value)),</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>                     <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">colour.target =</span> <span class="st">&quot;segment&quot;</span>,</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>                     <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>                                         <span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;mm&quot;</span>),</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>                                         <span class="at">ends =</span> <span class="st">&quot;both&quot;</span>),</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>                     <span class="at">parse =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>p1 <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>  <span class="fu">geom_text_pairwise</span>(<span class="at">data =</span> my.pairs,</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">xmin =</span> A, <span class="at">xmax =</span> B,</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>                         <span class="at">y =</span> bar.height,</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>                         <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;italic(P)~`=`~%.2f&quot;</span>, p.value)),</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>                     <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">colour.target =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>                     <span class="at">arrow =</span> grid<span class="sc">::</span><span class="fu">arrow</span>(<span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>                                         <span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;mm&quot;</span>),</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>                                         <span class="at">ends =</span> <span class="st">&quot;both&quot;</span>),</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>                     <span class="at">parse =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Another situation where horizontal or vertical segments can be useful
if to label ranges of values of a continuous variable.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># with a numeric vector mapped to x, indicate range</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(my.cars, <span class="fu">aes</span>(disp, mpg)) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>my.ranges <span class="ot">&lt;-</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">A =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">400</span>),</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>             <span class="at">B =</span> <span class="fu">c</span>(<span class="dv">200</span>, <span class="dv">500</span>),</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>             <span class="at">bar.height =</span> <span class="dv">5</span>,</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>             <span class="at">text =</span> <span class="fu">c</span>(<span class="st">&quot;small&quot;</span>, <span class="st">&quot;large&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>p2 <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>  <span class="fu">geom_text_pairwise</span>(<span class="at">data =</span> my.ranges,</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">xmin =</span> A, <span class="at">xmax =</span> B,</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>                     <span class="at">y =</span> bar.height, <span class="at">label =</span> text))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>p2 <span class="sc">+</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>  <span class="fu">geom_label_pairwise</span>(<span class="at">data =</span> my.ranges,</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">xmin =</span> A, <span class="at">xmax =</span> B,</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>                          <span class="at">y =</span> bar.height, <span class="at">label =</span> text))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="normalised-parent-coordinates" class="section level3">
<h3>Normalised Parent Coordinates</h3>
<p>R’s ‘grid’ package defines several units that can be used to describe
the locations of plot elements. In ‘ggplot2’ the <em>x</em> and
<em>y</em> aesthetics are directly mapped to <code>&quot;native&quot;</code> or
data units. For consistent location of <strong>annotations</strong> with
respect to the plotting area we need to rely on <code>&quot;npc&quot;</code> which
are expressed relative to the size of the grid viewport. The plotting
area in a ggplot is implemented as a ‘grid’ viewport and support for
<code>&quot;npc&quot;</code> coordinates is relatively easy to implement.</p>
<p>To support <code>&quot;npc&quot;</code> positions we have implemented
<em>scales</em> for two new (pseudo) <em>aesthetics</em>,
<code>npcx</code> and <code>npcy</code>. These are very simple
continuous scales which do not support any transformation or changes to
their limits, both of which would be meaningless for <code>&quot;npc&quot;</code>
units. Variables mapped to these aesthetics can be either numerical with
values in the range zero to one or character. A limited set of strings
are recognised and converted to <code>&quot;npc&quot;</code> units:
<code>&quot;bottom&quot;</code>, <code>&quot;center&quot;</code>, <code>&quot;top&quot;</code>,
<code>&quot;left&quot;</code>, <code>&quot;middle&quot;</code>, <code>&quot;right&quot;</code>
(<code>&quot;centre&quot;</code> is a synonym for <code>&quot;center&quot;</code>).</p>
<p>To make these scales useful we need also to define
<em>geometries</em> that use these new aesthetics. Package ‘ggpp’
currently provides <code>geom_text_npc()</code>,
<code>geom_label_npc()</code>, <code>geom_table_npc()</code>,
<code>geom_plot_npc()</code> and <code>geom_grob_npc()</code>.</p>
<p>As is the case for <code>geom_text()</code> and
<code>geom_label()</code> from package ‘ggplot2’, <code>&quot;bottom&quot;</code>,
<code>&quot;center&quot;</code>, <code>&quot;top&quot;</code>, <code>&quot;left&quot;</code>,
<code>&quot;middle&quot;</code>, <code>&quot;right&quot;</code>, plus <code>&quot;inward&quot;</code>
and <code>&quot;outward&quot;</code> can be used, as well as numeric values, to
control the justification. Justification defaults to
<code>&quot;inward&quot;</code> in the geometries described here.</p>
<p>While the usual <em>x</em> and <em>y</em> aesthetics are used
whenever the positions of plot elements represent data values, these new
scales and geometries are useful only for annotations, i.e., in those
cases when we want plot elements at specific positions within the
plotting area irrespective of the ranges of the data mapped to the
<em>x</em> and <em>y</em> aesthetics. When writing scripts or functions
that may be applied to different data sets these new <em>aesthetics</em>
help by keeping the code concise and reusable. These <em>geometries</em>
are used by default by several of the statistics described in later
sections and those defined in package ‘ggpmisc’.</p>
<p>As an example let’s imagine that we want to add the structure of a
metabolite to a plot. Its position has nothing to do with the data
mapped to <em>x</em> and <em>y</em>, so it is conceptually better to use
<code>&quot;npc&quot;</code> coordinates. The big practical advantage is that this
also allows to keep this part of the plot definition independent of the
data being plotted, giving a major advantage in the case of plots with
facets with free scale limits. This example can be easily adapted to
<code>geom_plot_npc()</code> where a list of ggplots is mapped to
<code>label</code>, and to <code>geom_table_npc()</code> where a list of
data frame is mapped to <code>label</code>.</p>
<p>We produce the example plot by first constructing a tibble to contain
the grob and the coordinate data, and then map these variables to
aesthetics using <code>aes()</code>. In the example the tibble has a
single row, but this is not a requirement. In this respect these geoms
behave as normal geoms, with facets also supported.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>file.name <span class="ot">&lt;-</span> </span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>  <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;Robinin.png&quot;</span>, </span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>              <span class="at">package =</span> <span class="st">&quot;ggpp&quot;</span>, <span class="at">mustWork =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>Robinin <span class="ot">&lt;-</span> magick<span class="sc">::</span><span class="fu">image_read</span>(file.name)</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>data.tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">y =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>flavo.tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fl">0.02</span>,</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fl">0.95</span>,</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>                   <span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>                   <span class="at">height =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>                   <span class="at">grob =</span> <span class="fu">list</span>(grid<span class="sc">::</span><span class="fu">rasterGrob</span>(<span class="at">image =</span> Robinin)))</span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a><span class="fu">ggplot</span>(data.tb, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a>  <span class="fu">geom_grob_npc</span>(<span class="at">data =</span> flavo.tb, </span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">label =</span> grob, <span class="at">npcx =</span> x, <span class="at">npcy =</span> y, </span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a>                    <span class="at">vp.width =</span> width, <span class="at">vp.height =</span> height)) <span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">55</span>, <span class="at">x =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Alternatively, we can pass constant values to
<code>geom_grob_npc()</code> to obtain the same plot. This approach can
be handy in simple cases.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">ggplot</span>(data.tb, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>  <span class="fu">geom_grob_npc</span>(<span class="at">label =</span> <span class="fu">list</span>(grid<span class="sc">::</span><span class="fu">rasterGrob</span>(<span class="at">image =</span> Robinin, <span class="at">width =</span> <span class="dv">1</span>)), </span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>                <span class="at">npcx =</span> <span class="fl">0.02</span>, <span class="at">npcy =</span> <span class="fl">0.95</span>,</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>                <span class="at">vp.width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">vp.height =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">55</span>, <span class="at">x =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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HhdPb8vtdvvfLoBWZc5Y9PrnprCwsLCwUP9g2Z+dNGmSHoHVrry83EmZTeeXlJTop7p37/7MM8/YnzrnnHN87STNmjVLz586derevXv9bFe3zPzXzaqhIuBNt3TpUv3JKSkp8bqADni9TH5+vp9lrIdVVVX6/gVCiIULF9bV1Xks/9xzzwkh9DiJfrz88sv6I23fkP47bty4goKCgoICPg9ARJg20M0pjfTDxx57bP78+eLXB/Ato0eP9l/agQMHhBAPPvigx/wZM2bof9OcOXPeeustXXhRUdHZZ5/9ySef6Kf0uO4NDQ1//vOf9QKdO3fWTz355JP2/YCmXn31VSHE3r17A3npMJOUctq0afqT439AYr1Mly5drAPpDz/8sH5KHzaPj4+3xrXNzMwcOnSoXiU/P99qkVtuvPFGIYS+m58f1113nRDC62g5nTt3jo+Pj4+Pd/pSAYRHK+1QBKElh+iFEJMmTcrPz588ebL17L///W/nLzCg/4YQ4uOPP7Y/dLhiU6+88oqT1QUteKPptnuziwlvh+irq6sHDRrk8b2eNGmSk/sEnn/++cLBzQm11NTUzMxMPd3Q0CA4RA9EB9MO0etp+zl4IcS6deusBfTtVgsLC51XwHnGeyzWwt+1c8455/7773eyRensxu1e7dix49lnn1UEfFRy/sHzfw5+ypQpzjfqcrkC3cvXy+uDZDfddJMi4IEo4Cs9Y28ku7S0NOv6n/j4eOvQ4ooVK6677jr9qvr27Tt37txFixZNnz7decnt2rX76aef3njjjWZvxiqEWLhwob4bm96TaIm9e/dKKe++++5ml3R44ZOHhoaGbt26CW9XVwcthEWZZP/+/XpQmoDExcUNHTo0JBVYvny584WTkpKEELt373a+ilKqf//+33///fbt26059medFwWg1YVn/8KJltxNTghx0UUXnXbaaS2sg8P/yYoVK4QQDz/88B133CGEuOOOO1q43Xnz5tm7LzWlexjccMMNgZasG1v6CqiJEycKIVJSUoQQ2dnZwVdXqbvuuksIkZycLIRwuVwtKcoMOiw1PUCsc86/hsJZL3onOnXqFG2/AACC4ys9pYqane709HSrWRApOg6llE7aytZleKHadLNFBbTF/fv3JyYmWq/FY92WVD6ERRnD/vY5eSvtKxYWFi5YsMDhwocPHw5Jdzb9ru3evfviiy9ueWkAIshXesZqL/pWohqbU59++qmThUOYag8++OAJJ5zgZItSyvbt/Z1baWhokFImJiYqpY4fP56QkGCdvG9aVJcuXZxXsn379n6KarP9qPV/2D7HulTSP90P1GG6h5BVW9IdMJjJAd+/f39rhJBx48ZZN1NfuXJlWlrarl27/KyrDz630Lx585yPVXfnnXf+8MMPTpZUSq1fv15K6XV43bPOOqtbt276mHxqaqqU8rnnnvO1I6KUeumll3wVZafHNtcjCvgq6rXXXpNSWvdEca6+vl4P36tHEgx09ZawtltVVdWScj777DP7w7g4R9+s3//+9wcPHnS4iYsuukgI0a5du0Dr5qFfv356wn7bWcu+fftSU1PtV83ZPxthG9EZQAiE4vh/aLTkHLxXQgirTN1OVUp17dpVNLZgTj/99KZrud1u/Z8J9EyqxdqTsBswYECzK+qMcb4h/SoGDx5szRFCbN68WSmlf7s7derksCjdNezNN99s+pQeB9B5B36dAVlZWUqpc889V798fWczD/YRWK3XXl1d3bFjRz1fFxJyN9xwgzX2S2VlpbB1NGs6DowT+tCF9VAI0dDQ0OxaCxcuHDJkSLOLWf8lD0H/c/x89/U+xObNm/VHS5/v93hpwW0UQOsx5zI555oG/KJFizx+rbwOchfE3o99EFD/Jk+e7L/O9913n/PtKqX00CUffPCBfmi1CAMqRDXuEwghrOunP/74YyFE165dAy1KKZWZmalbgfqhlfFTpkyx/hWlpaXW8kKI1NRUj0KefvppvWTv3r31cYiW0GMkCCEuuOCCiooKPVOPlaSn33nnHSFEr169nJf51VdfCVv/A2sTek6z77WT2jard+/ejz32mMMK+/9s2+fbu1Y4rDOAiGijAe9BH4+1L+C1GbR582b/v4Papk2brIagB2u4XD+/y+PHj/c6FEkQv6E1NTVCiN/97nf66OvGjRsDLcGiW9LWcfJNmzYFXZT9hVjjongdhFUfNfFTVGlp6c0336yrNGvWLI9n7ceNPZ4qLi7u0aOHx5viUUnrMm5rFa9b8bqufYslJSULFy5ctGiRNWfatGnCxx5bv379vB7U0QO+emUvWQ8F39TMmTP9VNh+F3lfr6jpQ49N+CkfQES00YD3aMF7DXgppf2n03pKa3q/GX0YoKmCgoKmdbAfdb/99tut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" style="display: block; margin: auto;" /></p>
<p>We can also use <code>annotate()</code> if the annotation should be
the same for all panels, or if we have a single figure panel. In this
case there is no need to wrap a single <code>grob</code> in a list.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">ggplot</span>(data.tb, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;grob_npc&quot;</span>, <span class="at">label =</span> grid<span class="sc">::</span><span class="fu">rasterGrob</span>(<span class="at">image =</span> Robinin, <span class="at">width =</span> <span class="dv">1</span>), </span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>                <span class="at">npcx =</span> <span class="fl">0.02</span>, <span class="at">npcy =</span> <span class="fl">0.95</span>, <span class="at">vp.width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">vp.height =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">55</span>, <span class="at">x =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Two additional geometries are based on existing ‘ggplot2’ geometries.
They are based on <code>geom_text()</code> and
<code>geom_label()</code>. We give an example using
<code>geom_text_npc()</code> to produce a “classic” labelling for facets
matching the style of <code>theme_classic()</code> and traditional
scientific journals’ design.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>corner_letters.tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">label =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>                            <span class="at">x =</span> <span class="st">&quot;right&quot;</span>, </span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>                            <span class="at">y =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>                            <span class="at">cyl =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>))</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>cyl, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>  <span class="fu">geom_text_npc</span>(<span class="at">data =</span> corner_letters.tb,</span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">npcx =</span> x, <span class="at">npcy =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="marginal-markings" class="section level3">
<h3>Marginal markings</h3>
<p>‘ggplot2’ provides <code>geom_rug()</code>, <code>geom_vline()</code>
and <code>geom_hline()</code>. Rug plots are intended to be used to
represent distributions along the margins of plot.
<code>geom_vline()</code> and <code>geom_hline()</code>are normally used
to separate regions in a plot or to highlight important values along the
<em>x</em> or <em>y</em> axis. When creating plots it is sometimes
useful to put small marks along the axes, just inside the plotting area,
similar to those in a rug plot, but like <code>geom_vline()</code> and
<code>geom_hline()</code> in their purpose.</p>
<p>Three <em>geometries</em> provide such markers:
<code>geom_margin_point()</code>, <code>geom_margin_arrow()</code>, and
<code>geom_margin_grob()</code>. They behave similarly to
<code>geom_vline()</code> and <code>geom_hline()</code> and their
positions are determined also by the <code>xintercept</code> and
<code>yintercept</code> aesthetics.</p>
<p>In the example below we indicate the group medians along the
<em>x</em> axis with filled triangles.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>data.tb <span class="ot">&lt;-</span> mpg <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">hwy =</span> <span class="fu">median</span>(hwy), <span class="at">displ =</span> <span class="fu">median</span>(displ))</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>  <span class="fu">geom_x_margin_point</span>(<span class="at">data =</span> data.tb,</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">xintercept =</span> displ, <span class="at">fill =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="statistics" class="section level2">
<h2>Statistics</h2>
<table>
<caption>Statistics defined in package ‘ggpp’.</caption>
<colgroup>
<col width="25%" />
<col width="26%" />
<col width="19%" />
<col width="16%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th>Statistic</th>
<th>Main use</th>
<th>Usual geometries</th>
<th>Most used with</th>
<th>Compute function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>stat_fmt_tb()</code></td>
<td>formatting and selection</td>
<td><code>geom_table()</code></td>
<td>tables as data labels</td>
<td>group</td>
</tr>
<tr class="even">
<td><code>stat_fmt_tb()</code></td>
<td>formatting and selection</td>
<td><code>geom_table_npc()</code></td>
<td>tables as annotations</td>
<td>group</td>
</tr>
<tr class="odd">
<td><code>stat_dens2d_filter()</code></td>
<td>local 2D density filtering</td>
<td><code>geom_text_s()</code>, <code>geom_label_s()</code>,
<code>geom_text()</code>, <code>geom_label()</code></td>
<td>text as data labels</td>
<td>panel</td>
</tr>
<tr class="even">
<td><code>stat_dens2d_label()</code></td>
<td>local 2D density filtering</td>
<td><code>geom_text_repel()</code>, <code>geom_label_repel()</code></td>
<td>text as data labels</td>
<td>panel</td>
</tr>
<tr class="odd">
<td><code>stat_dens1d_filter()</code></td>
<td>local 1D density filtering</td>
<td><code>geom_text_s()</code>, <code>geom_label_s()</code>,
<code>geom_text()</code>, <code>geom_label()</code></td>
<td>text as data labels</td>
<td>panel</td>
</tr>
<tr class="even">
<td><code>stat_dens1d_label()</code></td>
<td>local 1D density filtering</td>
<td><code>geom_text_repel()</code>, <code>geom_label_repel()</code></td>
<td>text as data labels</td>
<td>panel</td>
</tr>
<tr class="odd">
<td><code>stat_dens2d_filter_g()</code></td>
<td>local 2D density filtering</td>
<td><code>geom_text_s()</code>, <code>geom_label_s()</code>,
<code>geom_text()</code>, <code>geom_label()</code></td>
<td>text as data labels</td>
<td>group</td>
</tr>
<tr class="even">
<td><code>stat_dens2d_label_g()</code></td>
<td>local 2D density filtering</td>
<td><code>geom_text_repel()</code>, <code>geom_label_repel()</code></td>
<td>text as data labels</td>
<td>group</td>
</tr>
<tr class="odd">
<td><code>stat_dens1d_filter_g()</code></td>
<td>local 1D density filtering</td>
<td><code>geom_text_s()</code>, <code>geom_label_s()</code>,
<code>geom_text()</code>, <code>geom_label()</code></td>
<td>text as data labels</td>
<td>group</td>
</tr>
<tr class="even">
<td><code>stat_dens1d_label_g()</code></td>
<td>local 1D density filtering</td>
<td><code>geom_text_repel()</code>, <code>geom_label_repel()</code></td>
<td>data labels</td>
<td>group</td>
</tr>
<tr class="odd">
<td><code>stat_panel_counts()</code></td>
<td>number of observations</td>
<td><code>geom_text()</code>, <code>geom_label()</code></td>
<td>text as annotation</td>
<td>panel</td>
</tr>
<tr class="even">
<td><code>stat_group_counts()</code></td>
<td>number of observations</td>
<td><code>geom_text()</code>, <code>geom_label()</code></td>
<td>text as annotation</td>
<td>panel</td>
</tr>
<tr class="odd">
<td><code>stat_quadrant_counts()</code></td>
<td>number of observations</td>
<td><code>geom_text()</code>, <code>geom_label()</code></td>
<td>text as annotation</td>
<td>panel</td>
</tr>
<tr class="even">
<td><code>stat_apply_panel()</code></td>
<td>cummulative summaries</td>
<td><code>geom_point()</code>, <code>geom_line()</code>, etc.</td>
<td>scatter and line plots</td>
<td>panel</td>
</tr>
<tr class="odd">
<td><code>stat_apply_group()</code></td>
<td>cummulative summaries</td>
<td><code>geom_point()</code>, <code>geom_line()</code>, etc.</td>
<td>scatter and line plots</td>
<td>group</td>
</tr>
<tr class="even">
<td><code>stat_centroid()</code></td>
<td>joint x and y summaries</td>
<td><code>geom_point()</code>, <code>geom_rug()</code>,
<code>geom_margin_arrow()</code>, etc.</td>
<td>data summary</td>
<td>group</td>
</tr>
<tr class="odd">
<td><code>stat_summary_xy()</code></td>
<td>joint x and y summaries</td>
<td><code>geom_point()</code>, <code>geom_rug()</code>,
<code>geom_margin_arrow()</code>, etc.</td>
<td>data summary</td>
<td>group</td>
</tr>
<tr class="even">
<td><code>stat_functions()</code></td>
<td>compute y from x range</td>
<td><code>geom_line()</code>, <code>geom_point()</code>, etc.</td>
<td>draw function curves</td>
<td>group</td>
</tr>
</tbody>
</table>
<div id="stat_centroid" class="section level3">
<h3>stat_centroid()</h3>
<p>It can be useful to mark the centroid of a group of observations with
a point or with a label. By default <code>stat_centroid()</code> applies
function <code>mean_se()</code> to both <code>x</code> and
<code>y</code> by group. If the value mapped to an aesthetics across
rows within each group is unique this value is copied to the returned
<code>data</code>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="at">shape =</span> <span class="st">&quot;cross&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Other functions can be passed to this statistic as long as they
return a single value that can be mapped to the <code>x</code> and
<code>y</code> aesthetics (numeric, time or a factor).</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="at">shape =</span> <span class="st">&quot;cross&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">.fun =</span> median)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The very similar <code>stat_summary_xy()</code> accepts different
functions for <code>x</code> and <code>y</code>.</p>
</div>
<div id="stat_group_counts" class="section level3">
<h3>stat_group_counts()</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>  <span class="fu">stat_panel_counts</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">hstep =</span> <span class="fl">0.09</span>, <span class="at">vstep =</span> <span class="dv">0</span>, <span class="at">label.x =</span> <span class="st">&quot;left&quot;</span>, <span class="at">label.y =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Labels with counts of observations can be also added when aesthetics
<code>x</code> or <code>y</code> are factors, as in ggplots factors
create a grouping. If the labels are to be aligned with the factor
levels, we need to use a “normal” geometry such as
<code>geom_text()</code> instead of the default
<code>geom_text_npc()</code> and set the corresponding label positions
to <code>&quot;factor&quot;</code>.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg,</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), hwy)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>() <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>  <span class="fu">stat_group_counts</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>                    <span class="at">label.y =</span> <span class="dv">10</span>,</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>                    <span class="at">label.x =</span> <span class="st">&quot;factor&quot;</span>) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>  <span class="fu">stat_panel_counts</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="stat_quadrant_counts-and-geom_quadrant_lines" class="section level3">
<h3>stat_quadrant_counts() and geom_quadrant_lines()</h3>
<p>This statistic automates the annotation of plots with number of
observations (counts, fractions, or percents), either by quadrant, by
pairs of quadrants or the four quadrants taken together (whole plotting
area). Its companion geometry, <code>geom_quadrant_lines()</code> is
used in the examples to highlight the quadrants.</p>
<p>We generate some artificial data.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4321</span>)</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a><span class="co"># generate artificial data</span></span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">99</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">abs</span>(x))</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, </span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>                      y, </span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>                      <span class="at">group =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>))</span></code></pre></div>
<p>Using defaults except for color.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>  <span class="fu">stat_quadrant_counts</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">250</span>, <span class="dv">250</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Number in quadrant over total observations.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>  <span class="fu">stat_quadrant_counts</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(fr.label)), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">250</span>, <span class="dv">250</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Decimal fractions.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>  <span class="fu">stat_quadrant_counts</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(dec.label)), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">250</span>, <span class="dv">250</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Percent of observations.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>  <span class="fu">stat_quadrant_counts</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(pc.label)), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">250</span>, <span class="dv">250</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>User-constructed labels.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>  <span class="fu">stat_quadrant_counts</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%i genes&quot;</span>, <span class="fu">after_stat</span>(count))), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">250</span>, <span class="dv">250</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAAAw1BMVEUAAAAAADoAAGYAOpAAZrYzMzM6ADo6AGY6kNtNTU1NTW5NTY5NbqtNjshmAABmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQtpCQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2/7a2///Ijk3I///bkDrb///kq27k////AAD/ADr/AGb/OgD/Ojr/OpD/ZgD/Zrb/kDr/kGb/kNv/tmb/tpD/tv//yI7/25D/2///5Kv//7b//8j//9v//+T///8MX+NiAAAACXBIWXMAAA7DAAAOwwHHb6hkAAATvUlEQVR4nO2dDX/bthGH0e6tap20TZzE27zV3ezW1pwldqPGmSWb3/9TjaRIiqRIEAcChwP4f35raPEFOAIPARzlZCoDQDAqdAAA6FChAwBAhwodAAA6VOgAANChQgcAgA4VOgAAdCjrK/8EgEfmC2p95RJZhw4gNiAoLxCUCATlBYISgaBANBAUiAaCAtFAUCAaCMoLkiQiEJQXCEoEgvICQYlAUF4gKBEICkQDQYFoICgQDQQFooGgvCBJIgJBeYGgRBgE3f7nf/mfT+/X6w/WlSRDqoJW3btZl3x2VzCDoB8LQZ/e5+F/hKGJCtrpXqfd7F3Q7XpdCPql+QMkSLt7N0572bugm7svR4IW0v5+u58Xbovdv++nhepz9sXxNAF80+rep/d31U4n3cwwxX/pT/Hb9af8v9v9rdx/yAPN99+3Ppd3C0MjotW9zQDqppu5BM3Db5KkTfH45JGW2+36cxlkflbz+dY6GBCKpns/1gOom27mEnS7vssfnX1I98Wd5OHd71O+T/X8UH8ubvZOX2a0JJokHbp32wyJbrqZS9DysanG0ibyD60TisgP2d92v0pJj0QFPXTvpuk3N90cQtDy5/yPerVSR95J/7ZprkGTF/Sgn5tu5pzij5OkD+Wauo68/tyWOTUSFfTQvc0S1FE3syVJ+WjefJNUvH/4rXr/kB9s3lFUn8vvI9L0M1nq7n16/6m9b343B/sufoNvlZbA7G4OIeimfIpSzdNBhZtuDjKCFi8a4GfyOOlm/LodL4kmSf6AoLxAUCIQlBcISgSC8gJBiUBQIBoICkQDQYFoICgQDQTlBUkSEQjKCwQlYijo4w+r1VmW7d6sTm6aTbcEYAIEJWIm6O7tRfb448Xz+Vl2/SKrNr0SgAkQlIiZoA+Fjpdnu3dX2eOrq2rTKwEAD5ivQfNR9PH1TWuTVf9Hsh6jA4vHWNDn89Ps4aQ0s9r0SgCpopQKV7mpoLs3p3mq1B9B2yWARFEqpKHGWXyew2dYg84mwiQpBkH3fpbTfJnFnyKLtwSCEjET9HpVcIb3oLOJUFDbNagbrfFNEi8xCmqHo4EXggI/QFAgGlNBJ86CoMATxn5qz4OgICgQVBbLSZIKDAZRCCqLRQlqtAzFGlQUEJQIBOUFghKBoMAfDt6EQlAgGggKAmA+tEJQwA9hcQpBeVlUkjQKBBULBC2AoGJZrKBdI7EGlcpSBbV+JQpBAQcQFPBg//c/ICjwj7Votl8qQVBAgf2veEJQXmJPkiBo4sQuKPu/gwNBeYleUG4gKC+LE3TuiAtBgU9mr1khKPAJBAWigaBANliDxkWcSVLAf38RgvISpaAh/4VQCMqLHEEJzkHQ5SBGUIp0EBSwQ5IOa1DAzbigAW0cAIIuFY2fkgyFoKBLAEF1FUJQXsQkSaPwC6qtEYLyIl9Q/jUoBBVEBIJyUpoJQQUBQdtUamINCmRisN6FoCAcEBS0EPV+c890SBB0MXh9f+StaAjKS8Akyaeg/sqGoLxAUCIQlJeQr5n8zvAQNAn8ChouDcIaFEwj7BeRnABBE2LRgj6+usqy3ZvVyU2z6ZYAgiNIUGeBmAr6sPruKns+P8uuX9SbXgkgPJL8dBSKoaCX3/6Uj6C7d1fFSFpteiUAExbyyyLsgu6n+MfXN9nu7UW1Ka4ucBLHUoCgREiCPpyUZlabXgnAhIUIyr8GHR5B2yUAE+ISVMCaliQo1qDLQsJbAZKgz+en+yz+FFn8EohOULwHXRZUQX3ojG+SwDiTxnVO8DLgQlBeeJMk3zN0V0kImgCsgnpfQ0LQ5EhZUKxBEyCEoF1vnFrkP8uHoClT++l7HvYIBE2eCUEd+OpTeQiaPHpBaSPq4LleB2UImj7aNahSBL+GTzUtwEpjCMqLuF8WURRDZwlqN9BCUF6ECNpSZb6ghkMjBI0BGYLaJfaUxcBkpaZAUF4kCup1BOwWQKiuAoIuESvXXCXrtHIg6CKxUQ2CAqc4fznpqEAICgrmDHgeX7xTS4egvPAlSTMEdTWZu4BRUDk3HRCPgvba18CysROWKaikuw6HP0GP2tfEz+FTJHUVBOWFUdAZVwjqKQgaK/3WdCmoU+ZVgjVobFTNeGwXvX25/JxTzdKy+Oifkrq/Sf3OfNed6pIQlK0B419n2Ag6I6G3oVtdr3JqRSIE5dMmuKCzk6TmDmgD6MTJTttFpyS5IgjKy/ws3uIG7AS1bilddRB0uiqeikYI8+t2JjN8/5QZnaK5ME5Bg2vDhyNBnTfY4ADqo1eiXIMCGopjyjFaF3iOIYOgMaL0grryhjWxGgWCSmbYgCFBD58n9HUHBF08IwoM+1nvUfaG0q6CoClCSpLGFNBmNPaCUi/DGtQXAV8aOBFUf2ZX0G4J2vIGqwvYViVLFJRpjTYI7TWTeZxjHnbvdSq50g7N1rHNAoLywv2i3lzQ4YWBdhk8VpRLIKgYvARFFJSyF4J6Q6qf/r+5mZrhp65vnwtBnSNSzJqp9SFHAIRTuWahAIIG00To1F7SdLlmxNJd6S+ysUqZauIXNJwmEgQdSZLafo6v+TRXDh5LAQjKi07Qzg/Hh6MQ1HkkyQhqUqiAfrQTVDOPyxKUEIrhiamsQQV1kpa+oHXUTfRjtyFrDTqGeSymYaeSxQfspTkVzw5bjpslVEGnzw0uqKMW3t9tiO6a5dhcQSWNniXD4QzsjUVQZy1c+cnfXZEIGlLkwShTFlSzTotMUG03GZRrXDk1SqcNOVJ5FGtQm+4dvSbMhEeq8ziLn3c3hAGUEqbblmxKsyg0tKA2MY+3nrAFWUEvpPXR7qG7UePv7O3DCCdofbc2pQYX1IIwA+UkY9NYZ/e62VnndO0zOh05fZuUZiDP8B6a2JWg25df/V170e7N6uSmXwIjhrepO21/zMs8dry3Vde63qOaI8eDae9Aq9xOFT4fVC8luxtBf1bqD7+OXvN8fpZdv+iXIA5dc5iOUbOrazxs/dkTtGPi4ZyhgkcPRIJFvGNT/PalUt+MXLN7d5U9vrrqlSAOx4JOnTpSWEfQAdpX9sU9KliGoKy1jq9Bn/6q1Nf/Hrrm8fVNtnt7UVxdsF6XC6u1tG3Vf4PHy2P7MwzLa2zQ1aeJo+9l4+G6OqE4v/XUlJH176MOuCp//P5CtauuHey2Y4L+otQf86l+cKJ/OKkFzTLBI6j2SW/GLkJhupOHDtb7WuNka3Q8XDE0Lrb3tY6GGTK7TLeEyyAHBS0Gz++LHzaDQ+hhBG2XED0TPmvbfeho/5rxMrp76wHU+tXhQJmmhwxLDizo9uXw1F4TyRq0YO4QebBEc3Tk4vZ4WUtn/Lc66yttu1tz3WyD9JdzjKATPJ+fSsjiDdqB0lijjo2W09rbPqH+qSXo4bDxXztuPxqm1wzHRjjkZA3h1E+7F/Wh34OWmHSdD0GHh82hvbME1UQ18zpdkY6HPwfE+E3SHteCDj35zfWDVk6Oq7PHwW5UpDLsRsmFCurlpgfkOa5xbs3jg6qm5oFedtECHPIsU1BPd60ZnTy2c8+/fj2qhY+aHZc5VInvKmhELKimdG819u07qqgtqOMI5I1uHEBQel1zBJ3zj4cF9TNU5fGuQbWl+xxAtYLua/YjaEiCDd8RZvEBB5Kqm1oRjAYzcgCCEolPUKamGh4DJ6qejgyCEvEvqOsb42kqqzwn5TQm2TWo806DoIsiPkE5nmVtIj5xmZeAlotkQYP1tqWfAl9zx4/gNaid2i4c8TgSxpokBUNwFm+liRO3IKgcIOhIKYTdFCAoEcGCWvkwImhrRdk9rurf1zSosV22rasQlIhkQa3Q+Fm72Dpj/2n42HApRz/KQmhY9kgU1H0jL0bQgHF5qligoB4aWS/oyLH2Sb0fIChbzcsQNFOHQruFt/3UrQ8GdjoO0QkQdLwEZ1jcqu6CqcImq3Pa9L6TJGKo7u5sQYLSW22ocVqDor7peocHS4pHUBoub83T0C1R0CEojnV2dabw6aJ1rrsgXUE9EYmg+pacJyihIs1VhmdCUCJJCKqdlxkEjaCfR5AfdxqCDl8x+DPlOsI14js6ViIR1P+jPqcCCOqPgIKK6tS2Y/TARN1KWoQT1Hc6Qi6X5WtMWUlSBEQmqDd5IKhQIOihZO91ZBCUTGRrUJZ0pFvFaIVWkUBQIrFk8TXs6cjoI4HUnYXYBNXhRRgIGpYoBDUzwY8xEDQsMQhqqIInY9yuQQERCMoLkiQi3IK6Tt3bRyLwE4JSYRZ03DWdXVo/I7CyBQQlIkXQ3gGV0rTeBoISkSmoUoaGRicoICJlDWopaBTrTjADMVn8wAyf74F/S0eMoF0OfsLQZSNU0Ir0BEWSRASC8gJBicgWNL01KAQlIlzQzKOjQeSHoETEC+ptlk9v+ZAkoQQ1lgOCLptAgprbAUGF47kVjQV9fHWVZbs3q5ObZtMtgQTBjuETHTQL/HSB7+fcVNCH1XdX2fP5WXb9ot70SiAx97a010s2L7kkSYigl9/+lI+gu3dXxUhabXol0Jh5V7pmET13Q1AipCn+8fVNtnt7UW2Kqws8RjcKBBWDpDXow0lpZrXplcCLfoaHoMkwLejlalWsNwdH0HYJchDsJ6BCGkFnrEEhDbCCJOjz+ek+iz+lZvGip10gGKb3oBAU2MH0TZInQeOzHkkSEa6vOn35GZuhEJSI+N9m0gFB0weC8gJBiXgW1LNA0fkJqPgVtDfEwSdAhVPQCGdkEBoICkTDuQaFoEiSyLBm8fATglKJ+jVThEBQIvEImsbwC0GJRCMoFrDLBIIC0UBQIJpoBE1kDQqIiBM0cQ+RJBHxKqiFbKnP5BCUiE9BbWSDoKADBOUFghKRJmjqa1BARNoaFIAO4rJ4ANpAUCAaCMoLkiQiYQRd7uIUghIJImjq75I0QFAiEJQXCEoEggLRYA0KRIMsHogGggLRRCVoAisDJElEYhI0hdwKghKBoLxAUCIQlBcISiQmQVNYgwIiUQkKlgcEBaKBoEA0kgRdwhITSRIRQYKmkKRPAkGJQFBeICgRCMoLBCUiSNBFrEEBEUmCAnCEAEExcIJxwgu6iKUnsAWC8oIkiQgE5QWCEgkv6LLWoBCUSFhBF+VmCQQlYijo4w+r1VmW7d6sTm6aTbcEC5Y1uwMbzATdvb3IHn+8eD4/y65fZNWmV4IFEBRMYSboQ6Hj5dnu3VX2+Oqq2vRKsACCginM16D5KPr4+qa1Ka4umFE7/AQTGAv6fH6aPZyUZlabXgnABCRJRKYFvVytXhR50WmeKvVH0HYJwAQISsQ4i89z+Mz1GvSY5Od8CErETNC9n+U0X2bxp26y+CPSz5ogKBEzQa9XBWeu34Mekb6ggIiArzpbQFDQQ5ag6a9BARFhggLQBYLygiSJCATlBYISgaC8QFAiEJQXCEoEggLRQFAgGggKRANBgWggKC9Ikoh4F/Tp/Xr9ofxp+5//WVeSDOkK2nTvF6f97FvQp/e5nR9LQz9C0JQFrbv36X1UgpaPU/HHdr2GoOkKeuje+//GKejm7jD0F3fz++1++r8tDv++Xq8/N5+zL+v9ZxANTfd+uW362Uk3M07xrcA/5f/d5sfu8gfuQx5ofvy+9bmUGobGxb57n95/rvvZTTf7z+I/1klSI+imeHzySMvtdv25DDI/2ny+tQ4GBGPfvfd3TT+76Wbfgm7Xd/kjU4bSCHpfCJuHd78u+VQvA+rPhdN31vGAMOx78fbQz2662beg5eOyD/lY0P3I2qxT689ZuXxJcxhNNUmqerGSr5y23XRzCEHLffkfm2pHHfmmnf5t01yDJi5o+wc33cwxxY8nSfn+PNw68vpzS+rkWJCgbrrZe5KUj+L9JKl8//Bb9f4h39m8iqo+Z5t1si9NFySom24O9l385sP0OSB6ZndzCEE35VOEPD1x3HRzkBG0yPXgZ/I46Wb8uh0QDQTlJd0kyRMQlBcISgSC8gJBiUBQXiAoEQgKRANBgWggKBANBAWigaC8IEkiAkF5gaBEICgvEJQIBOUFghJxICgAHpkt6Li57ou0RU4ociKJLBQVpFYu5IQiJ5LIQlFBauVCTihyIoksFOU9CABmoEIHAIAOFToAAHSo0AEAoEOFDgAAHcplYY+vrrJs92Z1ctNswnG9Wq2+uwofRyagLSrENAlBFOWw2ofi7p/Pz7LrF/UmIJdnxZ/h45ARQ4mUJqGIotxVe/ntT/mDsXt3VTwg1cZd6VSe/3FRbILHISSGAilNQhJFuay5qOjx9U22e3tRbVyWTiOfOVarsyx4HDkSYiiQ0yQEUZTreh9OygqrjcvSibH8eFEMGcHjyJEQQ4GcJiGIopxUeLlavcjkjKBVOMWiS8BwIWHIOiCiSUKOoFLWoCWXZxLikBBDg4gmIYiiXNf7fH66T85Ow6aKxdTx/M+r4HFkWfi2qJDTJARRlOt6Jb0H/fZCQByZjBgKxDRJoPegADhHhQ4AAB0qdAAA6FChAwBAhwodAAA6VOgAANChQgcAgA4VOgAAdKjQAQCgQ4UOYBH88tXfs+3Lb0KHESMqdADL4Oc/Fv8DdFToAJbBlz//7S//Dh1ElKjQASyEX9T3oUOIExU6gIXws8IMb4UKHcAy2Hz9r5cYQm1QoQNYBNvczs3XWIRaoEIHsAh+/sOv2dNfMclboEIHAIAOFToAAHSo0AEAoEOFDgAAHSp0AADoUKEDAECHCh0AADpU6AAA0KFCBwCADhU6AAB0/B8uh3A9ngYqJAAAAABJRU5ErkJggg==" style="display: block; margin: auto;" />
Pooling quadrants along the <em>x</em>-axis.
(<code>pool.along = &quot;y&quot;</code> pools along <em>y</em>.)</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pool.along =</span> <span class="st">&quot;x&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>  <span class="fu">stat_quadrant_counts</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pool.along =</span> <span class="st">&quot;x&quot;</span>) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Manual positioning of the text annotations and pooling of all four
quadrants, and overriding the default formatting for the label.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>  <span class="fu">stat_quadrant_counts</span>(<span class="at">quadrants =</span> <span class="dv">0</span><span class="dt">L</span>, <span class="at">label.x =</span> <span class="st">&quot;left&quot;</span>, </span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%i observations&quot;</span>, <span class="fu">after_stat</span>(count))))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Annotation of only specific quadrants.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>  <span class="fu">stat_quadrant_counts</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">quadrants =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.12</span>)) <span class="sc">+</span> <span class="co"># add space</span></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>  <span class="fu">stat_quadrant_counts</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">quadrants =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Using facets, even with free scale limits, the labels are placed
consistently. This achieved by the default use of
<code>geom_text_npc()</code> or as shown below by use of
`geom_label_npc(). We expand the <em>y</em> limits to ensure that no
observations are occluded by the labels.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(x, y, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>() <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>  <span class="fu">stat_quadrant_counts</span>(<span class="at">geom =</span> <span class="st">&quot;label_npc&quot;</span>) <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">260</span>, <span class="dv">260</span>)) <span class="sc">+</span></span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>group)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="stat_apply_group" class="section level3">
<h3>stat_apply_group</h3>
<p>This statistic applies functions to <code>x</code> and <code>y</code>
data. The function(s) supplied as argument are expected to return a
numeric vector. Both functions should return vectors of the same length.
When possible it is usually better to apply functions through mappings
using <code>aes()</code> when they are independent of grouping, or to
use a transformation for the scale. However, when grouping is important,
these statistics make it possible to avoid pre-computation of the data
for a layer.</p>
<p>Here we plot the difference in trunk circumference between dates for
each tree. (As the vector returned by <code>diff()</code> is one element
shorter than its input, we delete the first value of <code>x</code> in
<code>.fun.x</code>.).</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">ggplot</span>(Orange, <span class="fu">aes</span>(age, circumference, <span class="at">colour =</span> Tree)) <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>  <span class="fu">stat_apply_group</span>(<span class="at">.fun.x =</span> <span class="cf">function</span>(x) {x[<span class="sc">-</span><span class="dv">1</span><span class="dt">L</span>]},</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>                   <span class="at">.fun.y =</span> diff)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAAAw1BMVEUAAAAAADoAAGYAOpAAZrYhkIwzMzM6AAA6ADo6AGY6kNs7UotEAVRNTU1NTW5NTY5NbqtNjshdyGNmAABmADpmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQkGaQtpCQ27aQ2/+rbk2rbm6rjk2ryKur5OSr5P+2ZgC2///Ijk3I///bkDrb/7bb///kq27k///95yX/tmb/yI7/25D/29v/5Kv//7b//8j//9v//+T////dSKKSAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAWdElEQVR4nO2dC3vUxhWGBck2DbYTYppLgdCattALAdOYBWoM+v+/qju6rS6j0VzPOTP7vU8eY+9qpDMzb84ZaXe1VQ2AYCruAAAwUXEHAICJijsAAExU3AEAYKLiDgAAExV3AACYqNw2/wMANHgK6rY5AJ5AUCAaCApEA0GBaCAoEA0EBaKBoEA0EBSIBoIC0UBQIBoICkQDQYFoICgQDQQFooGgqdgf4I6hACBofPb7Tk4IGg4Ejch+ULN/gC+WUoCgUZib2T/MEEphQNAwFklz9jRlLEUCQX0xm9lvRBJKyUBQd6zU7LdNG0r5QFAHNuq5tkmqWE4FCGqFu5lDy9ihnBgQ1IxH0pztIF4sJwkEXSPUzGE/4bs4ZSDoguCkOdtdrB2dJhB0RFwzh73G3uFJAUEVkZPmbOdpdnsinLqgKc0cjpF292VzuoJSqNkdieIgpXKCgiat5/ojEh6rNE5KUHIz++PSH7IYTkNQ+qQ5Oz7bkbOndEGZzeyj4A4gX4oVlDtpTpESR34UKKgoMzuEhZMRJQkqK2lOkRlVBpQhqGAzO0QHJ5ncBZWvZkcOMUokW0El13Md+UQqiwwFzczMnvwiFkFmgmapZkuucTOTl6BZT3LWwbORlaB5T3He0XORk6C5z3Du8bMAQenIPX4WMhI0//nNvwf05CNoAbNbQBfIyUbQIia3iE7QkougZUxtGb0gJRNBS5nZUvpBBwQlpZR+0JGHoOXMazk9ISILQQua1YK6QkMOghY1qUV1hoAMBC1rSsvqTXrkC1rajJbWn8RAUGpK609ixAta3nyW16OUSBe0wNkssEsJES5okZNZZKdSIVvQMqeyzF4lQrSgpc5kqf1KAQRloNR+pUCyoOXOY7k9i45gQQuexYK7Fhu5ghY9iUV3LipiBS17CsvuXUykClr6DJbev2hA0DRcNqw/n3v/yBAqaJ7zd3mke2B92zx7SI9MQXOavYWV4+fWm+XURU5ECip/8kxWTrZbf0p+J0UgUVCxU2dp5aTJ6jNieykLgYIKmznbZLlkt6sNhgrrplQgqBZ/KweUnjuk0FDkCco3bxGs7Nk12dNsKAS1QZyg1NMW0cqe3s66ERSGBiFNUJpJS2DlwNHO5q963VAIaoEwQVPOWUore3ZTPWsU+VBkCRp/xiis7Fna2TyKFBpCmYISWjmgtbNGkQ9ElKBh80WZLOfok2f3HAQNQJKgPtPFaWWPyc7meRjqjyBB7SdLgpUDG3Y2m6waCkG3kCOozVyJsbJnK3n2m8FQX8QIuj1TosxssLOzhqABZCOoQDtt9axhqD9SBDXPk7jk6WRn02DNUAhqRoigpmkSZ6d9aR+3gaFeyBB0fZIk2umhJwT1RYSga3NUjJ1NUxjqgwRBV2ZInJ1epX3UesVQCGrCStAvL6/q+u7pxcN382ZR0M1QUcmz3wMMdcdK0JuLq0bSmx/mzWKwnJ8S7Wz2AkGdsRH09s9/uarvnl3Xt79cz5pFYD498uwMLO2j/SCFOmMh6Jd//ueQPW8fv6vvfn2lmiiiBTCdHJF2RtKzXjUUgq5jIejNE1XePzzsBR03C2YyN/LsjJY8+90hhTqyLeghdX6ZZNBxs1BGM1N48ux3iRTqxragNxeKJ0nWoMPEnIadNYq8M9aXmb68fBL/LL6dF4F2xi7tox1rDYWga7BeB1XTItPOVHrWKPKOcL6StBd6WpTQzuYASKEOMAq6l5k8CY4BQ+1hE/RyL9FOAj1XlqEQVA+PoIfcKW5CiOxsDoUUag2HoE1lFzYfdHY2R0MKtYVc0G7hKWo6CJNnf0QYagmtoMNpkaTJILezhqD2EAo6OmmXMxf0ybM7Lgy1g0rQySUlKTPBZWdz7KWhUoZFFDSCTi94CpkIRjubw8NQGwgEXVyPlzAPnMmzDwGCWpBaUM2rRfzTIMDOGinUjqSCal/LZJ8EEXYqloayj4080gm68ko78xzISJ4dMHSbVIKuvQ+EdQZE2alYLEMh6Jwkgq6/TYlzAqTZWSOFWpBAUNOb6NjGX1zybFkYCkFn6AV9W1U/vv3q9+1mjnANv0w7FSjyG2gF/e2r/z768fPzr7ebucEz+EKTZ8fcUAg6RSfop0c/Hv6r399/vdnMCY6xl22nAoYaIRSUYeTF21kvl6EQdIK2xL9VJf7TowfbzRwgH3j5ybMFKdSE/iTpfXXA4Kd8QXOxU7FDCl2H7P2gpMOekZ0KGLoOlaCEg55T8myZLUMh6AitoJ+fP6iNV5mcBSUb8/zsVCCFrqK/DqrcjHkdlGrEs7RTsUMKXWHlMpP6J95lJpoBzzN5dsDQFYoRNGc7FRNDIeiA/jqoUjPeddD0w5118mxBCtVDcB009WAXYKcCKVRL+stMice6DDsVO4EfzOYnuaBJh7qQ5NmBFKpBK+jHb1SJr2KcJCUcaPF2np+7bY8UqkEnqPka/aTZJskGWrid5+dKTxgajOEyk02zLRINs/DkeT7kTn9DIWiLPoPGEjTJKMu28/x8XNkdBa2RQudo16CmS/TTZmZSjLF0O+ePOO4BKXSGvsRXUU6SEgyxYD3Pl3Y2D7vtRU6RFzLSCS8zpfAz/i6jsCJn+5zbro6G8gq6EzLYOQkqNH0a5Gyfd9udjBS6k5IN0n0uPr6fsXcYAVPqPG7ktk8JKXQ3/OAm2efiT8BPGzmb7dx2K6XIyxjyVB87jj220sq7VeocNnbbN7+gu8k/rCQSNLqfkfcXhoucbQO3zbkN3fVBCBj2NJ+LL9hPp9R5bOW2eW8o072C2hBkGJrm/aCRB5Z/mDq85Gxbum3OaWifPyULat1MT9xhFbL89EudQ2u3zRkFHeq7DENTvBYf2c+oe/MjTM52F26bsxl69FOGoYnfzRQO9wCF1PXpbtw2Z/rOyONw7+UKWhuv0U+aJYd5fCKkzuO+3DZn/FbT9tuoZRia8s0i4fAuPyPK2e7PaevLtu/E91xrjtwdd9/+xmsox/fFW8M4NDFT53GnTlszpNCJnzJSqGRB2UYmhZzNft02bw2lvO3acNR9f2h2Q2m/RMEFpvKeJHUOO3famrrIz/0UUeRJv0TBhcmgnK0T9aAp5WwP4LR1ayjZndeaQ9aTQ+7ZUyjllyjYorzb2VpocNfN4aSp83gUp60pi7zOTwFFnl1QvVBRR2RbYRo5GzwMJRFU66eAIk/3JQoNdumNdvl5kDNaGrY4mtPWZEV+NOLTo3EX+aQ3D/OcZsLRsE+d0Rz2MJRqFapdUex5U2iCy0yhWYdsLGLXdUtlJRq6UuDbB1gNXQjaLUAtm8WHqLzTrDqjGFoT3MGyP5DuULxFXpqgJONAd0oUwVCCFGr0kzmFLkv826qH4TJT+lEgPGFXRDI07U0sm6O0v2sPxGmorLfbpR4DWjkbtIa6L0NT3sayOUb7+8ph9nxFXtJr8WmXn8SpcyDc0LSCWvjJmUJT38DWgZT9Z5JzHTGG2vjJaWjqG9jak6z3XKmzJ84ylOJaqOEY7VMMhopZg6bpO7ecDZINtUug/ZNCBI13A1trkiw/JcjZEGEZWu/S3Ay43XnDxgGYDE16A1tr4vdbROociHKilOp2lpYfIGUq8iJOkmL3WpScDTEMjS+oi59cKVRf4k3vE5k0i0Hc8i4rdQ5INNTNTyZD+U+SYvZYppwNwYZeJrmhkMsNIi45DGU/SYrWX6Gpc0BnKGcKnfhpJ39jqABB64/fkp0kRequcDkbwg2Nvgp1vc8jQwrlvXFDlOWn9NQ5IMrQycjb7pehyLO+Fh/e02zkbAg19HIfzQ3nBWgfQX1CgoZ2NCs5G8QY6rEAbQOoqQ3lK/Fh5T2v1GnEpR+RBPX1k6HIr2fQT396sd3Mn5A+5iunjBTq7yd9kTeU+PeGe98EC+rdxcxTZ6ih+whyhPhJXuRNgiYs8X4dzFzOBn5Dp36uCroWFLGhBkF/S5ZB3Zef5+clyNkQaOj+MtANaz+NhrIK2p0k3Uu1BnXrXDlqdoQaGkEOu/y5EhRtCmW4zGTfteLcbNEY6pRCg+SYtl1dgJ4PP5aQGkovqFXHCirpGhgNdVqArgpKWOS1gqr325k/mOQt6Pbys2g1O4IMVXf68LXD8QRJgKH6G9gqN5PcwNbYqbLT5oQwQ70FdT6B5y/yhveDJrjMtNql01GzI8RQ7xQ689PmCpM+KMIUSimotryfUNqcEGBoc9tjDzs8/OQ3VH8DW6Vm9BvYLrpzomqu4pRC3e3w8pPd0KQ3sJ0w6Qzc5EihPn6uCxrliuwmZJeZ+r6caklfQmyo2nzk55qgQwhni0cmUKVQos8kNctPqDnF31All6Oh8423EujZhqHdfXWTG0rzqc4d3NQRZKjbMtR1AXpWb+VQoiKf/NuOlZlct48Wz9JQpxRqr4fzCdLZ8GM1KhpDU76jvkubvF9ZLJtAQ21Hdu6n7QLUaChNkU9zkjQ+E4KeJnwNbQyzNdTXTytD8xN0utqEn2ZCDLUs8rZ+Thags1/Zirz+Wz7ifWgOfm7haWiXQm0H2MXPSUgmQ7svakw6xxYZ9Pani4urur57evHw3bzZBlh+WhBm6PYIzy+A2hf4yV/rhjILevfrq/r251dfXl7VNz/Mm5mBnlYsDI2aQgP93DY0bQrdfj/oB2Xlm6u7Z9f17S/Xs2ZG4KclKQ1dPOuwAJ09ookqfZG3ez/oIYvePn7XJNNDE4XFruGnPzaGtqZtGBpygjSwaSixoIu32315+aT+8LAXdNxsHSw/HfBbhloYuvDTucBPHlxG1X2BYrrJthH07umTw6nSYydBoacTXoZuCxrJz+HhtRSa0FCL94Pe/nQ4h6/d1qDw0xGvZeiWodH83DSUWNDJ+0FbP5syb3sWj/Lujo+hnW5rhlr7aVyATp8iL/Lbl5luLhRXDtdBoacPCQytZ35uJVCDn2yGJnipE3764WGoUdDFBVD/At8+e7YS1fo3zUdA0rcdnzpxDY3t57DBIqqkKRSCCsLd0N65paEaXfSC2vvZbUJb5CGoJOaOWKfQhaHLE6SgBWiP3lC7L/v0A4KKwtnQkaBjQ939tBOU3lAIKosQQ4+CJvOT3lAIKgxXQwcnRoZq/IywAB1vOY8Kgp4utobOiryVn24L0PG2ZIZCUGmEpNDW0OUFpph+EhsKQcURWuTd/XQUtNl8RdDohkJQeTgaelSiMVTjZ7wF6KgBUQqFoALxNXS2DF1uoN+rs59aQxOlUAgqETdDJyl09M/yee1OPfwkNBSCiiTIUAI/TYbuohoKQWUy08ZWUCVJ6gXoqN00rP7AUQ2FoELxNPSSyk+ToRD0FHAxdJpC157S7c3fz6Zt+iIPQcXiaajVE4EL0GPr5EUegsrFwVBHQaMk0JrEUAiaDT4pNK2fS0Mh6EkRnEJT+0lgKASVTKihZkEj+JneUAgqGntDdT4Q+Kl2oxc00sUmCCqbEEPTF/huPykNhaDCsTZ0oQORn+uGQtCTYCqSQwrV+pHAz7mhcVMoBBWPraF745+z5jH9TGooBJWPl6GUfqY0FIJmgKWh+5XfNU1jCzo19ChouKEQNAfcDaVbgPa7TJRCIWgWTIyyEJTcz6mhw1uqwg2FoHngZijtArTfbZIiD0FzZM3Q/eSftUaJBE1jKATNBLtl6H70c0ZyPyeGRivyEDQXrAzdDz/mEPipNTQ0hULQbLBahu6ZFqD93o+7j2QoBM0HG0P3rH4ejjMcYFTkQwyFoBlhZShfgW+PtDBU3evE31AImhMWhjL7OTI0TgqFoFlhdzl0DqWfsQ2FoHnhZSjVArQ/3NzQkCIPQTNjLJmloMR+Hg0dp1BfQyFobjgbSlvg2yNqDIWgp4KjofR+agz1T6EQNG82DeXw82hoeJGHoPnhdKJEvgDtDxvJUAiaIQ5FnieB1oOhE0F9DIWgOWJtKJufekMh6KlgaSijn7EMhaB5Ymco0wJ0OLg6bmCRh6CZYmMoq5+RDIWgubJtKGuB7wJYGApBT4aRdlpB2f3sDQ1KoRA0X8yGCvAzhqEQNGOMhjIvQI9RhBkKQXPGYKgMP5swzmaCOhkKQbNm1VARBV6hMxSCniLn2j+4/ewMPX69mKuhEDRv9ClUkJ9zQ12LPATNHK2hQhagHUGGQtDc0RgqKoHWbTyzIm9tKATNnoWh0vzUGgpBT4eZofL8bEPyK/IQtACOJo4FleNnl0KHgFwMhaAlMDZUop8BhkLQIpjm0NlDIjhXNb6PCYKeHAsdhfnpbSgELYQz458S8DMUgpbC2eofUjhXJ/JdZK2gFoZC0GI40/4qiCaFuhoKQUtEpqC9oW10lkUegpbD2eIXaZy3V+ub+CxTKAQtiLPJPxJxNxSClsTZ8EMq5+0LnvaGQtCiOKuFCzo2FIKeIGfC/eyLvLWhELQwhPs5pNCxoSYgKCBmZCgEBQJxMhSCAnL6ty7bGApBAT1HQyEokIi9oRAUMDB8PmnTUAgKODgaCkGBQC6PH00xGwpBAQu2hkJQwMPRUAgKBHJp91W4EBQwYWcoBAVcXEJQIBmrFApBARs2hkJQwMalxffdQ1DAh4WhEBQwsm0oBAWMQFAgm01DIShgZctQCApYudx4HoICXjYMhaCAl2iC3j29ePhu3gyAUMyGWgv65eVVffPDvBkAwRgNtRb07tl1ffvL9awZAMHEEfT28bv67tdXqokiQlwAbGMt6IeHvaDjZgCkxSODjpsBkBasQYFoHM7in+AsHpCD66BANHglCYgGggLRQFAgGggKRANBgWggKBANBAWigaBANBAUiMZXUABo8BM0b4rK/yV1xtCXiiwIAZQ0p0V1BoK2lDSnRXUGgoJcqbgDAMBExR0AACYq7gAAMFFxBwCAiYo7gPTc/nTx/fXw0ZXJJ1iyo/n44qFDF1f5d6jpy5eXF9+9MvWlYomNEvWZ6ZuH77pb+Ezv5JMbH9T/aqpDtz+/yr1DTV/qN1fqzguGvlQswVHSfLD/2XX38enpp6gz4813/z6E/kFN4ZurzDvU9kVFXw+fbdf1peIIjpQug3Y3oJjehyI7+uk79iTfDqm+3D7+lyrxhr5UPMFR0i5sulv4TO/kkx2doOpmBdl3qBH0pytlp6EvFU9whByWa/WH76+zTzgNraB3T5/UpqyTB20GfbdRDSqe4Ajp/rfMfMnW0Z3FH87hTeu2PFBR3/11a3IqnuAI6TJodwuf6Z18sqMvi/VwT6J8O9So+KYp8Ya+VCyxkfLhYuNSW0aoSb25UFxl36FG0EP05ovUFUtsAFhScQcAgImKOwAATFTcAQBgouIOAAATFXcAAJiouAMAwETFHQAAJiruAAAwUXEHUCofv6mq6kFdf3pU3fv7t6/rz8+r6v5r7qjyo+IOoFA+Pfqxrt/ef/3p0YPD7/dff37+9eHvr37njis7Ku4ACuV/SsWPf3zxXmXNg6jNv421wImKO4BieX8o8fdeNEnz47ev31YND7ijyo6KO4BC+fTo3guVQQdBUd39qLgDKJT3Ssj399oSf/hx+JU7pDypuAMoFCXkx2/uvTieJB2MhaXuVNwBlMpvhxXoPw4nReoy09/ut5eZ4Kc7FXcAp8B7LEC9qbgDKBxV1ZtroMCPijuA0lHXl+CnPxV3AACYqLgDAMBExR0AACYq7gAAMFFxBwCAiYo7AABMVNwBAGDi/4QmqsdZ2/E9AAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
</div>
<div id="stat_dens2d_labels-and-stat_dens2d_filter" class="section level3">
<h3>stat_dens2d_labels() and stat_dens2d_filter()</h3>
<p>These stats had their origin in an enhancement suggestion for
‘ggrepel’ from Hadley Wickham and discussion with Kamil Slowikowski
(ggrepel’s author) and others. In fact the code is based on code Kamil
gave during the discussion, but simplified and taking a few additional
ideas from <code>ggplot::stat_dens2d</code>.</p>
<hr />
<p><strong>Warning!</strong> Which observations are selected by the
algorithm used, based on <code>MASS:kde2d</code>, depends strongly on
the values of parameters <code>h</code> and <code>n</code>. You may need
to alter the defaults by passing explicit arguments to these stats.
Beware, though, that what are good values, may depend on individual data
sets even if they include the same number of observations.</p>
<p>If we want to highlight the outermost observations at the edges of a
empirical density distribution, values of <code>n</code> similar to
those in the examples in the documentation of <code>MASS::kde2d</code>
and <code>ggplot2::stat_dens2d</code> are suitable.</p>
<p>In contrast, if the aim is to prevent overlaps among labels, by
preventing observation labeling in regions with <em>local</em> high
density we need to fit a much more flexible surface based on a very
dense grid of estimates. In this case, for the selection of observations
to work cleanly, much larger values of <code>n</code> than in the
examples in the documentation of <code>MASS::kde2d</code> and
<code>ggplot2::stat_dens2d</code> are needed in most cases.</p>
<p>Functions <code>stat_dens2d_labels()</code> and
<code>stat_dens2d_filter()</code> will return the density estimates if
<code>return.density = TRUE</code> is passed when called. These density
estimates can be plotted to visualize the density function being used to
filter or reset the labels.</p>
<hr />
<p>Some random data with random labels.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>random_string <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">len =</span> <span class="dv">3</span>) {</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">sample</span>(letters, len, <span class="at">replace =</span> <span class="cn">TRUE</span>), <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>}</span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a><span class="co"># Make random data.</span></span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1001</span>)</span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a>d <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">50</span>)),</span>
<span id="cb57-11"><a href="#cb57-11" tabindex="-1"></a>  <span class="at">lab =</span> <span class="fu">replicate</span>(<span class="dv">100</span>, { <span class="fu">random_string</span>() })</span>
<span id="cb57-12"><a href="#cb57-12" tabindex="-1"></a>)</span></code></pre></div>
<p>The stat <code>stat_dens2d_filter</code> <em>filters</em>
observations, in other words passes to the geom a subset of the data
received as input. The default argument for <code>geom</code> is
<code>&quot;point&quot;</code>.</p>
<p>Using defaults except for the color aesthetic. Highlight 1/4 of
observations from lowest density areas of the whole plot panel (using
the default of <code>pool.along = &quot;xy&quot;</code>) using overplotting of
selected black points with red points. We also highlight the boundaries
of the quadrants.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, </span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>                     <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" />
Highlight 1/4 of observations from lowest density areas in each quadrant
of the plot. We also highlight the boundaries of the quadrants. Compare
the plot above to that below.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, </span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>                     <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a>                     <span class="at">pool.along =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" />
Highlight a given fraction of observations in each quadrant, by setting
<code>pool.along = &quot;none&quot;</code>, and passing a vector of length four to
<code>keep.fraction</code>.</p>
<p>Keep at most 20 observations.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">keep.fraction =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>                     <span class="at">pool.along =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a>                     <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAAAllBMVEUAAAAAADoAAGYAOpAAZrYzMzM6ADo6AGY6kNtNTU1NTW5NTY5NbqtNjshmAABmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQtpCQ2/+rbk2ryKur5P+2ZgC2/7a2///Ijk3I///bkDrb///kq27k////AAD/tmb/yI7/25D/5Kv//7b//8j//9v//+T////0mONJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMXklEQVR4nO3dAXfTRhaGYZWW3boF2lKg6ZbCNqEQsiFF///PLQ4JJLIka+bO1Xx39D6np5Ri2RP5jTQj26HrAWFd7QEAcwgU0ggU0ggU0ggU0ggU0lICfQisJifQhNu2jjOPMwK1IVBnBGpDoM4IFNIIFNIIFNIIFNII1IZFkjMCtSFQZwRqQ6DOCNSGQJ0RKKQRqKzz8/PaQxBAoKrOzym0J1BdBHqNQG38FkkEeo1AbRxX8fS5R6A2XGZyRqA2BOqMQCGNQKtjrjmHQGtjtT6LQGsj0FkEamNfJBHoLAK1KbCKp885CwO9/Hm3OxluAy4zuVsW6NWLV/3lL68G24BA3S0L9OLxp3+d3h5CCRSrWT4H3R9Fb35wmOuIgDsWB/rx5bPhNoC7pYFePf/SJ4FiPYtX8Sdff0OgX7FIcrYs0Ht9EugdBOpsWaBvd3us4g8RqDNeSbIhUGcE2qCWXjwl0PY09fYTAm0PgXoMBMUQqMdAgpJcJDXUJ4EaSQbaEgK1IVBnBGpDoM4IFNIIFNIIFNIIVEdLV4eKIVCbgoukpq6vF0OgNgTqjEBtCNQZgdqUvA5KnyMIFNIIFNIKB8pZCmWVDZR5PgojUBveLOKMQG0I1BlzUBsCdcYq3oZAnREopBEopBEopBEopBGoDYskZwRqQ6DOCNSGQJ0RqA2BOiNQSCNQSCNQSCNQSCNQGxZJzgj0s9z3CRKoMwK9lv1OawJ1RqDXCFQVgV7b3mdVoiDQz+hTFIFCGoFCGoHasEhyRqA2BOqMQG0I1BmB2hCoMwKFNAKFNAKFNALNxWtPqyDQTDev3rNIckagmQh0HQSaiUDXQaC5Ps9BCdQZgRbSdbTqgUDL6LqDQlnml0CgZRwGypv0iyDQMgjUCYHafNlvY2d4ArUjUJuZ/UafJRCoDUt3ZwRqQ6DOCBTSCBTSCBTSCBTSCNSGRZIzAt3Lv2RJoM4ItDe96EOgzgi0J1BlBNrzsrmyxYFePj0bbtMO+pS1NNCL3Y8rB0o06BcHevrDnysfQbd32r379W7ta5+Weop/uOc6ohtBAi23SLr7BQf54tcgOwcN8hwRqDPZQIOc5QjUmW6gMRS8DsocdAyBQhqBQhqvJEEagUIagdrwZhFnBGpDoM4I1IZAnRGoDYE6216gXAMPZXOB8ipiLAQKaQQKaZsLtPAclEWSs+0FWhaBOiPQ2x+OnPfXdBCoMwK9+fHyI39Nx6KNy48HdxGoLVA4I1AClUagt2nSpyQCJU1pBGpD2s4I1IZAnTUb6ErnbQJ11mqgay3KCdQZga6nwojivzFmQ4HWLrbE90ziPTTw1q1WAz18KqsfUwsMIPUuCDQQAg2JQI33mjYC66Olfg3h+9xQoFN92LJZ+Zhcex69vg0FOs54YN1aL6sjUAKVRqC1106YtflANzitC4VAIW0zga54oOSYXFDDgd6bXHpNNUfuk1ltSe0G2t0LhUCDIlDjo0w8sMNDbdNWAvWaGI7dKX0WFDzQudeaOZC1IHagSu/W4dvBBYEWwszTB4EWQqA+Ygda//2ORS4TkPa0mIFW7/KLEpcJOPjOCBmo0pm9xH0Q6LSxQD88+eaPJdtUQ6DbMX4Efd113/59dJtqhAItgkKnTZ3iPzzpuu+PbFNPW30S6IzpOeg/v3fdg7/mtmlKzUQIdNpUoG+67rtPp/rRE32LgS5vxOXDy/Q5ZTTQ/cHzp/1/vB89hG460MENCcvZ+Cp+/NQ+3KYlrQYafrYe8jqoh4QzfKBA41/vINBU90smUGc1ApXfZ+2sWdICVXxiKgQ63Glyu6Wlqz6Jfao9FQqB6u0W50Bl69d7JnoCHeMbqO7xWe+Z6BXmoIK7JaGg9NR0A9WbbPUSq3jF3bJYU4EqEgg0tIzU6DMFgdrQmjMChTQChTQChbT4gca7CMAqKYFMoLmd1byMmnfBiOtMKVQCze6sYqCZpc1tRrpDBJqvfKACB1e1GZNgoIm7qO4ZPienbnLD+oHKvfCsEmh/t89yu8j3+Z6696OPOhUigR6QCfSLkruozhN+/FHnDqHZj5m34QCBHrXpQP0ecqkKfc4+5MJAr57vHr0bbuOk7BleMtDiU4/6c4N880ekZYF+fHnSv3083CYA96et7Ik6fxgbD/Tqt7P+8unZYJuVST4FKkOS3DnLlAj08td3/dWLV/vb793sjW7VX79enFH6tRMZR+RfP/U5/efLAr14dBvoXp0j6Jc+peiNqDGpR9C726xLM1A4Yw4KaUtX8c9iruIRneB1UOArvVeSYmHW4YxAbQjUGYHa+AbKupBAjVwD4soagUoj0BYDbeg5JdAGA23qSW3oS8lFoNE1/uUSqPHhZsaxzgAa/4YMHOjEEzP2v/2ew6khrNYNgU5vU1fCM+P4JI7dbUeg5RCocRRTD7daN233SaAOVu2zdXEDTTl0rFwLcZYTOFBsAYHm40C5AgLNxkRzDQSabSJQoi2KQLONB8phtSwCzbcvkUCdEWhhBFoWgZZGn0URqA8yLYRAXXCiL2XLgZZoaOIeCLSUDQdaJCICdUagxjuZvnPrXWNvS4EOokkPdOy6vHFMOGJDgR4Eee+3C2LlvF3BlgNd/IcJt0FhBLrgDxNug8I2FOjsWXxRfNY+6TvdlgKdlRlPykYcgTMQqM3sMfnw/6QESs17TQea9hRnBZEyqU0LlOPttZYDXSOIpFXX/AOYL9M2iUDzbl3+7oYbEOg1As279aL7S739zOsIm9VyoGvMQcvhiDmq6UBjoc8xmwrUIQGacralQD1OogTqjECN91n4/jBAoMb7LHx/GNhSoCxDAtpUoBloujICncXFydoIdFaLgZ6fn9ceQgICnXU00Hj1np9PFKoZLoHOO3YAbSfQyXDrIlAbAnVGoDb395vWhHViNNNneAJtnNaSKnU0kn0SaEkqgX4ehcpobCIEusZ+LvIYIkncDENkNEYBAl1jRyc8xpFP1xcakMXtF6MxGiMCTXyMwS0VE2jj0HlDJNAjhyXf/d3dWH7jO791GpPJ3RFqLn2W0wh0vg+lPkMEeofoxaPlIgTqLPHBBx8OLj6csgi0iEiBxkKgZVRNpOE+mYMCrggU0gjU5vAH2NUZR7MI1Obg3UwUWhaB2hCoMwK1IVBnBFrUsj6peDkCXR/H2QQEuj4CTUCg6yPQBARqkxUafS5HoDaU5mxxoJdPz4bbbM/hoY9AnS0N9GL3I4GOTB4J1NnCQE9/+JMjKKubClJP8Q/3XEckjEDXxxw0xWb7rPe25+OBnu52j3sCXaLZfit+cIQjqM29D9A5zgDqfnKDQMNaKdDKn30j0LC2Eaj0HHR6Gwz227E+l/c7vGXtQOsh0PVk/3ydvvYctCICXY8l0M0KEmgTzxeBZogRaNAnbDjo/DnodhGozdyodEcdCIGmSHu7ncqoQ4sRqMgpL/HtdgRaQJBANaS+H5Q+7Qg0AYfE9RFoCvpcHYEeoEIlBDrEeVwKgQ6lBUrKzgh0iEClEOiBtL+Uxm8c2CNQGwJ1RqCQRqCQRqCQRqCQRqA2LJKcEagNgTojUBt7oJv9vOYyBGpjDnS7n3hfhkArI9B5BFoZgc4j0NrocxaBQhqB2nCZyRmB2hCoMwK1IVBnjQW6+seJCNRZW4HygbfmECikESiktRUoP3ShOY0Fujq+H5wRqA2BOiNQGwJ1RqA2BOqMQCGNQCGNQCGNQCGNQG1YJDkjUBsCdUagNgTqjEBtCNRZVqDAajICLSr44Tj48OOMn0DzBB9+nPETaJ7gw48zfib7kEagkEagkEagkEagkFYr0Mufd7uTSo9tdvV89+hd7UEYRNr5lQK9evGqv/zlVZ0Ht/r48qR/+7j2KPKF2vmVAr3YP7+nUb6LB65+O+svn57VHka2UDu/4hx0/40c0uWv7+IO/kaY8dcL9OPLZ9Ue2+biUfhA4+z8CoGe7naP9wuNKLvoQPwjaKCdX28VH2QONCL6HDTUzq8UaKRddGB/foy8ig+18ysF+na3F2g/3RP8Omionc8rSZBGoJBGoJBGoJBGoJBGoJBGoJBGoJBGoJBGoK7efPNH/+HJ97WHERiB+nr93f4fZCNQX//713/+/VftQURGoM7edD/VHkJoBOrsdccZ3oJAfb1/8N8nHEINCNTVh091vn/AJDQfgbp6/e3f/T+/c5LPR6CQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQRqCQ9n/AQBGBdUdGkAAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<p>Keep always 20 observations by setting
<code>keep.fraction = 1</code>.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">keep.fraction =</span> <span class="dv">1</span>, </span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a>                     <span class="at">keep.number =</span> <span class="dv">20</span>, </span>
<span id="cb61-6"><a href="#cb61-6" tabindex="-1"></a>                     <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAAAllBMVEUAAAAAADoAAGYAOpAAZrYzMzM6ADo6AGY6kNtNTU1NTW5NTY5NbqtNjshmAABmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQtpCQ2/+rbk2ryKur5P+2ZgC2/7a2///Ijk3I///bkDrb///kq27k////AAD/tmb/yI7/25D/5Kv//7b//8j//9v//+T////0mONJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMbElEQVR4nO3dAXfTRhaGYZWW3boF2lKgdEthm1AI2ZDi///nFoUkJLIka+bO1Xx39D5nz1KKZY2tl9FIcdJuDwjrag8AmEOgkEagkEagkEagkEagkJYS6ENgNTmBJjy2dZx5nBGoDYE6I1AbAnVGoJBGoJBGoJBGoJBGoDZcJDkjUBsCdUagNgTqjEBtCNQZgUIagco6OzurPQQBBKrq7IxC9wSqi0CvEKiN30USgV4hUBvHq3j67BGoDbeZnBGoDYE6I1BII9DqWGvOIdDauFqfRaC1EegsArWxXyQR6CwCtSlwFU+fcxYGevHzbvdyuA24zeRuWaCXL17vL355PdgGBOpuWaDnjz//38nNFEqgWM3yNWg/i17/4DDXEQF3LA7006tnw20Ad0sDvXx+2yeBYj2Lr+Jffv0NgX7FRZKzZYHe65NA7yBQZ8sCfbfrcRV/iECd8ZUkGwJ1RqANaumLpwTanqY+fkKg7SFQj4GgGAL1GEhQkhdJDfVJoEaSgbaEQG0I1BmB2hCoMwKFNAKFNAKFNALV0dLdoWII1KbgRVJT99eLIVAbAnVGoDYE6oxAbUreB6XPEQQKaQQKaYUD5SyFssoGyjofhRGoDR8WcUagNgTqjDWoDYE64yrehkCdESikESikESikESikEagNF0nOCNSGQJ0RqA2BOiNQGwJ1RqCQRqCQRqCQRqCQRqA2XCQ5I9Avcj8nSKDOCPRK9ietCdQZgV4hUFUEemV736sSBYF+QZ+iCBTSCBTSCNSGiyRnBGpDoM4I1IZAnRGoDYE6I1BII1BII1BII9BcXcf6cwUEmqnrrgolUmcEmolA10GgmQh0HQSa68salECdEWghXDP5INAyrs/4d/ER0xIItIzDQPmQfhEEWgaBOiFQm9v3bewMT6B2BGoz877RZwkEasOluzMCtSFQZwQKaQQKaQQKaQQKaQRqw0WSMwLt5X/Sg0CdEeh+9JMeizctOxIMEeieQJUR6N4UKJwtDvTi6elwm3bQp6ylgZ7vflw5UD5rgf3iQE9++HPlGXR7n1a7O41v7bVPSz3FP+y5juhakEDLLQ3uLoSDvPg1yK5BgxwjAnUmG2iQsxyBOtMNNIaCV/+sQccQKKQRKKTxlSRII1BII1AbvkTqjEBtCNQZgdoQqDMCtSFQZ9sLlI/WhbK5QPlwciwECmkECmmbC7TwGpTWnW0v0LII1BmB3v4HZbJmVgJ1RqDXq9LMtSmBOiNQW6BwRqAEKo1Ab/+rm/SpiEBJUxqB2pC2MwK1IVBnzQa60nmbQJ21GuhaF+UE6oxA11NhRPF/AMSGAq1dbIm/M4nP0MCP0Gk10MNDWX1OLTCA1Kcg0EAINCQCNT5r2gise0t9DeH73FCgU33Ysll5Tq69jl7fhgIdZ5xYt9bL6giUQKURaO1rJ8zafKAbXNaFQqCQtplAV5womZMLajjQe4tLr6XmyHOyqi2p3UC7e6EQaFAEatzLxI4ddrVNWwnUa2E49qT0WVDwQOdaYCJrQexAlc6mOiNpCoEWIjSUphBoIUJDaUrsQOufV4vcJqj+KoTFDFTniJa4TcDkOyNkoEJHtMQwhF6OnrFAPz755o8l21QjdEQJ1Nn4DPqm6779++g21bR2RFt7PSVNneI/Pum6749sU09jx5NAp02vQf/5vese/DW3TVNqJkKg06YCfdt1330+1Y+e6FsMdHkjLt+8TJ9TRgPtJ8+f+n/4MDqFbjrQwQMJy9n4Vfz4qX24TUtaDTT83BzyPqiHhDN8oEDjr24JNNX9Iy5+9Ak0h/x7Jj/AxdICVfxJThUCHb5pcjnEn3a+SuxTr9D6gerl4DwitZd7i0Cvd7XtQPVe7w0CvdnX8AyvdsASBpQ+csHXe0OwT4WreNnjtURTgSoSCDS0jNToMwWB2tCaMwKFNAKFNAKFtPiBxrvmiDfiimQCzT1qNe/a5O2a+0wpVALNPmoVD3fmruc2I90hAs1XPlCByVXtq0mCgSYeo7pn+Jx9d5Mb1g9U7uvxKoHu7/ZZ7iD5Hu+pZz+616nXSKAHZAK9VfIg1Tngx/c6N4Vm7zNvwwECPWrTgfrtcqkKfc7ucmGgl893j94Pt3FS9gwvGWjxpUf9tUG++Ul7WaCfXr3cv3s83CYA98NW9kSdP4yNB3r52+n+4unpYJuVSR4ClSFJvjnLlAj04tf3+8sXr/vH967fjW7VX7/enFH6tRMZR+RfP/c5/efLAj1/dBNor84MetunFL0RNSZ1Br27zbo0A4Uz1qCQtvQq/lnMq3hEJ3gfFPhK7ytJsbDqcEagNgTqjEBtfAPlupBAjVwD4s4agUoj0BYDbeiYEmiDgTZ1UBt6KbkINLrGXy6BGnc3M451BtD4X8jAgU4cmLF/7XcMp4awWjcEOr1NXQlHxvEgjj1tR6DlEKhxFFO7W62btvskUAer9tm6uIGmTB0r10Kc5QQOFFtAoPmYKFdAoNlYaK6BQLNNBEq0RRFotvFAmVbLItB8fYkE6oxACyPQsgi0NPosikB9kGkhBOqCE30pWw60REMTz0CgpWw40CIREagzAjU+yfSTW58avS0FOogmPdCx+/LGMeGIDQV6EOS93y6IlfN2BVsOdPEfJjwGhRHogj9MeAwK21Cgs2fxRfFZ+6TvdFsKdFZmPCkbMQNnIFCb2Tn58N+kBErNvaYDTTvEWUGkLGrTAmW+vdJyoGsEkXTVNb8D823aJhFo3qPLP91wAwK9QqB5j170fKmPn/k6wma1HOgaa9BymDFHNR1oLPQ5ZlOBOiRAU862FKjHSZRAnRGo8TkLPx8GCNT4nIWfDwNbCpTLkIA2FWgGmq6MQGdxc7I2Ap3VYqCxXhGBzjoaaKRj/cXkSzo7O1t7LAsQ6Lxj0007gZ6dSRZKoDYE6oxAbe6/b1rLu4nRTJ/hCbRxWpdUqaOR7JNAS1IJ9MsoVEZjEyHQNf5qFzmWIklcD0NkNEYBAl1jcZRwMOceqFHEzYvRGI0RgV5ZHujgkYoJtDF1XhMJdC5B90C7a8sffOe3TmMyuTvC6K1qBDrfoFKfIQK9I/xsGiFQZ4nHcPDNwcWHUxaBFhEp0FjCvziNQOveJA5+COdFf3EigQLjCBTSCNTm8AfY1RlHswjU5uDTTBRaFoHaEKgzArUhUGcEWtSyPql4OQJdH/NsAgJdH4EmIND1EWgCArXJCo0+lyNQG0pztjjQi6enw22253DqI1BnSwM93/1IoCOLRwJ1tjDQkx/+ZAbl6qaC1FP8w57riIQR6PpYg6bYbJ/1PlB+PNCT3e7xnkCXaLbfit+Swwxqc+8b6BxXAHXbJ9CwVgq08uqXQMPaRqDSa9DpbTB4345FtDyy4SNrB1oPga4n++fr7GuvQSsi0PVYAt2sIIFq/vTfRASaIUagoj8//Zj88zR93iBQm7n3jXmwAAJNkfZxOwItIEagImvQxI/bEWgBQQLVkPp5UPq0I9AETInrI9AU9Lk6Aj1AhUoIdIjzuBQCHUoLlJSdEegQgUoh0ANp/1Eav3GgR6A2BOqMQCGNQCGNQCGNQCGNQG24SHJGoDYE6oxAbeyBanzUVRaB2pgDVflmAVUEWhmBziPQygh0HoHWRp+zCBTSCNSG20zOCNSGQJ0RqA2BOmss0NWvOAjUWVuBcs+mOQQKaQQKaW0Fyl3v5jQW6Oq4SHJGoDYE6oxAbQjUGYHaEKgzAoU0AoU0AoU0AoU0ArXhIskZgdoQqDMCtSFQZwRqQ6DOsgIFVpMRaFHBp+Pgw48zfgLNE3z4ccZPoHmCDz/O+FnsQxqBQhqBQhqBQhqBQlqtQC9+3u1eVtq32eXz3aP3tQdhEOnNrxTo5YvX+4tfXtfZudWnVy/37x7XHkW+UG9+pUDP++N7EuVv8cDlb6f7i6entYeRLdSbX3EN2v9FDuni1/dxB38tzPjrBfrp1bNq+7Y5fxQ+0DhvfoVAT3a7x/2FRpS36ED8GTTQm1/vKj7IGmhE9DVoqDe/UqCR3qID/fkx8lV8qDe/UqDvdr1A79M9we+Dhnrz+UoSpBEopBEopBEopBEopBEopBEopBEopBEopBGoq7ff/LH/+OT72sMIjEB9vfmu/x+yEaiv//3rP//+q/YgIiNQZ2+7n2oPITQCdfam4wxvQaC+Pjz47xOmUAMCdfXxc50fHrAIzUegrt58+/f+n985yecjUEgjUEgjUEgjUEgjUEgjUEgjUEgjUEgjUEgjUEj7PyzW7VrmhbEbAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<p>Keep always 20 observations, 5 per quadrant, by setting
<code>pool.along = &quot;none&quot;</code>.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">keep.fraction =</span> <span class="dv">1</span>, </span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>                     <span class="at">keep.number =</span> <span class="dv">20</span>, </span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>                     <span class="at">pool.along =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>                     <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAAAllBMVEUAAAAAADoAAGYAOpAAZrYzMzM6ADo6AGY6kNtNTU1NTW5NTY5NbqtNjshmAABmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQtpCQ2/+rbk2ryKur5P+2ZgC2/7a2///Ijk3I///bkDrb///kq27k////AAD/tmb/yI7/25D/5Kv//7b//8j//9v//+T////0mONJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMc0lEQVR4nO3dDXvTRhaGYZWW3boltKVA0y2FbULBZEOK//+fW5zvyJKimTNH857Rc197Ldtiy2PpyWgkJ9luBwjrag8AmEKgkEagkEagkEagkEagkJYS6FNgMTmBJjy2dZx5nBGoDYE6I1AbAnVGoJBGoJBGoJBGoJBGoDZcJDkjUBsCdUagNgTqjEBtCNQZgUIagcrabre1hyCAQFVttxS6I1BdBHqJQG38LpII9BKB2jhexdPnHoHacJvJGYHaEKgzAoU0Aq2OteYUAq2Nq/VJBFobgU4iUBv7RRKBTiJQmwJX8fQ5ZWag5z9vNsf954DbTO7mBXrx+u3u/Je3veeAQN3NC/Ts6Ot/ndxMoQSKxcxfg+5n0etfHOY6IuCe2YF+efOy/xzA3dxAL17d9kmgWM7sq/jju38g0DtcJDmbF+iDPgn0HgJ1Ni/QD5s9ruIPEagzPkmyIVBnBNqglj48JdD2NPXtJwTaHgL1GAiKIVCPgQQleZHUUJ8EaiQZaEsI1IZAnRGoDYE6I1BII1BII1BII1AdLd0dKoZAbQpeJDV1f70YArUhUGcEakOgzgjUpuR9UPocQKCQRqCQVjhQzlIoq2ygrPNRGIHa8M0izgjUhkCdsQa1IVBnXMXbEKgzAoU0AoU0AoU0AoU0ArXhIskZgdoQqDMCtSFQZwRqQ6DOCBTSCBTSCBTSCBTSCNSGiyRnBHol9/sECdQZgV7K/k5rAnVGoJcIVBWBXlrfz6pEQaBX6FMUgUIagUIagdpwkeSMQG0I1BmB2hCoMwK1IVBnBAppBAppBAppBJqLz54WQaCZrj+95yLJGYFmItBlEGgmAl0Ggea6WoMSqDMCLaTraNUDgZbRdQeFkmwJBFrGYaADySIdgZZBoE4I1OZ2vw2d4QnUjkBtJvYbfZZAoDY06IxAbQjUGYFCGoFCGoFCGoFCGoHacJHkjED38m9ZEqgzAt2ZPvQhUGcEuiNQZQS642NzZbMDPX9x2n9OO+hT1txAzzY/LhwoP9aL3exAT374c+EZdH2/lPv+NM6UfiP1FP90z3VE14IEWq6j+wthFsW3ZNegBFpsy6HJBhpkDUqgznQDjaFgRqxBhxAopBEopPFJEqQRKKQRqA3XMs4I1IZAnRGoDYE6I1AbAnW2vkC5Bx7K6gLlU8RYCBTSCBTSVhdo4TUorTtbX6BlEagzAr2ZU/NmVgJ1RqDXq9LMtSmBOiNQW6BwRqAEKo1Ab9KkT0kESprSCNSGtJ0RqA2BOms20IXO2wTqrNVAl7ooJ1BnBLqcCiPS2wmpVhRo7YNV4msmcQuKX6aJWg1U8P99uMAAUjdR/T3bNRvogeoHi0BzEKhxq2kjsL5a6nsI3+eKAh07WLZjuPDxjx9cqhUFOsw4sa6tl8URKIFKI9D41xFNW32gK1zWhUKgkLaaQBecKJmTC2o40AeLS6+l5sA2WdWW1G6g3YNQCDQoAjW+ysgLO7zUOq0lUK+F4dBG6bOg4IFOtcBE1oLYgSqdTXVG0hQCLURoKE0h0EKEhtKU2IHWP68WuU1Q/V0IixmozhEtcZuAyXdCyECFjmiJYQi9HT1DgX5+/s0fc55TjdARJVBnwzPou6779u9Hn1NNa0e0tfdT0tgp/vPzrvv+kefU09jxJNBx42vQf37vuid/TT2nKTUTIdBxY4G+77rvvp7qB0/0LQY6vxGXH16mzzGDge4nz5/2/+PT4BS66kB7DyQsZ8NX8cOn9v5zWtJqoOHn5pD3QT0knOEDBRp/dUugqR4ecfGjT6A5ttutcQvOoh/UO2mBKr7vCoFutw8Lldst8aedO4l96r3v+oHq7RbnEam93Vt6R2JHoEN8R6T3fm9Ijqz+GlRwtyQMKH3kgu/3huLABK7iFXfLbE0Fqkgg0NAyUqPPFARqQ2vOCBTSCBTSCBTS4gca75oj3ogrkgk096jVvGuT99LcZ0qhEmj2Uat4uDNfeupppNtHoPnKByowuVYfQI9goIm7qO4ZPue1u9En1g+0/gh6VALd3e+z3C7y3dtjW3/0VcfeY/086o+gRybQWyV3UZ3d/firTk2h2a+Z98TD7RDotFUH6veSCVsqsp0Ekz9hMTPQi1ebZx/7z3FS9gwvGWjxDOQmvgT9n7B4aF6gX94c7z4c9Z8TgPthK3uizh/GygO9+O10d/7itPechUkeApUhSe6ceUoEev7rx93F67f7x+9d741u0T/vbs4o/dmJjCPyn1/7HP/7eYGePbsJdK/ODHrbpxS9ETUmdQa9/5xlaQYKZ6xBIW3uVfzLmFfxiE7wPihwR++TpFhYdTgjUBsCdUagNr6Bcl1IoEauAXFnjUClEWiLgTZ0TAm0wUCbOqgNvZVcBBpd42+XQI0vNzGOZQbQ+Bdk4EBHDszQv/Y7hmNDWKwbAh1/Tl0JR8bxIA5ttiPQcgjUOIqxl1usm7b7JFAHi/bZuriBpkwdC9dCnOUEDhRrQKD5mCgXQKDZWGgugUCzjQRKtEURaLbhQJlWyyLQfPsSCdQZgRZGoGURaGn0WRSB+iDTQgjUBSf6UtYcaImGRrZAoKWsONAiERGoMwI1bmR849ZNY29NgfaiSQ906L68cUx4xIoCPQjywT/OiJXzdgVrDnT2XyY8BoUR6Iy/THgMCltRoJNn8VnxWfuk73RrCnRSZjwpT2IGzkCgNpNz8uG/SQmUmveaDjTtEGcFkbKoTQuU+fZSy4EuEUTSVdf0C5hv0zaJQPMeXX5z/ScQ6CUCzXv0rO2lPn7ic4TVajnQJdag5TBjDmo60Fjoc8iqAnVIgKacrSlQj5MogTojUOM2C28PPQRq3Gbh7aFnTYFyGRLQqgLNQNOVEegkbk7WRqCTWgx0u93WHkICAp30aKDx6t1uRwrVDJdApz02gbYT6Gi4dRGoDYE6I1Cbh/tNa8E6MprxMzyBNk7rkip1NJJ9EmhJKoFejUJlNDYRAl3iS7vIsRRJ4noYIqMxChDoEoujhIP5yE/XFxqQxc2b0RiNEYFemh9o75GKCbQxdV4TCXQqQfdAu2vzH3zvH53GZHJ/hJqXPvNpBDrdoFKfIQK9R/Tm0XwRAnWWeEbs/XBw8eGURaBFRAo0FgIto+pebLhP1qCAKwKFNAK1OfwFdnXG0SwCtTn4biYKLYtAbQjUGYHaEKgzAi1qXp9UPB+BLo95NgGBLo9AExDo8gg0AYHaZIVGn/MRqA2lOZsd6PmL0/5z1udw6iNQZ3MDPdv8SKADi0cCdTYz0JMf/mQG5eqmgtRT/NM91xEJI9DlsQZNsdo+633b8+OBnmw2RzsCnaPZfiv+4AgzqM2DH6BzXAHUbZ9Aw1oo0MqrXwINax2BSq9Bx5+D3n579Ncxz46s/8jagdZDoMvJ/v06u9pr0IoIdDmWQFcrSKDRf/3AJQLNECPQoL/AJf88TZ83CNRmar8xDxZAoCnSvt2OQAuIEajIGjTx2+0ItIAggWpI/X5Q+rQj0ARMicsj0BT0uTgCPaCx3sUVAu1TuWOASwTalxYop3xnBNpHoFII9EDSGZ5AnRGoDYE6I1BII1BII1BII1BII1AbLpKcEagNgTojUBt7oHywOolAbcyB8tH/NAKtjECnEWhlBDqNQGujz0kECmkEasNtJmcEakOgzgjUhkCdNRbo4lccBOqsrUC5Z9McAoU0AoW0tgLlrndzGgt0cVwkOSNQGwJ1RqA2BOqMQG0I1BmBQhqBQhqBQhqBQhqB2nCR5IxAbQjUGYHaEKgzArUhUGdZgQKLyQi0qODTcfDhxxk/geYJPvw44yfQPMGHH2f8LPYhjUAhjUAhjUAhjUAhrVag5z9vNseVXtvs4tXm2cfagzCItPMrBXrx+u3u/Je3dV7c6sub492Ho9qjyBdq51cK9Gx/fE+ifBX3XPx2ujt/cVp7GNlC7fyKa9D9F3JI579+jDv4a2HGXy/QL29eVnttm7Nn4QONs/MrBHqy2RztLzSi7KID8WfQQDu/3lV8kDXQgOhr0FA7v1KgkXbRgf35MfJVfKidXynQD5u9QPvpgeD3QUPtfD5JgjQChTQChTQChTQChTQChTQChTQChTQChTQCdfX+mz92n59/X3sYgRGor3ff7f+DbATq63//+s+//6o9iMgI1Nn77qfaQwiNQJ296zjDWxCor09P/vucKdSAQF19/lrnpycsQvMRqKt33/69++d3TvL5CBTSCBTSCBTSCBTSCBTSCBTSCBTSCBTSCBTSCBTS/g/tPu1atP2uQwAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<p>Keep a given number of observations in each quadrant, by setting
<code>pool.along = &quot;none&quot;</code>, and passing a vector of length four to
<code>keep.number</code>.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">keep.fraction =</span> <span class="dv">1</span>, </span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>                     <span class="at">keep.number =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>), </span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>                     <span class="at">pool.along =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>                     <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" />
A more elaborate example, 50% of observations, with color representing
the local empirical density, only for them.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">&quot;grey50&quot;</span>) <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, </span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>                     <span class="at">return.density =</span> <span class="cn">TRUE</span>,</span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>                     <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">after_stat</span>(density)),</span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>                     <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>                     <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">option =</span> <span class="st">&quot;magma&quot;</span>, <span class="at">begin =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Highlighting 1/4 of the observations from the panel, using
over-plotting with a ‘hollow’ shape. (We also shift one group with
respect to the other in <code>data</code>, to show that grouping is
ignored by <code>stat_dens2d_filter()</code>.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x <span class="sc">+</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">50</span>,<span class="dv">2</span>)), </span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>                     y, </span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>                     <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>   <span class="fu">stat_dens2d_filter</span>(<span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a>                      <span class="at">keep.fraction =</span> <span class="fl">0.25</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAAAyVBMVEUAAAAAADoAAGYAOpAAZrYAv8QzMzM6AAA6ADo6AGY6Ojo6OpA6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmOpBmZmZmkNtmtrZmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQOjqQOmaQkDqQkGaQtpCQ27aQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2Zma2/7a2///Ijk3I///bkDrb///kq27k///4dm3/tmb/yI7/25D/5Kv//7b//8j//9v//+T////JHyq+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQGklEQVR4nO3dD3/Txh2AcUPjhqxxC2F/aBltSdd2YSvpQgzYOE6i9/+i5pNlW5Il+WTdn9/dPd/PmsZAJC88PelOsjPKAMFGvp8A0IVAIRqBQjQChWgECtEIFKL1CfRrQI+nQM3tFlEjUIhGoBCNQCEagUI0AoVoBArRCBSiEShEI1CIRqAYZDweW90+gWKAvE6riRIoBhjndRIoZFJ9Wi6UQHE8AoVo481ZqL1dECgGGJc+2kGgGIBZfDhms5nvp+AD66BhyOtMM1G7CNSMWV4ngRpHoEaoPinUBgI1gkBtIVAjZpuzUN9PJDoEasas9BEGuQv07vvJ5K2F3crALN4SZ4He//Q+u/vhvfndSpHoOqhtzgL98mL14cNmCI0wUFjh9BxUjaLFG4eZ2y2i5jLQx3dvLOwWUXMY6P2P2z4JFJpczuLf7h4QKPQ4C7TSJ4FCk7NAP00UZvElLExp4EqSLyztayFQX7hBTwuBesL9T3oI1BMC1UOgnnCDnh4C9YUb9LQQqC/M4rUQqD+sg2ogUIhGoBCNQHEM228oskWg6M/+WzJtESj6s//GylsEit4cvG/tFoGiNwKFaA7eWHmLQNGf/TdW3hIWKBdXgpDqLJ7L08FIcx2Um8xRJylQ7uHFHgKFaLIC5SZz1EgKlJvMsUdWoMziUSMqUNZBUScsUKCKQCEagUI0AoVoBArRCBSiEShEI1CIRqAQjUAhWuKBcmlVuqQD5eYU+dIOlJeYiJdyoNzBHwACJVDR0g6Ul5iIl3KgvMQkAGkHyixevKQDZR1UvsQDhXQECtEIFKIRKEQjUIhGoB2Y4/tHoK1YJZWAQFtxr5MEBNqGW0lEINA2BCoCgbap3OvEdMkXAm21u9cpyemSs5/j0Y1AW+2yTHC65PAnIXUj0A7FgT3Fs1GHP8+4G4EelmCgLn9cbDcCPSzBl4YQqLndOpDeS0Nc/jzjbgSqIcFZvMOfZ9yNQLUktw7KLB7CsQ4KHEagEI1AIRqBQjQChWhpB5ra4lGAkg50ltzyZngIFKIFHejgvuhTPJeB3r2+NbnbBK+Qi7G5zGT/cpPDQL9MvjMbaHr3uQuxuVDv4oK9u0A/fPuH0RE0wduIpdjcbu/itnsPh/ivleG7I1BfdnczO7irOdxz0ATvcxeCQPWkd5+7EKXb7e3fdh9yoMziPdncbu/itvuAA03wPnch4pzFWwgUvkS5Dmppt4gagUI0AoVoBArRCBSiEShEI9BoyXjjhaEINFZjIW8NMhCBxopA6whUlij6JFDIRqAQLelAZzPu15Mu5UBnBd/PAx0IlEBFSz1QDvHCpRwocQYg6UAhH4FCNAKFaAQajziubda0lLK8GD35/exmcfbr6OnNw+VodJJli2dX+YfFs99Go68+7n0NgfoVyd0hNc2lLC/OV/88vVmcrsJ8uDzJ/9kGeqqaPdn7ouQCNbMIYGwpIaVA509vsmyqAn1VPFh92AX6qhhOq1IL1Mwav8ErBaU+/aRqY6/NpUzVEXxxtm5ynj9Qh/ar3b+XF6/qX0Sg/rZS42cwtbJXAj2esEN8SfSBVo7q8ydXDYf4s5v6FyUXqGCxH+K3kyTV5GaSpH7x4fIJk6TQBD136lhm+q0INCuWmbLF6Wj0j5frZab9PglUqLBn9x2lzBvWOpWGCXyOQGWKMVB12tl0FM8RaGBC7rOtlOmo8SieI1C4w7V4iJZSoNyfrEvQSUFCgcb/8iNTXUmaVhFoPIx1RaAc4m0w15WcPpMKNHqCujImwkBjHyjTEl+gVk41id4XAvW1TWiJL1Abox2BehNhoDbQZ4nTuRiBhsjrdN3tKimBBsjvQnoUgS4vnjTf8mR+twnyfKUngECXLxvyq46g141v7jBstyj4XZF3+t/HoVKaZwfzv53v/2L9EL+8GI0a/pjWbiGYpECb11cefvn3X3Xe+ka9mOnp3qs/NXYL04wmJegQ3xzo4puP13svi98LdJrflH/deKCXH2hcC0sS7k867ikcdYifnmfzAy87VoNn3vC8cQgVH2hkS/P+A833f8STOKYUFV/Dobs6i28+tA/ZrVORBer/Rqdx/hTcBLo6wq8O3S7f+sZDLXH16d24GMSbC+0Y348JdKra3D/GWws0b4VggtYVaOfR/4hAH/6ljt77S6H2Al3/SLg+X4IWvg71402Hjb/XcfQP4FLnrDghTKlQWx35myyNSx/rv9N19CfQYeyceVjryGOgrcfxCAItzkJ7Ph8XLE327XXkcTbf9v+p6+gfRKBFmRL7tLYa5X1VyKX2o38WSKCCZ/FCn1ZQTM/i28S1DgqHDK+DtuCGZZhHoBCNQCFaeIFyPpqU0AIVN6P3+lwSWI0KLlBh1+W93pZncD1fbOqBBSrusudeoC57Nfl+i1ILJdCB9vo0W2j31gwOoDEFqn6gV/GCjjI3gcq9Lp8zHOhs5igcjd34SfhQKU3PKv85nfs/jMbROejuo3sa8RkeQHsObRYj8jTIHiil8VnlgT784idQn7N4Q8Njn430y8JmRKEFmr8wqSL+dVAfPyG+5wDa/MeNfMsCOsTn56B7r3c/EOj9j5Pnn3V325ejag0NoPaebFufklaO+zlqkpQf4i/rs6TuQB/fvc0+vRiy23biVu+7OX+mSQa6/7rj7kDvf77N7l7fDthtO2mr9+KE2+fxgfZ9VefdPz9n9z+9V7tUjthtK3mLozDG2Trol+ebQI/dbSsCjZizK0m7EdTwbgNYvcfxnAVq9xx09xFxcRbo47s3zOLRm7ubRWJYB4Vzgd3NhNQQKEQjUAxk9xo9gWIYy3c5ESiGIVAc5vdHI9rcOoHGQO5LigYj0BgIDNTUEyLQKJjvc+AWjf0nQ6B9CLpe1f73b6SMoYERqA+C7kxvD8BMGoO3wiHeg4QCFfNeOATah5g+rR/ixSBQiEagEI1AOwk6pieKQLsImhWlikC7VAMlVg8ItFO1Twp1j0C1EagPBKqPPj0gUIhGoGgi5nIUgaKBnBtMUw2U88lOBGput0dhRn6AlD4JFLIlGuiBQ3zw9YoZAAdLNdBOwY+v+6eQwRZLoA3iC1TOpKcvAm0SeJ/7AyaBZlEFqimgjkPtk0AHCP5MIAQE2lOpSQLN7A/NSQRqsKNKlEH1aack6ye3KQRqcqQLdtQ0W9J2WwRqgNGoAu3TbEmljXGINyDUqIwyO4A6WxVIIlCY5m7VikAhGoFGKdh1+T0EGqNwr2zuIdAYEWgTApUjmj4JFLIRaJLCGWEJNEUBnaMSqCSuLnkRqMPdRqR204DFXIPpk0Alqb8dKfcQEKgstQGUQAlUn51aurYaTZ9DzngJVJOd8SyFUTKv8+hECVQTgR5rnNdJoLa5P8TXDJp5+5u2j4tFrSOfQHCBuhpyxI1sg9YuPS587gI96jkEFmiejYt25B17ww20dBba/1mEFmhep6l0OhqUF2ioh/ji2D4+8lQ0rEBnRThm2umMUFyfwdoMncedihIorFNlphJocRZ63JfvbY4+ndmeivb8urACLcqkqwCNSx97CC1QV7N4mJbGLN7dOiiMS2EdFPbJuleUQFEl7G57AkUVgRreLQwT1SeBDsWczS4CHYarUZYR6DAEahmBDkSfdhEoRCNQiOYy0LvXtxZ2awUHbikcBvpl8l0ogTL1EcNdoB++/SOYEZRAxfBwiP9aMbdbK+hTCs5BA5LifzZOAv0wmbzICHQoNycesi7FM4JaZjIpJ4EKu5mJQO0y25SbAbRPoPZrJlCrAlwO6JHcsPet08OVpAE04guuzz6GvW+dnhgC9TVKBTg8GjXwfev0hB+ov1ciEyiBajD7fmL9dp10n0e/WUgvwQdq9u2atPaYdpYlR75ZSC8E2nuHiR/YS5jFazD8fmLFRjt/9gaBbsW1DmpntxbeT6y7Qfp0KYJAzc/iGSTlCD9QG+ugsfYp7Dq7jhgChR4XcxrjCDQdLq5MGkegyXBy4cc4Ak0GgfrZLTQ5uTJpHIGmw8WVSeMINB3M4r3sFvpYB/WwW0SNQCEagUI0AkU/js9jCRR9OF8JIFD04fx6PoGiB/eXSwkUPRAoRHN/PZ9A0Yfz6/kEij6YxUM41kHRV4D3gGgj0OAFeRedNgINXpCvhdNGoKEL86VG2gg0dASqi0C9CPO1cNoINHhBvhZOG4EGj1m8JgL1hXVQLQQK8wgUohEoRCNQiEagEI1AIRqBQjQChWgECtEIFKL5ChTQ4ydQWcSN5+KekMBn1B+BGiPuCQl8Rv0RqDHinpDAZ9RfuIEiCQQK0QgUohEoRCNQiBZioHffTyZv888+TSaT7249P537HyfPP9c+80vYN2iQAAO9/+l9dvfDe/Xph7e+n0yWPb57m316Uf3ML2HfoGECDPSLaiD/zj/+573vJ7PK4efb7O71beUzv4R9g4YJMFBFDRL5IXVzLPPn7p+fi6ez+8w/Qd+gYcIM9PHdG/UvdRzzPkh8eb7JcveZd5K+QcMEFuiHyeSFGhjelH7J8wghcQQV9Q0aJrBAc3ffl7/lvr//8s5BhX2Dhgkw0N23Xx1TH//ruQh1NN3M4t+ImMUL+wYNE2Cgam1vdeqvxqrVp996P6SuVz/V0xGyDirtGzRIgIEiJQQK0QgUohEoRCNQiEagEI1AWzxcvmp4sLwYjZ7e7H6jeLx8eaW1wcXpaDT66mOWXa//1bQZnW0lhEBbTE8aHiwvVp9c79LaPp6Xc2vf4OaPTb/6+HC520F1MxrbSkiqgS6edY9TlXFs+2D+5KrypdvHlfG2fYNF6MuL1Z+e70bi6mYObysl6QQ6XVWwvDgvHu0qW5z9ujq8PlyO1EF28ey39cF3qj6oX1RJTStjWr3t/HFp2OvY4PX57ivyShs3wxBakk6g2fWJ+l+hFOjpiUrxJG9ocarSOlk9Pl//osoof1DaTq2f/HGp2vYNLi/+MlLV5oNnPdDdZg6N7klJKNDFs9/P1kfVfK4yKmY7i9PN8XaVTP5gFUhezyaUakpqJM72Hpf+TMcGT1eVLr75WPzmectm6ukmLaFAs+lo9xdfGkHVZ9O82NH55uBbOUusBFPeSOlxaZRt3+Bmaw0jaHkztRE7bSkFej3aTZzrgRaH7fZAVXGrbq5r4+fm8V6gTRvcbG3/HLSyGQItSSjQ+dP/lY7D1UDnRSDrI/LZTdshflpeBC0/XtY23bjB9cj58qo+i69thkN8STqBqr/2ea0vJe/p4VKtQj652sxp8vn2enJzsp18t0zg67/TtcFX6zn6dXUdtLYZJkkl6QSqZsnlKjbWOahVodWgl68KqT8zLy8zbdd9ijPLV5uD8OZxsfR+fmiD6opRvq3r/BcbN1Nf1UpcOoFq2Q5ezQv1uz/39+rjfGys/2L7Bjs3w0J9GYFW7I6ujZc6t+a1acx6gb1hbtOywc7NMICWEGjFrqfmm0U2/qyey66Hxz/3T3DbNtixGW4WqSBQiEagEI1AIRqBQjQChWgECtEIFKL9H8G1fu81ELwOAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<p>Highlight 1/4 of observations from lowest density areas of the plot,
with density assessed separately for each group. In this example
grouping is based on the color aesthetic.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x <span class="sc">+</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">50</span>,<span class="dv">2</span>)), </span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>                     y, </span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>                     <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>   <span class="fu">stat_dens2d_filter_g</span>(<span class="at">shape =</span> <span class="dv">1</span>,</span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>                        <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>                        <span class="at">keep.fraction =</span> <span class="fl">0.25</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The stat <code>stat_dens2d_labels</code> <em>replaces</em> the values
of the label (aesthetic) variable in <code>data</code> based on density
of observations along the <em>x</em> or <em>y</em> axis in the plot
panel. The replacement is given by the argument passed to
<code>label.fill</code>, which can be a character string or a function
accepting a character string as argument and returning also a character
string.</p>
<p>The default value for <code>geom</code> is <code>&quot;text&quot;</code>. The
default value of <code>label.fill</code> is <code>&quot;&quot;</code> which
results in empty labels, while using <code>NA</code> as fill label
results in observations being omitted. Using <code>NA</code> as
<code>label.fill</code> is similar to using
<code>stat_dens2d_filter</code> as long as the geom used requires a
<code>label</code> aesthetic.</p>
<p>Label 1/10 of observations from lowest density areas of the plot
panels.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y, <span class="at">label =</span> lab, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>  <span class="fu">stat_dens2d_labels</span>(<span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>,</span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>                     <span class="at">position =</span> <span class="fu">position_nudge_center</span>(<span class="at">x =</span> <span class="fl">0.05</span>, </span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a>                                                      <span class="at">y =</span> <span class="fl">0.05</span>,</span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a>                                                      <span class="at">center_x =</span> <span class="dv">0</span>,</span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a>                                                      <span class="at">center_y =</span> <span class="dv">0</span>),</span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a>                     <span class="at">vjust =</span> <span class="st">&quot;outward&quot;</span>, <span class="at">hjust =</span> <span class="st">&quot;outward&quot;</span>) <span class="sc">+</span></span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Using the geoms from package ‘ggrepel’ avoids clashes among labels
and clashes of labels with data points. Please, see vignette
<em>Combining repulsion and nudging</em> for more examples.</p>
</div>
<div id="stat_dens1d_labels-and-stat_dens1d_filter" class="section level3">
<h3>stat_dens1d_labels() and stat_dens1d_filter()</h3>
<p>These stats are similar to <code>stat_dens2d_labels()</code> and
<code>stat_dens2d_filter()</code> but compute the density in a single
dimension, either the <em>x</em> or <em>y</em> aesthetics. A similar
warning as for 2D densities applies to 1D density estimation.</p>
<p><strong>Warning!</strong> Which observations are selected by the
algorithm used, based on <code>stats::density</code>, depends strongly
on the values of parameters <code>bw</code>, <code>adjust</code> and
<code>kernel</code>. You may need to alter the defaults by passing
explicit arguments. Beware that what are good values, may depend on
individual data sets even if they include the same number of
observations. For the selection of observations to work cleanly, the
argument for <code>n</code> must large enough to generate a dense grid
or the bandwidth may need to be increased by passing a number &gt; 1 as
argument. Increasing the bandwidth makes the empirical density function
smoother, and the selection of points less dependent on immediate
neighbours.</p>
<p>We use the same data as in the previous sections.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a>random_string <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">len =</span> <span class="dv">6</span>) {</span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">sample</span>(letters, len, <span class="at">replace =</span> <span class="cn">TRUE</span>), <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>}</span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a><span class="co"># Make random data.</span></span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1001</span>)</span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>d <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">50</span>)),</span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a>  <span class="at">lab =</span> <span class="fu">replicate</span>(<span class="dv">100</span>, { <span class="fu">random_string</span>() })</span>
<span id="cb68-12"><a href="#cb68-12" tabindex="-1"></a>)</span></code></pre></div>
<p>The stat <code>stat_dens1d_filter</code> <em>filters</em>
observations, in other words passes to the geom a subset of the data
received as input. The default value for <code>geom</code> is
<code>&quot;point&quot;</code> and the default <code>orientation</code> is
<code>&quot;x&quot;</code>.</p>
<p>Using defaults except for the color aesthetic, we highlight 1/4 of
observations from lowest density region along the <em>x</em> axis of the
plot panel.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>  <span class="fu">stat_dens1d_filter</span>(<span class="at">keep.fraction =</span> <span class="fl">0.25</span>,</span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>                     <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>We repeat the example above, we highlight 1/4 of observations, but
now from lowest density region along the <em>y</em> axis of the plot
panel.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>  <span class="fu">stat_dens1d_filter</span>(<span class="at">keep.fraction =</span> <span class="fl">0.25</span>,</span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>                     <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>                     <span class="at">orientation =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In other respects than <code>orientation</code> and the parameters
passed internally to <code>stats::density()</code> the examples given
earlier for <code>stat_dens2d_filter()</code> also apply.</p>
<p>The stat <code>stat_dens1d_labels</code> <em>replaces</em> the values
of the label (aesthetic) variable in <code>data</code> based on density
of observations along the <em>x</em> or <em>y</em> axis in the plot
panel. The replacement is given by the argument passed to
<code>label.fill</code>, which can be a character string or a function
accepting a character string as argument and returning also a character
string.</p>
<p>The default value for <code>geom</code> is <code>&quot;text&quot;</code>. The
default value of <code>label.fill</code> is <code>&quot;&quot;</code> which
results in empty labels, while using <code>NA</code> as fill label
results in observations being omitted. Using <code>NA</code> as
<code>label.fill</code> is similar to using
<code>stat_dens2d_filter</code> as long as the geom used requires a
<code>label</code> aesthetic.</p>
<p>In other respects than <code>orientation</code> and the parameters
passed internally to <code>stats::density()</code> the examples given
earlier for <code>stat_dens2d_labels()</code> also apply.</p>
</div>
</div>
<div id="simple-position-functions" class="section level2">
<h2>Simple position functions</h2>
<p>While <em>jitter</em> and <em>dodge</em> are normally use to displace
the observations being plotted to avoid overlaps and <em>stack</em> used
to construct columns or areas that represent sums and contributions to a
sum from different groups of observations, <em>nudge</em> is almost
always used to displace the position of data labels relative to
observations they are attached to, to avoid overlaps.</p>
<p>Nudging shifts deterministically the coordinates giving an <em>x</em>
and/or <em>y</em> position and also expands the limits of the
corresponding scales to match. By default in ‘ggplot2’ geometries and
position functions no nudging is applied.</p>
<p>Function <code>position_nudge()</code> from package ‘ggplot2’ simply
applies the nudge, or <em>x</em> and/or <em>y</em> shifts based directly
on the values passed to its parameters <code>x</code> and
<code>y</code>. Passing arguments to the <code>nudge_x</code> and/or
<code>nudge_y</code> parameters of a geometry has the same effect as
these values are passed to <code>position_nudge()</code>. Geometries
also have a <code>position</code> parameter to which we can pass an
expression based on a <em>position function</em> which opens the door to
more elaborate approaches to nudging.</p>
<p>A new variation on simple nudge is provided by function
<code>position_nudge_to()</code>, which accepts the desired nudged final
coordinates directly instead of as a shift.</p>
<p>We can do better than simply shifting all data to the same extent and
direction or to a fixed position. For example by nudging away from a
focal point, a line or a curve. In <code>position_nudge_center()</code>
and <code>position_nudge_line()</code> described below, this reference
alters only the direction (angle) along which nudge is applied but not
the extent of the shift. Advanced nudging works very well, but only for
some patterns of observations and may require manual adjustment of
positions, repulsion is more generally applicable but like jitter is
aleatory. Combining nudging and repulsion we can make repulsion more
predictable with little loss of its applicability.</p>
<p>These functions can be used with any geometry but if segments joining
the labels to the points are desired, layer functions
<code>geom_text_s()</code>, <code>geom_label_s()</code>, etc., from
‘ggpp’ or <code>geom_text_repel()</code> or
<code>geom_label_repel()</code> feom ‘ggrepel’ have to be used.</p>
<p>Several geometries defined in package ‘ggpp’ even if not supporting
repulsion, can plot connecting segments. Please see the documentation
for the geometries for the details. Drawing of segments or arrows is
possible if both the nudged and original <em>x</em> and <em>y</em>
coordinates are stored in <code>data</code>. Support of this feature
across packages is possible by coordinated development of ‘ggpp’ and
‘ggrepel’ and agreement on a naming convention for storing the original
position in position functions as those described next.</p>
<table style="width:100%;">
<caption>Simple position functions defined in package ‘ggpp’</caption>
<colgroup>
<col width="23%" />
<col width="23%" />
<col width="28%" />
<col width="24%" />
</colgroup>
<thead>
<tr class="header">
<th>Position</th>
<th>Main use</th>
<th>Displacement</th>
<th>Most used with</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>position_nudge_keep()</code></td>
<td>nudge</td>
<td>x, y (fixed distance)</td>
<td>data labels</td>
</tr>
<tr class="even">
<td><code>position_jitter_keep()</code></td>
<td>jitter</td>
<td>x, y (random)</td>
<td>dot plots</td>
</tr>
<tr class="odd">
<td><code>position_stack_keep()</code></td>
<td>stack</td>
<td>vertical (absolute)</td>
<td>column and bar plots</td>
</tr>
<tr class="even">
<td><code>position_stack_minmax()</code></td>
<td>stack</td>
<td>vertical (absolute)</td>
<td>error bars</td>
</tr>
<tr class="odd">
<td><code>position_fill_keep()</code></td>
<td>fill</td>
<td>vertical (relative, fractional)</td>
<td>column plots</td>
</tr>
<tr class="even">
<td><code>position_dodge_keep()</code></td>
<td>dodge</td>
<td>sideways (absolute)</td>
<td>column and bar plots</td>
</tr>
<tr class="odd">
<td><code>position_dosge2_keep()</code></td>
<td>dodge2</td>
<td>sideways (absolute)</td>
<td>box plots</td>
</tr>
<tr class="even">
<td><code>position_nudge_to()</code></td>
<td>nudge</td>
<td>x, y (fixed position)</td>
<td>data labels</td>
</tr>
<tr class="odd">
<td><code>position_nudge_center()</code></td>
<td>nudge</td>
<td>x, y (away or towards target)</td>
<td>data labels</td>
</tr>
<tr class="even">
<td><code>position_nudge_line()</code></td>
<td>nudge</td>
<td>x, y (away or towards target)</td>
<td>data labels</td>
</tr>
</tbody>
</table>
<div id="position_nudge_keep-and-friends" class="section level3">
<h3>position_nudge_keep() and friends</h3>
<p>Function <code>position_nudge_keep()</code> is like
<code>ggplot2::position_nudge()</code> but keeps (stores) the original
<em>x</em> and <em>y</em> coordinates;
<code>position_nudge_keep()</code> can be used interchangeably with
<code>ggplot2::position_nudge()</code> with other geometries. Although
possibly only occasionally needed, <code>position_jitter_keep()</code> ,
<code>position_dodge_keep()</code> and
<code>position_stack_keep()</code> are also made available for
completeness.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">84532</span>)</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">20</span>),</span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>  <span class="at">l =</span> <span class="fu">paste</span>(<span class="st">&quot;label:&quot;</span>, letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>])</span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>)</span></code></pre></div>
<p>When used together with <code>geom_text_s()</code> or
<code>geom_label_s()</code> segments between a nudged label and the
original position (here indicated by a point) are drawn.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> l)) <span class="sc">+</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>  <span class="fu">geom_text_s</span>(<span class="at">position =</span> <span class="fu">position_nudge_keep</span>(<span class="at">x =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fl">2.5</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAAAt1BMVEUAAAAAADoAAGYAOpAAZrYzMzM6AAA6ADo6AGY6kNtNTU1NTW5NTY5NbqtNjshmAABmkJBmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2OyP+QOgCQkDqQkGaQtpCQ27aQ2/+rbk2rbm6ryKur5OSr5P+2ZgC22/+2/7a2///Ijk3I///bkDrb///kq27k////tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T////s/3Y3AAAACXBIWXMAAA7DAAAOwwHHb6hkAAANmUlEQVR4nO3dC3fayAGGYWF72Zg28Xp3m8uW1InTNm6dYIfQtR3r//+uagTCXAzMDGjmG837nO4mBp2C4V3dpSlKQFgR+w0A2xAopBEopBEopBEopBEopNkG+hMQlGugHvED3ggU0ggU0ggU0ggU0ggU0ggU0ggU0ggU0ggU0gh0T5OfL5/5666nYItA90Sg7SJQd0Wx8GkRaLsI1FlRLBZq0pv0q0dOq79eFMXxTVn+eF8UR9fmqR/vT+dTjYuTWG85YQTqrFhk0rs/Oy/L0dH1pH988+P9SWn+KUfHN8tz0En/POa7ThWBOlubg/55Uz4lWP05ruaeZVXtUqAf+qcx3mzyCNTd+jrouHqodzl5MQ1zNJ25ni4GWq0EMAP1QaB7qhfxvct6DtoEatZDy+WNpP751exROCHQPZlFuklvXM1BTZDm595l89TCVPdnLOM9EOieZkFO+lWg842kqtgm2PlU5ajHriZ3BLonk95VtQb60WwUXRT1riSzm2m61F/czVR3C0cECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmkECmlJB7oynPCGp5AyAoW05AItiqe3SqDdl1qgRbFQqKlw0q8eOC3rsdrNeOxmrPaj6+Wx2mdPIUFJBtqoKrw/Oy/L0dH1pH988+P9SWn+KUfHN4sz1/7Rdf0wEpRkoM0PVYV/3kz/nPTP6z/H1dyzrKpdCvScRX6yUgt0fR10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" style="display: block; margin: auto;" /></p>
<p>We can supress the drawing of segments.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> l)) <span class="sc">+</span></span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a>  <span class="fu">geom_text_s</span>(<span class="at">position =</span> <span class="fu">position_nudge_keep</span>(<span class="at">x =</span> <span class="fl">0.1</span>), <span class="at">add.segments =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fl">2.5</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAAAt1BMVEUAAAAAADoAAGYAOpAAZrYzMzM6AAA6ADo6AGY6kNtNTU1NTW5NTY5NbqtNjshmAABmkJBmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2OyP+QOgCQkDqQkGaQtpCQ27aQ2/+rbk2rbm6ryKur5OSr5P+2ZgC22/+2/7a2///Ijk3I///bkDrb///kq27k////tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T////s/3Y3AAAACXBIWXMAAA7DAAAOwwHHb6hkAAANcklEQVR4nO3dC3fbtgGGYcp21VhborrtcumUOXG2xZsT2VG0Wo75/3/XCOpiXSwJhATgA/E+Z20SiWdi5Le8kyhKQFgRewaAXQgU0ggU0ggU0ggU0ggU0mwD/QkIqmmgDvEDzggU0ggU0ggU0ggU0ggU0ggU0ggU0ggU0ggU0gj0QOOfr5757b63YItAD0SgfhFoc0Wx9G0RqF8E2lhRLBdq0ht3q1fOq99eFsXpbVn+eF8UJzfmrR/vzxdTjYqzWLOcMAJtbCPQSf+iLIcnN+Pu6e2P92el+accnt6uLkHH3Ysos5s4Am1sI9A/b8unBKtfR9XSs6yqXQn0Q/c8xswmj0Cb29wGHVUvda7GL6ZhDuuEi/PlQKuNABagLgj0QPUqvnNVL0HngZrt0HJ1J6l7cT17FY0Q6IHMKt2kN6qWoCZI8+fO1fytpakmfdbxDgj0QLMgx90q0MVOUlXsPNjFVOWww6Gm5gj0QCa962oL9KPZKbos6kNJ5jDTdK2/fJip7hYNESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikJR3o2nDCW95CyggU0pILtCieZpVA2y+1QItiqVBT4bhbvXBe1mO1m/HYzVjtJzerY7XP3kKCUg900r8oy+HJzbh7evvj/Vlp/imHp7fLC9fuyU39MhKUeqB/3k5/HXcv6l9H1dKzrKpdCfSCVX6yUgt0cxt0VL3SuRq/mIY5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" style="display: block; margin: auto;" /></p>
<p><code>position_nudge_keep()</code> and all other position functions
described below save the original positions in <code>data</code> in
columns <code>x_orig</code> and <code>y_orig</code> and the shifted
positions in columns <code>x</code> and <code>y</code>. Because of this,
they can be used together with any ‘ggplot2’ geometry, even though these
geometries will ignore the stored original positions.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> l)) <span class="sc">+</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="fl">0.3</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="position_nudge_to" class="section level3">
<h3>position_nudge_to()</h3>
<p>Function <code>position_nudge_to()</code> nudges to a given position
instead of using the same shift for each observation. Can be used to
align labels for points that are not themselves aligned. By
left-justifying the label text we ensure the alignment of labels
differing in width.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="st">&quot;&quot;</span>, l) )) <span class="sc">+</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>  <span class="fu">geom_text_s</span>(<span class="at">position =</span> <span class="fu">position_nudge_to</span>(<span class="at">y =</span> <span class="fl">2.3</span>),</span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>              <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a>              <span class="at">angle =</span> <span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" />
This function also supports distributing the positions in the available
space, with action `“spread”.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> l)) <span class="sc">+</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>  <span class="fu">geom_text_s</span>(<span class="at">data =</span> <span class="cf">function</span>(x) {x[x<span class="sc">$</span>x <span class="sc">&gt;</span> <span class="dv">0</span>, ]},</span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_nudge_to</span>(<span class="at">x =</span> <span class="fl">2.3</span>, <span class="at">y.action =</span> <span class="st">&quot;spread&quot;</span>),</span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>              <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fl">2.7</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The space used can be expanded.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> l)) <span class="sc">+</span></span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a>  <span class="fu">geom_text_s</span>(<span class="at">data =</span> <span class="cf">function</span>(x) {x[x<span class="sc">$</span>x <span class="sc">&gt;</span> <span class="dv">0</span>, ]},</span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_nudge_to</span>(<span class="at">x =</span> <span class="fl">2.3</span>, </span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a>                                           <span class="at">y.action =</span> <span class="st">&quot;spread&quot;</span>,</span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a>                                           <span class="at">y.expansion =</span> <span class="fl">0.1</span>),</span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a>              <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb77-10"><a href="#cb77-10" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fl">2.7</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The range can be also set manually.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> l)) <span class="sc">+</span></span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>  <span class="fu">geom_text_s</span>(<span class="at">data =</span> <span class="cf">function</span>(x) {x[x<span class="sc">$</span>x <span class="sc">&gt;</span> <span class="dv">0</span>, ]},</span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_nudge_to</span>(<span class="at">x =</span> <span class="fl">2.3</span>, </span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a>                                           <span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="dv">5</span>),</span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>                                           <span class="at">y.action =</span> <span class="st">&quot;spread&quot;</span>),</span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb78-8"><a href="#cb78-8" tabindex="-1"></a>              <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.015</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb78-9"><a href="#cb78-9" tabindex="-1"></a>              <span class="at">vjust =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb78-10"><a href="#cb78-10" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fl">2.7</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="position_nudge_center" class="section level3">
<h3>position_nudge_center()</h3>
<p>Function <code>position_nudge_center()</code> can nudge radially away
from a focal point if both <code>x</code> and <code>y</code> are passed
as arguments, or towards opposite sides of a boundary vertical or
horizontal <em>virtual</em> line if only one of <code>x</code> or
<code>y</code> is passed an argument. By default, the “center” is the
centroid computed using <code>mean()</code>, but other functions or
numeric values can be passed to override it. When data are sparse, such
nudging may be effective in avoiding label overlaps, and achieving a
visually pleasing positioning.</p>
<p>In all cases nudging shifts the coordinates giving an <em>x</em>
and/or <em>y</em> position and also expands the limits of the
corresponding scales to include the nudged coordinate values.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> l)) <span class="sc">+</span></span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>  <span class="fu">geom_text_s</span>(<span class="at">position =</span> </span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>                    <span class="fu">position_nudge_center</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">center_x =</span> <span class="dv">0</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>By default, split is away or towards the <code>mean()</code>. Here we
allow repulsion to separate the labels (compare with previous plot).</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> l)) <span class="sc">+</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>  <span class="fu">geom_text_s</span>(<span class="at">position =</span> <span class="fu">position_nudge_center</span>(<span class="at">x =</span> <span class="fl">0.1</span>, <span class="at">direction =</span> <span class="st">&quot;split&quot;</span>)) <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>We set a different split point as a constant value.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> l)) <span class="sc">+</span></span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a>  <span class="fu">geom_text_s</span>(<span class="at">position =</span> </span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a>                <span class="fu">position_nudge_center</span>(<span class="at">x =</span> <span class="fl">0.1</span>, </span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a>                                      <span class="at">center_x =</span> <span class="dv">1</span>, </span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a>                                      <span class="at">direction =</span> <span class="st">&quot;split&quot;</span>)) <span class="sc">+</span></span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAAArlBMVEUAAAAAADoAAGYAOpAAZrYzMzM6AAA6ADo6AGY6kNtNTU1NbqtNjshmAABmkJBmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2OyP+QOgCQkDqQkGaQtpCQ27aQ2/+rbk2rbm6r5OSr5P+2ZgC22/+2/7a2///Ijk3I///bkDrb///kq27k////tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///8MtQm6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAANyElEQVR4nO3dC3vayBmGYWF72ZjEdXabw9apE6eNWyfYITTGsf7/H6tGIEBgzCfBoHdmnvvqbmIsd7XsEx1Gg5TlgLCs6xUAnkOgkEagkEagkEagkEagkGYN9DfgoJoG2iJ+oDUChTQChTQChTQChTQChTQChTQChTQChTQChTQCrRn/fvXEb7d9C/4QaA2BqiHQmnaBZhmTwXwh0BqX3rhfBHda/PYyy45v8/zXhyw7unHf+vXhdL7UKDupfijLKNQbAq0p0pucnef58Ohm3D++/fXhJHd/5cPj2/oWdNwvlpqmmRGoRwRaU6T38zZfJFj8Oiq2nnlRbS3Qj/3TxQ8RqEcEWlNWOCp6612NX0zDHE63kKfLgRYHAedLP0Wf/hBoTbmL712VW9AqUHccmtdPkvrn17NX4RmB1rhduktvVGxBXZDu695V9a2lpSZnpxv/T7BHBFozC3LcLwKdnyQVxVbBzpfKhz3GQg+BQGtcetfFEegnd1J0mZVDSW6YabrXXx5mKruFdwQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaQQKaSEEuvKc4Q3fQpQIFNLiDTTLrP9OEBZKoON+EdxpXj7E3T2o3T3E/eim/hD32bemsoxCYxBIoJOz8zwfHt2M+8e3vz6c5O6vfHh8u7xx7R/dlC9P2yTQOAQS6M/b6a/j/nn566jYeuZFtbVAz5d3+QQah0ACzfNR0VvvavxiGuZwuoU8XT08Lbe0U/QZhUACnZz1rsotaBXo7GDzmUARhUACHbkgR8UW1FXovu5dVd+aL1Xu4l3AiEgogboNaL8IdH6SVBRbBTtban6ShIgEEmh+XRyBfnInRZdZ5iJ0w0zTvX5tmIk+YxNCoDYrY/ZcfooDgUIagdYxOCUmnkBX2K6PVi9VGN5XE3Oghuuj1UvL10cJVEnMgRquj1YvVV8TqJqYAzVcH61emv8YfYqJOVDD9dHhYn4eJMUcqOH6aPUSVEUd6Pbro9VLXa4pnhNzoIbro9VLUBVtoIgDgUKaKdDHzxerywMHYQr0bkCg6IYl0Pu//4NAfWLm1WaGQB//9e/pLv435wDrlBwC3cwQ6N1bjkH94tYpm20P9P7NdwL1yzg1cHKW9T6m9sH/7YHeDZy3K8tjj2xTAydnJ3k5vSCpmYH7H2ay7a+SP7Za1mBq4OKyLIEuEKhfxqmBbs+/9HUSfXq4ktQu0DTe7Q0aTA1M7g+2n0CNN0vMmMleMk4NrO/iE+ElUNPNEov/IkP3lqd0xL+BdWrg7CQpKV4C5WaJzTSYGvg3dvG25TdrcLPE5I74d8cxqHH5zRrcLDG5d3t3yb1lXgK13CyRQFtJ7i3zE6jhZokECgs/x6CWmyUSKAz4yAekESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikEejuVh+g9/S30AqB7o5APSLQ3bULlAeQmxDo7lyF434R3GlePp3UPevZPZ306Gb56aTTRc6rH8oyCrUg0N0VFU7OivKGRzeL5zufFF8f364937l/Pk0zI1AbAt1dkd7P2+mvLsDygeTF1jOfuOc9LwJ9cbP8QwRqQ6C7KyscZe6J42WFRZjD6RbydPkY9Hr6aPIKfZoQ6O7KXXzvqtyCVoG649B89SRpcuaOS9EEge7O7dJdkKNiC1oeaBZf966qb9UWLY9V0QCB7m4W5LhfBDo/SSqKrYKdKg9LGRdtikB356orDjB7n9xJ0eX0SNMNM033+vNhpulRaqdrGiAChTQChTQC3RVX4r0i0F0RqFdPBVoO6m1ZHpU2gTJIb/b0FvR6OuPhmeVRsU0V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" style="display: block; margin: auto;" /></p>
<p>We set a different split point as the value computed by a function
function, by name.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> l)) <span class="sc">+</span></span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>  <span class="fu">geom_text_s</span>(<span class="at">position =</span> <span class="fu">position_nudge_center</span>(<span class="at">x =</span> <span class="fl">0.1</span>, </span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>                                               <span class="at">center_x =</span> median, </span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a>                                               <span class="at">direction =</span> <span class="st">&quot;split&quot;</span>)) <span class="sc">+</span></span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>We set a different split point as the value computed by an anonymous
function. Here we split on the first quartile along <em>x</em>.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> l)) <span class="sc">+</span></span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a>  <span class="fu">geom_text_s</span>(<span class="at">position =</span> </span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a>                    <span class="fu">position_nudge_center</span>(<span class="at">x =</span> <span class="fl">0.1</span>,</span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a>                                          <span class="at">center_x =</span> <span class="cf">function</span>(x) {</span>
<span id="cb83-6"><a href="#cb83-6" tabindex="-1"></a>                                            <span class="fu">quantile</span>(x, </span>
<span id="cb83-7"><a href="#cb83-7" tabindex="-1"></a>                                                     <span class="at">probs =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, </span>
<span id="cb83-8"><a href="#cb83-8" tabindex="-1"></a>                                                     <span class="at">names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb83-9"><a href="#cb83-9" tabindex="-1"></a>                                          },</span>
<span id="cb83-10"><a href="#cb83-10" tabindex="-1"></a>                                          <span class="at">direction =</span> <span class="st">&quot;split&quot;</span>)) <span class="sc">+</span></span>
<span id="cb83-11"><a href="#cb83-11" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="position_nudge_line" class="section level3">
<h3>position_nudge_line()</h3>
<p>Function <code>position_nudge_line()</code> nudges away from a line,
which can be a user supplied straight line as well as a smooth spline or
a polynomial fitted to the observations themselves. The nudging is away
and perpendicular to the local slope of the straight or curved line. It
relies on the same assumptions as linear regression, assuming that
<em>x</em> values are not subject to error. This in most cases prevents
labels from overlaping a curve fitted to the data, even if not exactly
based on the same model fit. When observations are sparse, this may be
enough to obtain a nice arrangement of data labels.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">16532</span>)</span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">-</span><span class="dv">10</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a>  <span class="at">y =</span> (<span class="sc">-</span><span class="dv">10</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a>  <span class="at">yy =</span> (<span class="sc">-</span><span class="dv">10</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">21</span>, <span class="dv">0</span>, <span class="dv">4</span>),</span>
<span id="cb84-6"><a href="#cb84-6" tabindex="-1"></a>  <span class="at">yyy =</span> (<span class="sc">-</span><span class="dv">10</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">21</span>, <span class="dv">0</span>, <span class="dv">4</span>),</span>
<span id="cb84-7"><a href="#cb84-7" tabindex="-1"></a>  <span class="at">l =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>]</span>
<span id="cb84-8"><a href="#cb84-8" tabindex="-1"></a>)</span></code></pre></div>
<p>The first, simple example shows that
<code>position_nudge_line()</code> has shifted the direction of the
nudging based on the alignment of the observations along a line. One
could, of course, have in this case passed suitable values as arguments
to <em>x</em> and <em>y</em> using <code>position_nudge()</code> from
package ‘ggplot2’. However, <code>position_nudge_line()</code> will work
without change irrespective of the slope or intercept along which the
observations fall.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, <span class="dv">2</span> <span class="sc">*</span> x, <span class="at">label =</span> l)) <span class="sc">+</span></span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">2</span>, <span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">position =</span> <span class="fu">position_nudge_line</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.8</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>With observations with high variation in <em>y</em>, a linear model
fit may need to be used. In this case fitted twice, once in
<code>stat_smooth()</code> and once in
<code>position_nudge_line()</code>.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(df, x <span class="sc">&gt;=</span> <span class="dv">0</span>), <span class="fu">aes</span>(x, yyy)) <span class="sc">+</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> l),</span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="st">&quot;center&quot;</span>, <span class="at">hjust =</span> <span class="st">&quot;center&quot;</span>,</span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge_line</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">1.2</span>,</span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a>                                           <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a>                                           <span class="at">direction =</span> <span class="st">&quot;split&quot;</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAAA9lBMVEUAAAAAADEAADoAAFYAAGYAMXkAOpAAVpkAZrYxAAAxADExebgzMzMzZv86AAA6ADo6AGY6kNs9PT1NTU1NTW5NTY5NbqtNjshWAABWmdZmAABmADpmkJBmtrZmtv9uTU1uTW5uTY5ubqtuq+R5MQB5mXl5uNaOTU2OTW6OTY6OyP+QOgCQkDqQkGaQtpCQ2/+ZVgCZuNaZ1tarbk2rbm6rbo6ryKur5P+2ZgC2/7a2//+4eTG41tbIjk3I///WmVbWuHnWuJnW1pnW1rjW1tbbkDrb///kq27k////tmb/yI7/25D/5Kv//7b//8j//9v//+T///9AdKyaAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQTUlEQVR4nO3dC3sbxRWA4YUGkhBywUoc4rYpITSBpIW2AZwG7LiwIY5lO9b//zP1SLItK6vR7NzOmdnvfcqDKV48ly8raSVLzQRQrJEeAGBDoFCNQKEagUI1AoVqBArVegb6OZCHZ6D9vh3wRKBQjUChGoFCNQKFagQK1QgUqhEoVCNQqEagUI1AoRqBQjUChWoECtUIFKoRKIS1re3fEihEtS2BQqt2xvYtBAopbUugUKttCRRatZfYvpNAkV9LoNCrXWb7ZgJFXh/kSaDQoyNPAoUWnXkSKHRYkSeBQoGVdRIo5NnyJFAIs+dJoJC0rk4ChSCHPAkUQpzqJFCIcK2TQCGhR58Eitz65EmgyKxfngSKrPrmSaDIqH+eBIpsfPIkUOThV2eMQA8f7U4mb0ej0b3dpcOg1vjOP5orr/L9PO88wwM9mIa586zjMKg1vnUt408LyDM40J27P5+eQU9+3O44DGqNbz3M9aOC6oxwBp3exB8/Pb2Jn55EFz/iE2qNb/+Q5weF5hkp0MOvthfOogSqXqZAw/OM9SDJOL8fSqDq5Qg0Rp0EOlDpA42UZ6RADzb3Jyc/cZmpGKkDjZZnxOugd88fyBPosHV29r9/SwW6+jAMUXdme589IVDIW5UZgULe6sr2rjfNDQKFu6bpuatrWTPjDIpemiZyoWsyI1D0EjfQ9ZkRKHqJGahLZgSKfqL16ZYZgUKCc2a/ffmAQJFZn87+1VwlUGTklxuBIodcdRIoPGTMk0DRV9Y8CRS9ZK6TQNFHQGcbGxsEiqQC8jR9ehZqGxGB4kxInQSKxALzJFCkFJxny31QpBKjzhC2sRHo4EnnSaCwkI7TsI2PQIdMusw52xAJdLikuzxnGySBDpV0lQtswyTQQZJO8jLbSAl0gKSDXGYbK4EOjnSOH7KNlkCHRbrFTrYBE+iQSJe4gm3IBDoc0h2uZBs0gQ6EdIQ2tnET6CBIJ2hnGzmB1k+6v7VsgyfQyknH58I2fgKtmnR6bmwzINA8xrf/2TSf/pH3h0qH58o2BwLNY3zryqv3z4v5/OG8bNMg0Dymnz2c7fNdS6qzJVANpm0ebeX4hGzp3Hq6efOmbTYEmke2QKV76+XmjG0+BJrH7Cb+zqvEP0a6uD7mdbbcxGuQ40GSdHE9XMRp2CZFoHlMLzMl7VM0uF4u19m2G7YPeyDQPAr6cOykluNszRuS2D6OhEDzSBqoVG19ddTZEqgO6QIVSa2/7jgNAq1X9sw8ra7T4D6oDtE/fDhrY97scU7ZJkmgucT+8OFcgfm6uWDNt9qmSaC5RA00S2IB3OM0bDMl0FziBZo8rzDuYZ6xTZZAs4nSZ7KsIulfZ0ug9UgTVSxecRq2KRNoOeInFZF3nW2EQA8f7U4mx09Hm/vLhyGXyD1FFRKnYZu3S6AHo3u7k5MXzyZv7y8fhhwithRfaJ1tcKA7d38+PYMef7c7O5NeOgypxeooiQhx7n32pLU9Eex8E3/49f7k+Nttc4gRcw+wUqySUohQZxsx0IPNs0AXD0NKUTpKIk6cRoIz6OJhSCbC5icSr842YqDcB80pzuYnEDVOI1qgJy8e8yg+i3ibH1v0OtuIgXIdNIuomx9TijiN37680b5//nFYoKsPQ0TRNz+aVHUae9eb5q9/JlDtkmx+DCnjnLOtC4EqkHLzvfV4wXEo29oQqLTEm+8nX5yGbXkIVFKGze8vX5hnbEtEoGIyFuAuf50tgSqUNwBHInEatpUi0PzyF+BArM6WQDURCWAdyTgN24IRaEZiBdhI19kSqAqSAaykIE7Dtm4EmoF0AN2U1NkSqCjpze+mJ07Dtn4EmpL0znfTVWdLoDKkd72bujgN2zISaHTS272ayjpbAs1Jeq9X0hqnYVtQAo1Hep9XyvjCJC+2RSXQSKQ3eRXtcRq2dSXQCKQ3eKUC4jRsa0ugIaR31qaQOA3bEhOoN+ltXSXvq+FjsK0ygXqR3tKViovTsK00gfYjvZc25ZU5Z1twAnUkvYnrFFtnS6DBpDdwnZLjNGxrT6BrSG/eWqXX2RKoH+ldc1FBnIZtGwj0A9Lb5aqSOlsCdSW9Tz3UE6dh2xQCnRRVplFXnS2Bria9M/1VF6dh26KBBiq9JX6qrLMl0EXSe+Gt1jgN24YNJlDpTQhR4NPrvdj2rfpApRc/VO1xGrb9qzdQ6VWPYQBxGrZtrDBQ6eWOZCBxGrbdrClQ6XWOpLwXHIeybWpXoEdbqz+2ZukwYdIrG9/g4jRsW9x9Bn3ZNJ/+4XKYFOklTWJ4Zc7ZdnrVTfzRVtN8sf6wbKTXMLnB1tn63gd9/7xprrxac1h60ouXw5DjNGz7vyrQN01z7fSmftUNfcpApZcrs6HX2XoEak6eD80X71adQpMEKr1O+RHnlC2K7kfxK2/alw8LJL0yoqjzjEtpua6DSq+FEsS5yKW01NdBpddAE+pc0jfQONdBpWetE3F26B9o0HVQ6ek62fvs79eb5kHeH0qd3XwCDbgOKj1dJ3vXP/m1/eVP/8n2A4lzNZ9AA66DSk/Xyd71B+Y0+iTLDxvg0+u99A407Dqo9HSdTNvMEShxdrEluT7QwOug0pN3kidQ4jznnuT6QHscRqArDT1O3yJXlBbxOqj0yjhJHOiQ6wwLclVpEa+DSi+Qk4SBDi/OwAat3K+Dvh2NRvd2lw7rIr1cYvhdjQTcr4PuPOs4rIv0qskYSJwxmuvF+TroyY/bHYd1kV7D/CgzHefroMdPT2/ipyfRzw3Lf1J6KTOrtc7YpXlyvg56+NX2wlm0hkA3NjZC/xNVxhmprEj6XQc9vx9aQaAbG4GFVldnSEfJFB3o7CVJN/a8XpcUFGhdcYYElJpzoAeb+5OTn3RdZpq9JKnxe12Sf6CZ64xwV2SV4HzScz+Dvh2N7p4/kNcS6IOA1yV5bXz+U2fwXZFLAnPJr+jn4i+eDsrzwjmRG/ZIgfoGIo1AHYnd6wwM1DcMLQjUgexzRJ59+hahDIGuUd4TmL4p6ESgNsXFWVmdk8IDTYo4VSDQTmXV6bv5JSDQDxQUp++uF4RALxT0gmPf7S6PmkD9H+bEeaKlkDh997lY5Qca4ZmWEso0fDe5ZARaSJ2+G1y6YQdaQJxHW83H399e92vg9So/UO/7oAXUaX674ZrL+xTUq4JAfRQRpzH9rbB3BDqoQJXXeWkx35jfqx1zEz+YQJXH+cFjIQKd/30QgSqvs2sxuYmf/736QDXHaVnM9895kDRVdaCqnyNas9LmTTT+wk28fKCplBznGe6D1hqo5jh7PDdEoDUGWkmcBoFWF2jKOoNfm+K7V4OkJ9Bob0+Q+NQZ9uIU330aLDWBRnp/gvQ37AED9d2kIasp0Dz3Oj0H6rtBQ1dFoHl/V6PfOH03BjNqAg191ZzOB+y+24IzegL1obfMKd9NwYWCA6XOISg0UOVxUmc0JQaqvE7frUCX0gJVHid1xlZSoIofrU/57gEsSglUe5zUmUgRgRLncKkPVFucv3/TNFcX/w/flYcT3YFqq9P0eXX614zvqsOZ3kD1xWm8Np8Y9nr2sWG+a44elAaqs85Trz/5df4Lfr4rjl4UBqo2TmMe6HB/BSM3bYGqrvPU64+etLN3U0AWmgLVHqdh3kjB/IVMVASa9wXH/szszBsp0Gc+8oEWFCfykw20hDKnfJcXoQQDpU6sJxRoMXFSpzCJQKkTznIHSpzoJWegRTxan/NdT0SWK9CS4iRPRbIEWlSc1KlK8kDLipM8tUkbaGl1kqc67oEePx1t7i8f1mW+18XFSZ0aOQd68uLZ5O395cO6mL2mTsThHOjxd7uTw0e7S4d1IU7E4xzo4df7k+Nvt80hhuU7C6uTPFVzDvRg8yzQxcO6SAfXT/AK1qdpej5kTsnjDLp4WBfp5HoIXr4aNY2mQhPcB5Wuzlnw4tWp0EBPXjzu8Si+AKErV61CA+19HVS1wFWrm6Y+FfxOkgDfxUJ+AwzUd6kgYWiB+q4ThAwrUN9VgpghBeq7RhA0mEB9FwiyBhGo7+JAXvWB+i4MdKg8UN9lgRZVB+q7KIM2vtU0zUPpUZyrN1DfFRm48e0fTKRqCq01UN/1GLzxHV3vHl1noL6rgcnkpa436K0wUN+lwNzRVqPnTfirC9R3IbDgaIv7oOSp0/QTTKaPlHSoKVDfNcCid03TfKymz4oC9V0BqFZLoL7zh3JVBOo7eehXQaC+U0cJig/Ud+IoQ9mB+s4axSg5UN85oyDlBuo7YxSl0EB9p4vSFBmo72RRngID9Z0qSlRaoL7zRKHKCtR3lihWSYH6zhEFKydQ3xmiaKUE6js/FK6MQH1nh+KVEKjv3FAB9YH6Tgx1UB6o77RQC9WB+k4K9dAbqO+MUBWtgfrOB5XRGajvbFCd+IE2GxvUiViiB9qcBhpSqP9UUCNlgfpPBHXSFKj/LFAtPfdBvaeAmml5FO87flRORaC+g0f9FATqO3QMgXigvgPHMMgG6jtqDIZooL6DxnBEDtS8+z55Ih6xQEMGjeEQCjRkyBiSBIG+bq6SJyJxD/TtaDS6t7t02LLTQMfXH5AnYnEPdOdZx2HLxre/v3WDOhGNc6AnP253HLZsfKtpLCfQ4OFiaJwDPX56ehM/PYl+bqz4rvGthy8/+ZU6EYtzoIdfbS+cRS33QY++7LqNjzJYDI9ToDuj0f3ZF2f3Q22P4n/56Al5IpJ+l5mcAv39m6Ub+dAxYsCcAz3Y3J+c/LTuMpPByRPx9LoOevf8gbxzoIHDw9ClfTWT76iAuZSB+o4JOJcuUN8RAQtSBeo7HuCSNIH6jgZYkiBQIB4ChWoECtUIFKoRKFQjUKhGoFCNQKEagUI1AoVqBArVCBSqEShUI1CoRqBQzTdQIA+/QF2aV0HTYDSNRdVgXMZCoOlpGouqwRCoDprGomowmQMF4iNQqEagUI1AoRqBQrUIgR4/HW3uL30l5vBv8zcsv/zpJCIuRiC/MGYs85URX5jDR7vu1YQHevLi2eTt/ctfiTn+dnv6puWTpU8nEXE+AgULYxzMOpBemAPzx8O5mvBAj7/bnf2ZWPhKzIGZ6XQHLn86iYSLEShYmMnsD+9EfmF27v58uhTO1YQHevj1/nzuF1+Jmg3h4tNJxMZxPgIdCzM/TckvjMnRuZrwQM0Nx+wHXHwl6eTFY/O3y59OIuFiBCoW5mwAChbmNFDnaqo7gx4/fXzxD9J3t+YjULEwB4uPREQXJvMZVNV90NNH8YtLryRQDQsz2Xm8+A/SgWa8D2puUs8ejz2WfrB60eflTyeRcDECBQtzcasuvzAmR+dqol0Hnf6x0HK5zwzm0qeTSA3mdAQ6Fubs9lTDwixcB12/ODyTBNUIFKoRKFQjUKhGoFCNQKEagUI1AoVqBArVCDStNx//MDna+kJ6GOUi0MReXjP/gy8CTWx8+/s7r6QHUTACTe1N81B6CCUj0NReNtzCByDQxN5d+e8Wp1B/BJrW0Wmd765wJ9Qbgab18tM/Ju+fcyPvjUChGoFCNQKFagQK1QgUqhEoVCNQqEagUI1AoRqBQrX/A4eXAuQC12QvAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<p>With lower variation in <em>y</em>, we can pass to
<code>line_nudge</code> a multiplier to keep labels outside of the
confidence band.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(df, x <span class="sc">&gt;=</span> <span class="dv">0</span>), <span class="fu">aes</span>(y, yy)) <span class="sc">+</span></span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> l),</span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge_line</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a>                                           <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">3</span>, </span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a>                                           <span class="at">line_nudge =</span> <span class="fl">2.5</span>,</span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a>                                           <span class="at">direction =</span> <span class="st">&quot;split&quot;</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>If we want the nudging based on an arbitrary straight line not
computed from <code>data</code>, we can pass the intercept and slope in
a numeric vector of length two as an argument to parameter
<code>abline</code>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">subset</span>(df, x <span class="sc">&gt;=</span> <span class="dv">0</span>), <span class="fu">aes</span>(y, yy)) <span class="sc">+</span></span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> l),</span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge_line</span>(<span class="at">abline =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a>                                           <span class="at">x =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="dv">3</span>, </span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a>                                           <span class="at">direction =</span> <span class="st">&quot;split&quot;</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>With observations that follow exactly a simple curve the defaults
work well to automate the nudging of individual data labels away from
the implicit curve. Positive values as arguments to <code>x</code> and
<code>y</code> correspond to above and inside the curve. One could, of
course, pass also in this case suitable values as arguments to
<em>x</em> and <em>y</em> using <code>position_nudge()</code> from
package ‘ggplot2’, but these arguments would need to be vectors with
different <em>nudge</em> values for each observation.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> l)) <span class="sc">+</span></span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">position =</span> <span class="fu">position_nudge_line</span>(<span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="dv">6</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Negative values passed as arguments to <code>x</code> and
<code>y</code> correspond to labels below and outside the curve.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y, <span class="at">label =</span> l)) <span class="sc">+</span></span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">position =</span> <span class="fu">position_nudge_line</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.6</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">6</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>When the observations include random variation along <em>y</em>, it
is important that the smoother used for the line added to a plot and
that passed to <code>position_nudge_line()</code> are similar. By
default <code>stat_smooth()</code> uses <code>&quot;loess&quot;</code> and
<code>position_nudge_line()</code> with method <code>&quot;spline&quot;</code>,
<code>smooth.sline()</code>, which are a good enough match.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, yy)) <span class="sc">+</span></span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> l),</span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge_line</span>(<span class="at">x =</span> <span class="fl">0.6</span>, </span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a>                                           <span class="at">y =</span> <span class="dv">6</span>,</span>
<span id="cb91-7"><a href="#cb91-7" tabindex="-1"></a>                                           <span class="at">direction =</span> <span class="st">&quot;split&quot;</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>We can use other geometries.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, yy)) <span class="sc">+</span></span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a>  <span class="fu">geom_label_s</span>(<span class="fu">aes</span>(<span class="at">label =</span> l),</span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a>                   <span class="at">position =</span> <span class="fu">position_nudge_line</span>(<span class="at">x =</span> <span class="fl">0.4</span>, </span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a>                                                  <span class="at">y =</span> <span class="dv">4</span>,</span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a>                                                  <span class="at">direction =</span> <span class="st">&quot;split&quot;</span>)) <span class="sc">+</span></span>
<span id="cb92-8"><a href="#cb92-8" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="sc">-</span><span class="dv">12</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>When fitting a polynomial, <code>&quot;lm&quot;</code> should be the argument
passed to <code>method</code> and a model formula preferably based on
<code>poly()</code>, setting <code>raw = TRUE</code>, as argument to
<code>formula</code>. <em>Currently no other methods are implemented
in</em> <code>position_nudge_line()</code>.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, yy)) <span class="sc">+</span></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a>  <span class="fu">geom_text_s</span>(<span class="fu">aes</span>(<span class="at">label =</span> l),</span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a>              <span class="at">position =</span> <span class="fu">position_nudge_line</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a>                                             <span class="at">x =</span> <span class="fl">0.5</span>, </span>
<span id="cb93-7"><a href="#cb93-7" tabindex="-1"></a>                                             <span class="at">y =</span> <span class="dv">5</span>,</span>
<span id="cb93-8"><a href="#cb93-8" tabindex="-1"></a>                                             <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>),</span>
<span id="cb93-9"><a href="#cb93-9" tabindex="-1"></a>                                             <span class="at">direction =</span> <span class="st">&quot;split&quot;</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="combined-position-functions" class="section level2">
<h2>Combined position functions</h2>
<p>As mentioned above, while <em>jitter</em> and <em>dodge</em> are
normally use to displace the observations being plotted to avoid
overlaps and <em>stack</em> used to construct columns or areas that
represent sums and contributions to a sum from different groups of
observations, <em>nudge</em> is almost always used to displace the
position of data labels relative to observations they are attached to,
to avoid overlaps. Because <em>nudge</em> plays in most cases a
different role than <em>jitter</em>, <em>dodge</em>, and <em>stack</em>,
rather frequently it is useful to combine <em>nudge</em> with the other
position displacements. Additional examples for this use case are given
in the <code>vignette(&quot;Combining repulsion and nudging&quot;)</code>.</p>
<p>Nudging text or labels in a dodged or stacked bar or column plot has
not been easy in ‘ggplot2’. This is a rather frequent situation.
However, within ‘ggplot2’ and the Grammar of Graphics this imposed some
limitations on the design of plots and the need to use workarounds to
modify the data before plotting.</p>
<p>Package ‘ggpp’ implements <em>position</em> functions that implement
the functionality of more than one of the position functions available
in ‘ggplot2’. The examples below demonstrate their use.</p>
<table style="width:100%;">
<caption>Combined position functions defined in package ‘ggpp’</caption>
<colgroup>
<col width="23%" />
<col width="23%" />
<col width="28%" />
<col width="24%" />
</colgroup>
<thead>
<tr class="header">
<th>Position</th>
<th>Main use</th>
<th>Displacement</th>
<th>Most used with</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>position_stacknudge()</code></td>
<td>stack + nudge</td>
<td>combined, see above</td>
<td>data labels in column plots</td>
</tr>
<tr class="even">
<td><code>position_fillnudge()</code></td>
<td>fill + nudge</td>
<td>combined, see above</td>
<td>data labels in column plots</td>
</tr>
<tr class="odd">
<td><code>position_jitternudge()</code></td>
<td>jitter + nudge</td>
<td>combined, see above</td>
<td>data labels in dot plots</td>
</tr>
<tr class="even">
<td><code>position_dodgenudge()</code></td>
<td>dodge + nudge</td>
<td>combined, see above</td>
<td>data labels in column plots</td>
</tr>
<tr class="odd">
<td><code>position_dodge2nudge()</code></td>
<td>dodge2 + nudge</td>
<td>combined, see above</td>
<td>data labels in box plots</td>
</tr>
</tbody>
</table>
<p><strong>In all cases when labelling points or columns, to achieve the
correct alignment, the arguments passed to the equivalent position
functions used for observations and text must be the same, except for
<code>x</code> and <code>y</code> which determine amount of nudging to
be added to the other dispalcements.</strong></p>
<p>All the position functions described in this section are compatible
with most geometries from <code>ggpplot2</code> and extensions. However,
only those from packages ‘ggpp’ and ‘ggrepel’ (&gt; 0.9.1) plot segments
and arrows linking original and displaced positions using the saved
original positions as “kept”, or saved, by these position functions.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a> df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a>                  <span class="at">x2 =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;b&quot;</span>),</span>
<span id="cb94-3"><a href="#cb94-3" tabindex="-1"></a>                  <span class="at">grp =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>))</span></code></pre></div>
<div id="position_dodgenudge" class="section level3">
<h3>position_dodgenudge()</h3>
<p>When labelling dodged columns, we can in addition apply nudging. Here
we add a label just outside the tip of each horizontal bar. With
<code>direction = &quot;split&quot;</code> we ensure that the text is correctly
located in the <em>negative</em> columns.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(x1, x2, <span class="at">group =</span> grp)) <span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>   <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> grp), <span class="at">width =</span> <span class="fl">0.8</span>,</span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>   <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>   <span class="fu">geom_text</span>(</span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a>     <span class="fu">aes</span>(<span class="at">label =</span> grp),</span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a>     <span class="at">position =</span> <span class="fu">position_dodgenudge</span>(<span class="at">x =</span> <span class="fl">0.09</span>, <span class="at">direction =</span> <span class="st">&quot;split&quot;</span>, <span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(x2, x1, <span class="at">group =</span> grp)) <span class="sc">+</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>   <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> grp), <span class="at">width =</span> <span class="fl">0.75</span>,</span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>   <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> grp),</span>
<span id="cb96-6"><a href="#cb96-6" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_dodgenudge</span>(<span class="at">y =</span> <span class="fl">0.1</span>,</span>
<span id="cb96-7"><a href="#cb96-7" tabindex="-1"></a>                                            <span class="at">direction =</span> <span class="st">&quot;split&quot;</span>,</span>
<span id="cb96-8"><a href="#cb96-8" tabindex="-1"></a>                                            <span class="at">width =</span> <span class="fl">0.75</span>),</span>
<span id="cb96-9"><a href="#cb96-9" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb96-10"><a href="#cb96-10" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="position_stacknudge" class="section level3">
<h3>position_stacknudge()</h3>
<p>With horizontally stacked bar we add labels above each bar, at their
horizontal center with <code>vjust = 0.5</code>. (As with text, the
justification is relative, with vertical always meaning along the
direction representing continuous data values or counts.)</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a> <span class="fu">ggplot</span>(<span class="at">data =</span> df, <span class="fu">aes</span>(x1, x2, <span class="at">group =</span> grp)) <span class="sc">+</span></span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a>   <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> grp), <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a>   <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a>   <span class="fu">geom_text</span>(</span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a>     <span class="fu">aes</span>(<span class="at">label =</span> grp),</span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a>     <span class="at">position =</span> <span class="fu">position_stacknudge</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="fl">0.33</span>)) <span class="sc">+</span></span>
<span id="cb97-7"><a href="#cb97-7" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="position_fillnudge" class="section level3">
<h3>position_fillnudge()</h3>
<p>Here we nudge the labels down from the top of each stacked bar with
<code>vjust = 1</code>.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a> <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">subset</span>(df, x1 <span class="sc">&gt;=</span> <span class="dv">0</span>), <span class="fu">aes</span>(x2, x1, <span class="at">group =</span> grp)) <span class="sc">+</span></span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>   <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill =</span> grp), <span class="at">width=</span><span class="fl">0.5</span>, <span class="at">position =</span> <span class="fu">position_fill</span>()) <span class="sc">+</span></span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a>   <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a>   <span class="fu">geom_text</span>(</span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>     <span class="fu">aes</span>(<span class="at">label =</span> grp),</span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>     <span class="at">position =</span> <span class="fu">position_fillnudge</span>(<span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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pb50loJPPS/Qn/zPSxwAk85S6KW+dJaCTz0v0Gd335o//uuHX/jHf/oBMOkshV7qS2cp+NRzL/Gfrc1ukz7/1o0Gega91JfOUvCp578HfXb3td9du3mpA2DSWQq91JfOUvCpP+Um6fNvrb11uQNg0lkKvdSXzlLwqecH+mTt5vwyf4kDYNJZCr3Ul85S8Knn3yS99t7wa9+DnkUv9aWzFHzquYH+6dFj7+LPopf60lkKPrUf1Pvopb50loJPbaA+eqkvnaXgUxuoj17qS2cp+NQG6qOX+tJZCj61gfropb50loJPbaA+eqkvnaXgUxuoj17qS2cp+NQG6qOX+tJZCj61gfropb50loJPbaA+eqkvnaXgUxuoj17qS2cp+NQG6qOX+tJZCj61gfropb50loJPbaA+eqkvnaXgUxuoj17qS2cp+NQG6qOX+tJZCj61gfropb50loJPbaA+eqkvnaXgUxuoj17qS2cp+NQG6qOX+tJZCj61gfropb50loJPbaA+eqkvnaXgUxuoj17qS2cp+NQG6qOX+tJZCj61gfropb50loJPbaA+eqkvnaXgUxuoj17qS2cp+NQG6qOX+tJZCj61gfropb50loJPbaA+eqkvnaXgUxuoj17qS2cp+NQG6qOX+tJZCj61gfropb50loJPbaA+eqkvnaXgUxuoj17qS2cp+NQG6qOX+tJZCj61gfropb50loJPbaA+eqkvnaXgUxuoj17qS2cp+NQG6qOX+tJZCj61gfropb50loJPbaA+eqkvnaXgUxuoj17qS2cp+NQG6qOX+tJZCj61gfropb50loJPbaA+eqkvnaXgUxuoj17qS2cp+NQG6qOX+tJZCj61gfropb50loJPbaA+eqkvnaXgUxuoj17qS2cp+NQG6qOX+tJZCj61gfropb50loJPbaA+eqkvnaXgU41ADx5M1vfmz/a/O5lsTqe7k8nk9s4LB8CksxR6qS+dpeBTLw708PHmdPfO8Ozg4dZ0/52t6fbmOQfApLMUeqkvnaXgUy8O9ODRznT/3nDCfDpkur15+P7WOQfApLMUeqkvnaXgUy8OdP/+3vzceWT2bHbJn1/pZ795AH+BDfQc6SwFn3pxoE/XTwV6+HhjfpXXWbSBBqSzFHzq5c6gBw82jl99/j60gQaksxR86mXeg87u4p/fHjXQpHSWgk917uI3ju/ij/scrvmHH/RjpqB0loJPtT8HnZ1Eh88/h9uj2eOt5zfyDTQgnaXgU/uTJB+91JfOUvCpDdRHL/WlsxR8agP10Ut96SwFn9pAffRSXzpLwac2UB+91JfOUvCpDdRHL/WlsxR8agP10Ut96SwFn9pAffRSXzpLwac2UB+91JfOUvCpDdRHL/WlsxR8agP10Ut96SwFn9pAffRSXzpLwac2UB+91JfOUvCpDdRHL/WlsxR8agP10Ut96SwFn9pAffRSXzpLwac2UB+91JfOUvCpDdRHL/WlsxR8agP10Ut96SwFn9pAffRSXzpLwac2UB+91JfOUvCpDdRHL/WlsxR8agP10Ut96SwFn9pAffRSXzpLwac2UB+91JfOUvCpDdRHL/WlsxR8agP10Ut96SwFn9pAffRSXzpLwac2UB+91JfOUvCpDdRHL/WlsxR8agP10Ut96SwFn9pAffRSXzpLwac2UB+91JfOUvCpDdRHL/WlsxR8agP10Ut96SwFn9pAffRSXzpLwac2UB+91JfOUvCpDdRHL/WlsxR8agP10Ut96SwFn9pAffRSXzpLwac2UB+91JfOUvCpDdRHL/WlsxR8agP10Ut96SwFn9pAffRSXzpLwac2UB+91JfOUvCpDdRHL/WlsxR8agP10Ut96SwFn9pAffRSXzpLwac2UB+91JfOUvCpDdRHL/WlsxR8agP10Ut96SwFn9pAffRSXzpLwac2UB+91JfOUvCpDdRHL/WlsxR8agP10Ut96SwFn9pAffRSXzpLwac2UB+91JfOUvCpDdRHL/WlsxR8agP10Ut96SwFn9pAffRSXzpLwac2UB+91JfOUvCpDdRHL/WlsxR8qhHowYPJ+t7pZ3ph2kAj0lkKPvXiQA8fb05375x6phdOHwCTzlLopb50loJPvTjQg0c70/17O3qmF04fAJPOUuilvnSWgk+9OND9+3vTg4dbeqYX3hzgX2KtsosDfbp+0uPxM71w+gBVhIXOoKcPUEUY/3vQWmnOXfzG87v4jaO7+I1XeRdfK83+HHQ4Z0Y+B62VNv6fJNVKa6A1ag20Rq2B1qg10Bq1Blqj1kBr1BpojVoDrVFroDVqDbRGrYHWqDXQGrUGWqPWQGvUGmiNWgOtUWugNWoNtEatgdaoNdAatQZao9ZAa9QaaI3a4oFWkRYN9Groef6Lrtb3pIGunKv1PWmgK+dqfU+ueaB11TXQGrUGWqPWQGvUGmiNWgNdLdub6a/gkhroammgI7L/3cnkqv3/Qdv+2yv2PbnGgQ5/ppP+2Jya217fu1rfk2sc6GD4s53qlOESf6Uu89c60O3J5HYDPeO/throWBw82Owl/kWzOIc/Vv3quMaBDnHuv7N18T+4SrbvXLF/aa9xoNPdyeT3//oqnS1egdld/K0r9e/sdQ60roEGWqPWQGvUGmiNWgOtUWugNWoN9BV5dndt7caH6a/i6mmgr8azuzen0ydf+UH667hyGuir8dlr702nn3/7vfTXceU0UNgnszKf3X1r/ryBXl4DpT25Ofx19LSX+EtroLTPv/33v3N0czScTOuSGijuk7W3zzzWZTRQ3JO1+RX+Sc+fL6OB0j678W93356dP/sh6EtpoLBnd9+eNfphb+BfUgOFDXfuP/m7m5+szb2d/nKunAZao9ZAa9QaaI1aA61Ra6A1ag20Rq2B1qg10Bq1Blqj1kBr1P4Pw/XB1NGcWSYAAAAASUVORK5CYII=" style="display: block; margin: auto;" /></p>
</div>
<div id="position_stack_minmax" class="section level3">
<h3>position_stack_minmax()</h3>
<p>Functions <code>position_stack()</code> and
<code>position_stack_nudge()</code> from package ‘ggplot2’ displace the
position of a variable mapped to only one of <code>y</code>,
<code>ymax</code> or <code>ymin</code>. So they cannot be used with
geometries <code>geom_linerange()</code>, <code>geom_pointrange()</code>
or <code>geom_errorbar()</code>. Position function
<code>position_stack_minmax()</code> can be used with these geometries
as it displaces <code>y</code>, <code>ymin</code> and <code>ymax</code>
together by the same distance. Like <code>position_stack_nudge()</code>
it also supports nudging. Thus, this new position function makes it
possible to add error bars to each member of a stacked colum plot. As
nudging is also supported, it is possible, as shown below, to also
include an error bar for the total quantity represented by the stacked
bars.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="fu">ggplot</span>(birch_dw.df,</span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> dry.weight <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">x =</span> Density, <span class="at">fill =</span> Part)) <span class="sc">+</span></span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">&quot;col&quot;</span>, <span class="at">fun =</span> mean,</span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>               <span class="at">position =</span> <span class="st">&quot;stack&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.67</span>) <span class="sc">+</span></span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>  <span class="co"># error bars for each stack bar</span></span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">&quot;linerange&quot;</span>, <span class="at">fun.data =</span> mean_cl_normal,</span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_stack_minmax</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a>  <span class="co"># error bar for the total</span></span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">data =</span> birch.df, <span class="fu">aes</span>(<span class="at">y =</span> (dwstem <span class="sc">+</span> dwroot) <span class="sc">*</span> <span class="fl">1e-3</span>, <span class="at">fill =</span> <span class="cn">NULL</span>),</span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;linerange&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.75</span>,</span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="fl">0.1</span>), <span class="at">fun.data =</span> mean_cl_normal) <span class="sc">+</span></span>
<span id="cb99-12"><a href="#cb99-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Seedling dry mass (g)&quot;</span>) <span class="sc">+</span></span>
<span id="cb99-13"><a href="#cb99-13" tabindex="-1"></a>  <span class="fu">scale_fill_grey</span>(<span class="at">start =</span> <span class="fl">0.7</span>, <span class="at">end =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb99-14"><a href="#cb99-14" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(Container))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="position_jitternudge" class="section level3">
<h3>position_jitternudge()</h3>
<p>When combining jitter and nudge, we can nudge away from the jittered
positions or from the original positions. In this example, we nudge away
from the jittered positions with <code>nudge.from = &quot;jittered&quot;</code>
and the direction of the nudge is on either side of the original
position with <code>direction = &quot;split&quot;</code>, with nudging depending
on the direction the jitter has moved the point.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a> jitter <span class="ot">&lt;-</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="dv">2</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a> jitter_nudge <span class="ot">&lt;-</span> <span class="fu">position_jitternudge</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="dv">2</span>,</span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a>                                      <span class="at">seed =</span> <span class="dv">123</span>, <span class="at">x =</span> <span class="fl">0.1</span>,</span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a>                                      <span class="at">direction =</span> <span class="st">&quot;split&quot;</span>,</span>
<span id="cb100-6"><a href="#cb100-6" tabindex="-1"></a>                                      <span class="at">nudge.from =</span> <span class="st">&quot;jittered&quot;</span>)</span>
<span id="cb100-7"><a href="#cb100-7" tabindex="-1"></a> <span class="fu">ggplot</span>(mpg[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, ],</span>
<span id="cb100-8"><a href="#cb100-8" tabindex="-1"></a>        <span class="fu">aes</span>(cyl, hwy, <span class="at">label =</span> drv)) <span class="sc">+</span></span>
<span id="cb100-9"><a href="#cb100-9" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">position =</span> jitter) <span class="sc">+</span></span>
<span id="cb100-10"><a href="#cb100-10" tabindex="-1"></a>   <span class="fu">geom_text_s</span>(<span class="at">position =</span> jitter_nudge)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In this second example, the nudging is away from the original
<em>x</em>-position while using the jittered <em>y</em>-position, which
gives vertically aligned labels.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a>jitter <span class="ot">&lt;-</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="dv">2</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a>jitter_nudge <span class="ot">&lt;-</span> <span class="fu">position_jitternudge</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="dv">2</span>,</span>
<span id="cb101-4"><a href="#cb101-4" tabindex="-1"></a>                                      <span class="at">seed =</span> <span class="dv">123</span>, <span class="at">x =</span> <span class="fl">0.35</span>,</span>
<span id="cb101-5"><a href="#cb101-5" tabindex="-1"></a>                                      <span class="at">direction =</span> <span class="st">&quot;split&quot;</span>,</span>
<span id="cb101-6"><a href="#cb101-6" tabindex="-1"></a>                                      <span class="at">nudge.from =</span> <span class="st">&quot;original.x&quot;</span>)</span>
<span id="cb101-7"><a href="#cb101-7" tabindex="-1"></a> <span class="fu">ggplot</span>(mpg[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, ],</span>
<span id="cb101-8"><a href="#cb101-8" tabindex="-1"></a>        <span class="fu">aes</span>(cyl, hwy, <span class="at">label =</span> drv)) <span class="sc">+</span></span>
<span id="cb101-9"><a href="#cb101-9" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">position =</span> jitter) <span class="sc">+</span></span>
<span id="cb101-10"><a href="#cb101-10" tabindex="-1"></a>   <span class="fu">geom_text_s</span>(<span class="at">position =</span> jitter_nudge)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Jitter along the <em>y</em>-axis or the observed data can cause
overlaps of data labels. To avoid this, it is a good approach to use the
repulsive geometries <code>geom_text_repel()</code> or
<code>geon_label_repel()</code> in combination with the position
functions from package ‘ggrepel’.</p>
</div>
<div id="position_jitter_keep" class="section level3">
<h3>position_jitter_keep()</h3>
<p>With no nudging but keeping the original positions we show how points
have moved with jitter.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a> <span class="fu">ggplot</span>(mpg[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, ],</span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a>        <span class="fu">aes</span>(cyl, hwy, <span class="at">label =</span> drv)) <span class="sc">+</span></span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a>   <span class="fu">geom_point_s</span>(<span class="at">position =</span></span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a>                <span class="fu">position_jitter_keep</span>(<span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">height =</span> <span class="dv">2</span>, <span class="at">seed =</span> <span class="dv">123</span>),</span>
<span id="cb102-6"><a href="#cb102-6" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="appendix-a-more-on-density-filtering" class="section level2">
<h2>Appendix A: More on density filtering</h2>
<p>This appendix includes additional examples of the use of the
local-density-based filtering. These additional examples show the
behaviour of these statistics with with pseudo-random artificial data
based on different theoretical probability density functions. Here we
use the <code>_filter</code> variants of these statistics. The companion
<code>_labels</code> variants are meant to be used together with the
repulsive geometries from package ‘ggrepel’.</p>
<p>To start, we define a function to simplify the generation of random
data sets based on different probability distributions.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a>make_data_tbl <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">nrow =</span> <span class="dv">100</span>, <span class="at">rfun =</span> rnorm, ...) {</span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a>  <span class="cf">if</span> (nrow <span class="sc">%%</span> <span class="dv">2</span>) {</span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a>    nrow <span class="ot">&lt;-</span> nrow <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb103-4"><a href="#cb103-4" tabindex="-1"></a>  }</span>
<span id="cb103-5"><a href="#cb103-5" tabindex="-1"></a>  </span>
<span id="cb103-6"><a href="#cb103-6" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1001</span>)</span>
<span id="cb103-7"><a href="#cb103-7" tabindex="-1"></a>  </span>
<span id="cb103-8"><a href="#cb103-8" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb103-9"><a href="#cb103-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rfun</span>(nrow, ...),</span>
<span id="cb103-10"><a href="#cb103-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">rfun</span>(nrow, ...),</span>
<span id="cb103-11"><a href="#cb103-11" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="fu">c</span>(nrow <span class="sc">/</span> <span class="dv">2</span>, nrow <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb103-12"><a href="#cb103-12" tabindex="-1"></a>  )</span>
<span id="cb103-13"><a href="#cb103-13" tabindex="-1"></a>}</span></code></pre></div>
<p>In all the examples in this section of the vignette we use colours to
demonstrate which data points are selected, but any other suitable
aesthetic and discrete scale can be used instead. By overriding the
default <code>keep.sparse = TRUE</code> with
<code>keep.sparse = FALSE</code> we keep 1/3 of the observations in the
denser region of the plot. Although here we first plot all data points
and later overplot the selected ones this is not necessary.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">make_data_tbl</span>(<span class="dv">300</span>), <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a>                     <span class="at">keep.sparse =</span> <span class="cn">FALSE</span>, </span>
<span id="cb104-5"><a href="#cb104-5" tabindex="-1"></a>                     <span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Here we highlight the observations split into three groups, each
containing 1/3 of the observations in <code>data</code>. Each group,
corresponding to a different local density of observations.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">make_data_tbl</span>(<span class="dv">300</span>), <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a>                     <span class="at">keep.sparse =</span> <span class="cn">FALSE</span>, </span>
<span id="cb105-5"><a href="#cb105-5" tabindex="-1"></a>                     <span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb105-6"><a href="#cb105-6" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb105-7"><a href="#cb105-7" tabindex="-1"></a>                     <span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The algorithm seems to work well also with other distributions, in
this example we use the uniform distribution.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">make_data_tbl</span>(<span class="dv">300</span>, <span class="at">rfun =</span> runif), <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb106-3"><a href="#cb106-3" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>One example with the gamma distribution, which is asymmetric.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">make_data_tbl</span>(<span class="dv">300</span>, <span class="at">rfun =</span> rgamma, <span class="at">shape =</span> <span class="dv">2</span>), </span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>       <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="appendix-b-try_tibble" class="section level2">
<h2>Appendix B: try_tibble()</h2>
<div id="time-series" class="section level3">
<h3>Time series</h3>
<p>Several different formats for storing time series data are used in R.
Here we use in the examples objects of class <code>ts</code> but several
other classes are supported as <code>try.xts()</code> from package ‘xts’
is used internally. Package ‘ggplot2’ supports plotting with variables
containing date-times represented as objects of classes
<code>POSIXct</code> or <code>Date</code>. Functions
<code>try_data_frame()</code> and <code>try_tibble()</code> are used in
‘ggpp’ internally in the definition of <code>ggplot()</code> method for
time series data. Non-the-less, <code>try_data_frame()</code> and
<code>try_tibble()</code> are exported. The two functions differ only in
the class of the returned object. The time variable in the returned data
frame or tibble by default belongs to class <code>Date</code> or to
class <code>POSIXct</code> depending on the time step of the time series
object. In the examples below we use <code>try_tibble()</code> but they
work unchanged with <code>try_data_frame()</code>.</p>
<p>In the first example we convert a quarterly time series into a
tibble.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="fu">print</span>(austres)</span></code></pre></div>
<pre><code>##         Qtr1    Qtr2    Qtr3    Qtr4
## 1971         13067.3 13130.5 13198.4
## 1972 13254.2 13303.7 13353.9 13409.3
## 1973 13459.2 13504.5 13552.6 13614.3
## 1974 13669.5 13722.6 13772.1 13832.0
## 1975 13862.6 13893.0 13926.8 13968.9
## 1976 14004.7 14033.1 14066.0 14110.1
## 1977 14155.6 14192.2 14231.7 14281.5
## 1978 14330.3 14359.3 14396.6 14430.8
## 1979 14478.4 14515.7 14554.9 14602.5
## 1980 14646.4 14695.4 14746.6 14807.4
## 1981 14874.4 14923.3 14988.7 15054.1
## 1982 15121.7 15184.2 15239.3 15288.9
## 1983 15346.2 15393.5 15439.0 15483.5
## 1984 15531.5 15579.4 15628.5 15677.3
## 1985 15736.7 15788.3 15839.7 15900.6
## 1986 15961.5 16018.3 16076.9 16139.0
## 1987 16203.0 16263.3 16327.9 16398.9
## 1988 16478.3 16538.2 16621.6 16697.0
## 1989 16777.2 16833.1 16891.6 16956.8
## 1990 17026.3 17085.4 17106.9 17169.4
## 1991 17239.4 17292.0 17354.2 17414.2
## 1992 17447.3 17482.6 17526.0 17568.7
## 1993 17627.1 17661.5</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="fu">class</span>(austres)</span></code></pre></div>
<pre><code>## [1] &quot;ts&quot;</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a>austres.df <span class="ot">&lt;-</span> <span class="fu">try_tibble</span>(austres)</span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a><span class="fu">class</span>(austres.df)</span></code></pre></div>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="fu">head</span>(austres.df, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 2
##   time            x
##   &lt;date&gt;      &lt;dbl&gt;
## 1 1971-04-01 13067.
## 2 1971-07-01 13130.
## 3 1971-10-01 13198.
## 4 1972-01-01 13254.</code></pre>
<p>The next chunk demonstrates that when passing
<code>as.numeric = TRUE</code> to override the default, numeric times
are expressed as years with decimal fractions in the returned data
frame.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a>austres.df <span class="ot">&lt;-</span> <span class="fu">try_tibble</span>(austres, <span class="at">as.numeric =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a><span class="fu">head</span>(austres.df, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 2
##    time      x
##   &lt;dbl&gt;  &lt;dbl&gt;
## 1 1971. 13067.
## 2 1971. 13130.
## 3 1972. 13198.
## 4 1972  13254.</code></pre>
<p>This additional example is for a series of yearly values.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="fu">class</span>(lynx)</span></code></pre></div>
<pre><code>## [1] &quot;ts&quot;</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a>lynx.df <span class="ot">&lt;-</span> <span class="fu">try_tibble</span>(lynx)</span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a><span class="fu">class</span>(lynx.df)</span></code></pre></div>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a><span class="fu">head</span>(lynx.df, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   time           x
##   &lt;date&gt;     &lt;dbl&gt;
## 1 1821-01-01   269
## 2 1822-01-01   321
## 3 1823-01-01   585</code></pre>
<p>In some cases there can be small rounding errors or the time steps
can be shorter that the default <code>time.resolution = &quot;month&quot;</code>.
We should in those cases pass an argument to
<code>time.resolution</code> to override the default rounding. Rounding
is done with <code>lubridate::round_date()</code> and the argument from
<code>time.resolution</code> passed to its parameter <code>unit</code>,
except if it is <code>NULL</code> or <code>NA</code>, in which case no
rounding is applied.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a>lynx.df <span class="ot">&lt;-</span> <span class="fu">try_tibble</span>(lynx, <span class="at">time.resolution =</span> <span class="cn">NULL</span>)</span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a><span class="fu">head</span>(lynx.df, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   time           x
##   &lt;date&gt;     &lt;dbl&gt;
## 1 1821-01-01   269
## 2 1822-01-01   321
## 3 1823-01-01   585</code></pre>
<p>In addition we can convert the POSIXct values into numeric values in
calendar years plus a decimal fraction.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>lynx_n.df <span class="ot">&lt;-</span> <span class="fu">try_tibble</span>(lynx, <span class="at">time.resolution =</span> <span class="st">&quot;year&quot;</span>, <span class="at">as.numeric =</span> <span class="cn">TRUE</span>)</span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a><span class="fu">lapply</span>(lynx_n.df, <span class="st">&quot;class&quot;</span>)</span></code></pre></div>
<pre><code>## $time
## [1] &quot;numeric&quot;
## 
## $x
## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="fu">head</span>(lynx_n.df, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##    time     x
##   &lt;dbl&gt; &lt;dbl&gt;
## 1  1821   269
## 2  1822   321
## 3  1823   585</code></pre>
</div>
<div id="other-classes" class="section level3">
<h3>Other classes</h3>
<p>Functions <code>try_data_frame()</code> and <code>try_tibble()</code>
attempt to handle gracefully objects that are not time series.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a><span class="fu">try_tibble</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 1
##       x
##   &lt;int&gt;
## 1     1
## 2     2
## 3     3
## 4     4
## 5     5</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="fu">try_tibble</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span></code></pre></div>
<pre><code>## # A tibble: 5 × 1
##   x    
##   &lt;chr&gt;
## 1 a    
## 2 b    
## 3 c    
## 4 d    
## 5 e</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a><span class="fu">try_tibble</span>(<span class="fu">factor</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 1
##   x    
##   &lt;fct&gt;
## 1 a    
## 2 b    
## 3 c    
## 4 d    
## 5 e</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a><span class="fu">try_tibble</span>(<span class="fu">list</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##       x     y
##   &lt;dbl&gt; &lt;int&gt;
## 1     1     1
## 2     1     2
## 3     1     3
## 4     1     4
## 5     1     5</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a><span class="fu">try_tibble</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##       x     y
##   &lt;dbl&gt; &lt;int&gt;
## 1     1     1
## 2     1     2
## 3     1     3
## 4     1     4
## 5     1     5</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a><span class="fu">try_tibble</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">ncol =</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 2
##      V1    V2
##   &lt;int&gt; &lt;int&gt;
## 1     1     6
## 2     2     7
## 3     3     8
## 4     4     9
## 5     5    10</code></pre>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
